str[0] = " "
str[1] = "Door"
str[2] = "Storage Container"
str[3] = "Computer Terminal"
str[4] = "It's a short circuit!"
str[5] = "The door won't budge."
str[6] = "Control Center"
str[7] = "Exit"
str[8] = ""
str[9] = ""
str[10] = ""
str[11] = "Hello and welcome to this self-guided tour of the Varn Planetary Control Facility.  We gladly welcome all visitors.  As you arrive at each key area, be sure to check any of our display screens for more information.  Enjoy your tour!"
str[12] = "This is the main equipment storage and repair facility.  By now, you may have noticed several floating Drone-bots.  They are responsible both for maintaining the key systems of this facility as well as sanitation.  If a unit becomes damaged, it is brought here to be repaired."
str[13] = "The room to your left is the main meeting hall.  Visiting dignitaries from around the world have feasted at banquets held in their honor.  In fact, it is said that at his 21st birthday party King Sheridan nearly choked to death on a piece of mogred, but was saved by a serving girl who he later married and made his Queen.  Ahh, l’amour."
str[14] = "Chief Engineer Wilson’s Personal Log.  I have locked myself in Storage Room #6 but currently have no means of escape.  The drone-bots have gone mad and have started killing everyone in sight.  I was able to access the main control terminal on Level Four despite warnings of a hazardous leak, and I sent a distress signal, but since we have not had contact with any of the colonies for several weeks, I do not believe that a rescue is possible.  I have also managed to seal this facility so that the drones can not escape.  It is my hope that the colonists will be able to mount some sort of defense by the time my encryption codes are broken.  Tell Emma I love her.  Wilson out."
str[15] = "We apologize for any inconvenience, but we ask that all personnel evacuate the facility at this time.  Please do not be alarmed.  Thank you."
str[16] = "Before entering the Planetary Reaction Chamber, please request a pair of Safety Goggles from one of our Drones.  During peak hours of operation, this facility can generate enough power to produce a light bright enough to be seen from space.  Please avoid looking directly into the light."
str[17] = "Alert, environmental controls are offline on Level Four, Sections 18 through 96.  Access restricted to drones until further notice."
str[18] = "Warning, intruder alert, Level Four, Section.  All drones proceed to Level Four to intercept intruders.  Reactor is offline.  Encryption integrity at 2.064%.  Warning, intruder alert, Level Four…"
str[19] = "Blaster weapons provide an effective, accurate ranged attack.  To operate the blaster, hold the grip comfortably in your hand, point the barrel at your target, and gently squeeze the trigger.  Should the weapon misfire, do not look into the barrel- give the weapon to an instructor and let them fix the problem.  Never point a blaster at something you do not want to vaporize."
str[20] = ""


event 1
      Hint = str[1]  -- "Door"
      MazeInfo = str[6]  -- "Control Center"
  0:  StatusText  {Str = 5}         -- "The door won't budge."
end

event 2
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 2, State = 2}         -- switch state
  1:  SetDoorState  {Id = 3, State = 2}         -- switch state
  2:  SetDoorState  {Id = 15, State = 0}
  3:  SetDoorState  {Id = 16, State = 0}
end

event 3
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 3, State = 1}
end

event 4
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 4, State = 1}
end

event 5
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 5, State = 1}
end

event 6
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 6, State = 1}
end

event 7
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 7, State = 1}
  1:  SetDoorState  {Id = 8, State = 0}
  2:  SetDoorState  {Id = 9, State = 0}
end

event 8
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 8, State = 1}
  1:  SetDoorState  {Id = 7, State = 0}
  2:  SetDoorState  {Id = 9, State = 0}
end

event 9
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 9, State = 1}
  1:  SetDoorState  {Id = 8, State = 0}
  2:  SetDoorState  {Id = 7, State = 0}
end

event 10
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 10, State = 1}
  1:  SetDoorState  {Id = 11, State = 1}
end

event 11
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 10, State = 1}
  1:  SetDoorState  {Id = 11, State = 1}
end

event 12
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 12, State = 1}
end

event 13
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 13, State = 1}
end

event 14
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 14, State = 1}
end

event 15
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 15, State = 2}         -- switch state
  1:  SetDoorState  {Id = 16, State = 2}         -- switch state
  2:  SetDoorState  {Id = 2, State = 0}
  3:  SetDoorState  {Id = 3, State = 0}
end

event 16
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 16, State = 1}
end

event 17
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 17, State = 1}
end

event 18
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 18, State = 1}
end

event 19
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 19, State = 1}
end

event 20
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 20, State = 1}
end

event 21
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 21, State = 1}
end

event 22
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 22, State = 1}
end

event 23
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 23, State = 1}
end

event 24
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 24, State = 2}         -- switch state
  1:  SetDoorState  {Id = 25, State = 2}         -- switch state
end

event 25
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 25, State = 1}
end

event 26
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 26, State = 2}         -- switch state
  1:  SetDoorState  {Id = 1, State = 2}         -- switch state
end

event 27
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 27, State = 2}         -- switch state
  1:  SetDoorState  {Id = 28, State = 2}         -- switch state
end

event 28
      Hint = str[1]  -- "Door"
  0:  SetDoorState  {Id = 28, State = 1}
  1:  SetDoorState  {Id = 27, State = 1}
end

event 29
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 0}
end

event 30
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 1}
end

event 31
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 2}
end

event 32
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 3}
end

event 33
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 4}
end

event 34
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 5}
  1:  ForPlayer  ("All")
  2:  Set  {"Awards", Value = 61}         -- "Super-Goober"
end

event 35
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 6}
end

event 36
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 7}
end

event 37
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 8}
end

event 38
  0:  SetLight  {Id = 45, On = true}
  1:  SetLight  {Id = 46, On = true}
  2:  SetLight  {Id = 47, On = true}
  3:  SetLight  {Id = 48, On = true}
  4:  SetLight  {Id = 49, On = true}
end

event 39
  0:  SetLight  {Id = 31, On = true}
  1:  SetLight  {Id = 32, On = true}
  2:  SetLight  {Id = 33, On = true}
  3:  SetLight  {Id = 34, On = true}
  4:  SetLight  {Id = 35, On = true}
  5:  SetLight  {Id = 36, On = true}
  6:  SetLight  {Id = 37, On = true}
  7:  SetLight  {Id = 38, On = true}
  8:  SetLight  {Id = 39, On = true}
  9:  SetLight  {Id = 40, On = true}
  10: SetLight  {Id = 41, On = true}
  11: SetLight  {Id = 42, On = true}
  12: SetLight  {Id = 43, On = true}
  13: SetLight  {Id = 44, On = true}
  14: SetLight  {Id = 391, On = true}
end

event 40
  0:  SetLight  {Id = 50, On = true}
  1:  SetLight  {Id = 51, On = true}
  2:  SetLight  {Id = 52, On = true}
  3:  SetLight  {Id = 53, On = true}
  4:  SetLight  {Id = 54, On = true}
  5:  SetLight  {Id = 55, On = true}
  6:  SetLight  {Id = 56, On = true}
  7:  SetLight  {Id = 57, On = true}
  8:  SetLight  {Id = 58, On = true}
  9:  SetLight  {Id = 59, On = true}
end

event 41
  0:  SetLight  {Id = 60, On = true}
  1:  SetLight  {Id = 61, On = true}
  2:  SetLight  {Id = 62, On = true}
  3:  SetLight  {Id = 63, On = true}
  4:  SetLight  {Id = 64, On = true}
  5:  SetLight  {Id = 65, On = true}
  6:  SetLight  {Id = 66, On = true}
  7:  SetLight  {Id = 67, On = true}
end

event 42
  0:  SetLight  {Id = 68, On = true}
  1:  SetLight  {Id = 69, On = true}
  2:  SetLight  {Id = 70, On = true}
  3:  SetLight  {Id = 71, On = true}
  4:  SetLight  {Id = 72, On = true}
  5:  SetLight  {Id = 73, On = true}
  6:  SetLight  {Id = 74, On = true}
  7:  SetLight  {Id = 75, On = true}
end

event 43
  0:  SetLight  {Id = 77, On = true}
  1:  SetLight  {Id = 78, On = true}
  2:  SetLight  {Id = 79, On = true}
end

event 44
  0:  SetLight  {Id = 389, On = true}
  1:  SetLight  {Id = 390, On = true}
end

event 45
  0:  SetLight  {Id = 45, On = false}
  1:  SetLight  {Id = 46, On = false}
  2:  SetLight  {Id = 47, On = false}
  3:  SetLight  {Id = 48, On = false}
  4:  SetLight  {Id = 49, On = false}
end

event 46
  0:  SetLight  {Id = 45, On = false}
  1:  SetLight  {Id = 46, On = false}
  2:  SetLight  {Id = 47, On = false}
  3:  SetLight  {Id = 48, On = false}
  4:  SetLight  {Id = 49, On = false}
  5:  SetLight  {Id = 31, On = false}
  6:  SetLight  {Id = 32, On = false}
  7:  SetLight  {Id = 33, On = false}
  8:  SetLight  {Id = 34, On = false}
  9:  SetLight  {Id = 35, On = false}
  10: SetLight  {Id = 36, On = false}
  11: SetLight  {Id = 37, On = false}
  12: SetLight  {Id = 38, On = false}
  13: SetLight  {Id = 39, On = false}
  14: SetLight  {Id = 40, On = false}
  15: SetLight  {Id = 41, On = false}
  16: SetLight  {Id = 42, On = false}
  17: SetLight  {Id = 43, On = false}
  18: SetLight  {Id = 44, On = false}
  19: SetLight  {Id = 391, On = false}
end

event 47
  0:  SetLight  {Id = 31, On = false}
  1:  SetLight  {Id = 32, On = false}
  2:  SetLight  {Id = 33, On = false}
  3:  SetLight  {Id = 34, On = false}
  4:  SetLight  {Id = 35, On = false}
  5:  SetLight  {Id = 36, On = false}
  6:  SetLight  {Id = 37, On = false}
  7:  SetLight  {Id = 38, On = false}
  8:  SetLight  {Id = 39, On = false}
  9:  SetLight  {Id = 40, On = false}
  10: SetLight  {Id = 41, On = false}
  11: SetLight  {Id = 42, On = false}
  12: SetLight  {Id = 43, On = false}
  13: SetLight  {Id = 44, On = false}
  14: SetLight  {Id = 391, On = false}
  15: SetLight  {Id = 50, On = false}
  16: SetLight  {Id = 51, On = false}
  17: SetLight  {Id = 52, On = false}
  18: SetLight  {Id = 53, On = false}
  19: SetLight  {Id = 54, On = false}
  20: SetLight  {Id = 55, On = false}
  21: SetLight  {Id = 56, On = false}
  22: SetLight  {Id = 57, On = false}
  23: SetLight  {Id = 58, On = false}
  24: SetLight  {Id = 59, On = false}
  25: CastSpell  {Spell = 15, Mastery = const.Master, Skill = 100, FromX = -10880, FromY = -4224, FromZ = 660, ToX = -10880, ToY = -4224, ToZ = 400}         -- "Sparks"
end

event 48
  0:  SetLight  {Id = 50, On = false}
  1:  SetLight  {Id = 51, On = false}
  2:  SetLight  {Id = 52, On = false}
  3:  SetLight  {Id = 53, On = false}
  4:  SetLight  {Id = 54, On = false}
  5:  SetLight  {Id = 55, On = false}
  6:  SetLight  {Id = 56, On = false}
  7:  SetLight  {Id = 57, On = false}
  8:  SetLight  {Id = 58, On = false}
  9:  SetLight  {Id = 59, On = false}
  10: SetLight  {Id = 60, On = false}
  11: SetLight  {Id = 61, On = false}
  12: SetLight  {Id = 62, On = false}
  13: SetLight  {Id = 63, On = false}
  14: SetLight  {Id = 64, On = false}
  15: SetLight  {Id = 65, On = false}
  16: SetLight  {Id = 66, On = false}
  17: SetLight  {Id = 67, On = false}
end

event 49
  0:  SetLight  {Id = 60, On = false}
  1:  SetLight  {Id = 61, On = false}
  2:  SetLight  {Id = 62, On = false}
  3:  SetLight  {Id = 63, On = false}
  4:  SetLight  {Id = 64, On = false}
  5:  SetLight  {Id = 65, On = false}
  6:  SetLight  {Id = 66, On = false}
  7:  SetLight  {Id = 67, On = false}
  8:  SetLight  {Id = 68, On = false}
  9:  SetLight  {Id = 69, On = false}
  10: SetLight  {Id = 70, On = false}
  11: SetLight  {Id = 71, On = false}
  12: SetLight  {Id = 72, On = false}
  13: SetLight  {Id = 73, On = false}
  14: SetLight  {Id = 74, On = false}
  15: SetLight  {Id = 75, On = false}
end

event 50
  0:  SetLight  {Id = 68, On = false}
  1:  SetLight  {Id = 69, On = false}
  2:  SetLight  {Id = 70, On = false}
  3:  SetLight  {Id = 71, On = false}
  4:  SetLight  {Id = 72, On = false}
  5:  SetLight  {Id = 73, On = false}
  6:  SetLight  {Id = 74, On = false}
  7:  SetLight  {Id = 75, On = false}
  8:  SetLight  {Id = 77, On = false}
  9:  SetLight  {Id = 78, On = false}
  10: SetLight  {Id = 79, On = false}
end

event 51
  0:  SetLight  {Id = 77, On = false}
  1:  SetLight  {Id = 78, On = false}
  2:  SetLight  {Id = 79, On = false}
  3:  SetLight  {Id = 389, On = false}
  4:  SetLight  {Id = 390, On = false}
end

event 52
  0:  SetLight  {Id = 389, On = false}
  1:  SetLight  {Id = 390, On = false}
end

event 53
      Hint = str[3]  -- "Computer Terminal"
  0:  SetTexture  {Facet = 2899, Name = "trekscOn"}
  1:  SetMessage  {Str = 11}         -- "Hello and welcome to this self-guided tour of the Varn Planetary Control Facility.  We gladly welcome all visitors.  As you arrive at each key area, be sure to check any of our display screens for more information.  Enjoy your tour!"
  2:  SimpleMessage  {}
end

event 54
      Hint = str[3]  -- "Computer Terminal"
  0:  SetTexture  {Facet = 2903, Name = "trekscOn"}
  1:  SetMessage  {Str = 12}         -- "This is the main equipment storage and repair facility.  By now, you may have noticed several floating Drone-bots.  They are responsible both for maintaining the key systems of this facility as well as sanitation.  If a unit becomes damaged, it is brought here to be repaired."
  2:  SimpleMessage  {}
end

event 55
      Hint = str[3]  -- "Computer Terminal"
  0:  SetTexture  {Facet = 2930, Name = "trekscOn"}
  1:  SetMessage  {Str = 13}         -- "The room to your left is the main meeting hall.  Visiting dignitaries from around the world have feasted at banquets held in their honor.  In fact, it is said that at his 21st birthday party King Sheridan nearly choked to death on a piece of mogred, but was saved by a serving girl who he later married and made his Queen.  Ahh, l’amour."
  2:  SimpleMessage  {}
end

event 56
      Hint = str[3]  -- "Computer Terminal"
  0:  SetTexture  {Facet = 2905, Name = "trekscOn"}
  1:  SetMessage  {Str = 14}         -- "Chief Engineer Wilson’s Personal Log.  I have locked myself in Storage Room #6 but currently have no means of escape.  The drone-bots have gone mad and have started killing everyone in sight.  I was able to access the main control terminal on Level Four despite warnings of a hazardous leak, and I sent a distress signal, but since we have not had contact with any of the colonies for several weeks, I do not believe that a rescue is possible.  I have also managed to seal this facility so that the drones can not escape.  It is my hope that the colonists will be able to mount some sort of defense by the time my encryption codes are broken.  Tell Emma I love her.  Wilson out."
  2:  SimpleMessage  {}
end

event 57
      Hint = str[3]  -- "Computer Terminal"
  0:  SetTexture  {Facet = 2911, Name = "trekscOn"}
  1:  SetMessage  {Str = 15}         -- "We apologize for any inconvenience, but we ask that all personnel evacuate the facility at this time.  Please do not be alarmed.  Thank you."
  2:  SimpleMessage  {}
end

event 58
      Hint = str[3]  -- "Computer Terminal"
  0:  SetTexture  {Facet = 2914, Name = "trekscOn"}
  1:  SetMessage  {Str = 16}         -- "Before entering the Planetary Reaction Chamber, please request a pair of Safety Goggles from one of our Drones.  During peak hours of operation, this facility can generate enough power to produce a light bright enough to be seen from space.  Please avoid looking directly into the light."
  2:  SimpleMessage  {}
end

event 59
      Hint = str[3]  -- "Computer Terminal"
  0:  SetTexture  {Facet = 2921, Name = "trekscOn"}
  1:  SetMessage  {Str = 17}         -- "Alert, environmental controls are offline on Level Four, Sections 18 through 96.  Access restricted to drones until further notice."
  2:  SimpleMessage  {}
end

event 60
      Hint = str[3]  -- "Computer Terminal"
  0:  SetTexture  {Facet = 2933, Name = "trekscOn"}
  1:  SetMessage  {Str = 18}         -- "Warning, intruder alert, Level Four, Section.  All drones proceed to Level Four to intercept intruders.  Reactor is offline.  Encryption integrity at 2.064%.  Warning, intruder alert, Level Four…"
  2:  SimpleMessage  {}
end

event 61
      Hint = str[3]  -- "Computer Terminal"
  0:  SetTexture  {Facet = 2927, Name = "trekscOn"}
  1:  Cmp  {"QBits", Value = 276,   jump = 5}         -- NPC
  2:  ForPlayer  ("All")
  3:  Set  {"BlasterSkill", Value = 1}
  4:  Set  {"QBits", Value = 276}         -- NPC
  5:  SetMessage  {Str = 19}         -- "Blaster weapons provide an effective, accurate ranged attack.  To operate the blaster, hold the grip comfortably in your hand, point the barrel at your target, and gently squeeze the trigger.  Should the weapon misfire, do not look into the barrel- give the weapon to an instructor and let them fix the problem.  Never point a blaster at something you do not want to vaporize."
  6:  SimpleMessage  {}
end

event 62
  0:  StatusText  {Str = 4}         -- "It's a short circuit!"
  1:  DamagePlayer  {Player = "Random", DamageType = const.Damage.Fire, Damage = 200}
end

event 63
  0:  StatusText  {Str = 4}         -- "It's a short circuit!"
  1:  DamagePlayer  {Player = "Random", DamageType = const.Damage.Fire, Damage = 200}
end

event 64
  0:  StatusText  {Str = 4}         -- "It's a short circuit!"
  1:  DamagePlayer  {Player = "Random", DamageType = const.Damage.Fire, Damage = 200}
end

event 65
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 9}
end

event 66
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 10}
end

event 67
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 11}
end

event 68
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 12}
end

event 69
      Hint = str[2]  -- "Storage Container"
  0:  OpenChest  {Id = 13}
end

event 70
      Hint = str[7]  -- "Exit"
  0:  MoveToMap  {X = -1433, Y = 2204, Z = -495, Direction = 1536, LookAngle = 0, SpeedZ = 0, HouseId = 0, Icon = 6, Name = "Oracle.Blv"}
end

event 71
  0:  OnTimer  {IntervalInHalfMinutes = 3}
  1:  CastSpell  {Spell = 15, Mastery = const.Master, Skill = 100, FromX = -5632, FromY = -4736, FromZ = 660, ToX = -5632, ToY = -4000, ToZ = 660}         -- "Sparks"
end
