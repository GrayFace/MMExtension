event 1  -- "Castle Harmondale"
  0:  CanShowTopic.Cmp  {"QBits", Value = 7,   jump = 3}         -- Finished Scavenger Hunt
  1:  CanShowTopic.Set  {Visible = true}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 6}         -- "If you win, you'll be in charge of one of the most scenic areas in all Erathia!  Harmondale is just outside of the Tularean Forest, right on the edge of the Elf-Human border.  And I'm sure you'll love the castle.  It's a bit of a fixer-upper, but it's quite roomy and has excellent ventilation.  It breaks my heart to part with this property, but I feel that the time has come for me to give something back to the people."
end

event 2  -- "The Hunt"
  0:  CanShowTopic.Cmp  {"QBits", Value = 7,   jump = 3}         -- Finished Scavenger Hunt
  1:  CanShowTopic.Set  {Visible = true}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 5}         -- "Isn't this hunt exciting?  I really am grateful you came to my little event, and I hope you have fun, even if you don't win.  I think it's great that everyone is competing in a spirit of good sportsmanship and camaraderie."
end

event 3  -- "Congratulations"
  0:  CanShowTopic.Cmp  {"QBits", Value = 7,   jump = 3}         -- Finished Scavenger Hunt
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 7}         -- "Congratulations!  You are the new Lords of Harmondale!  Isn't it thrilling?  You can't imagine how good it feels for me to give this property away to you!  All of the benefits and rewards, and of course, the responsibilities of governing the town of Harmondale are now yours.  (Lord Markham produces a deed and contract) Just sign here...And here... And if I could just get your initials here... Yes!  Well, that's that!  You're all set.  And once again, congratulations!!!"
  6:  SetNPCTopic  {NPC = 1, Index = 2, Event = 4}         -- "Lord Markham" : "Your ship…"
  7:  Subtract  {"NPCs", Value = 3}         -- "Margaret the Docent"
  8:  Set  {"QBits", Value = 17}         -- No more docent babble
  9:  ForPlayer  ("All")
  10: Add  {"Experience", Value = 1000}
  11: Add  {"Awards", Value = 2}         -- "Won the Scavenger Hunt on Emerald Island"
  12: SetNPCGroupNews  {NPCGroup = 1, NPCNews = 5}         -- "" : "Congratulations!"
end

event 4  -- "Your ship…"
  0:  SetMessage  {Str = 8}         -- "Well, the ship that will take you to your fiefdom awaits you in the harbor.  My entourage and I will be taking a different ship out.  Just board whenever you're ready."
  1:  Add  {"QBits", Value = 15}         -- Able to use boat to get off Emerald Island
  2:  SetNPCTopic  {NPC = 11, Index = 0, Event = 33}         -- "William Darvees" : "Cast off!"
  3:  SetNPCTopic  {NPC = 1, Index = 2, Event = 0}         -- "Lord Markham"
  4:  SetNPCGreeting  {NPC = 1, Greeting = 0}         -- "Lord Markham" : ""
end

event 5  -- "Rules of the Hunt"
  0:  SetMessage  {Str = 25}         -- "Good afternoon.  My duty is to verify that you have all the items necessary to win the contest.  You are required to bring a red potion, a longbow, a floor tile from the Temple of the Moon, a wealthy hat, seashell, and an instrument to me.  You can bring them in any order, just show them to me one at a time so that I may verify them."
end

event 6  -- "What do you have?"
  0:  ForPlayer  ("All")
  1:  Cmp  {"QBits", Value = 8,   jump = 10}         -- Brought red potion
  2:  Cmp  {"Inventory", Value = 222,   jump = 4}         -- "Cure Wounds"
  3:  GoTo  {jump = 10}

  4:  Subtract  {"QBits", Value = 1}         -- "Return a red potion to the Judge on Emerald Island."
  5:  Add  {"Experience", Value = 500}
  6:  Add  {"QBits", Value = 8}         -- Brought red potion
  7:  Subtract  {"Inventory", Value = 222}         -- "Cure Wounds"
  8:  SetMessage  {Str = 31}         -- "What took you so long?  Almost every group has turned in a red potion by now.  This is the easiest item in the hunt to manage, but better late than never.  I will mark it off your list."
  9:  Exit  {}

  10: Cmp  {"QBits", Value = 9,   jump = 20}         -- Brought seashell
  11: GoTo  {jump = 12}

  12: Cmp  {"Inventory", Value = 635,   jump = 14}         -- "Seashell"
  13: GoTo  {jump = 20}

  14: Subtract  {"QBits", Value = 2}         -- "Return a seashell to the Judge on Emerald Island."
  15: Subtract  {"Inventory", Value = 635}         -- "Seashell"
  16: Add  {"QBits", Value = 9}         -- Brought seashell
  17: Add  {"Experience", Value = 500}
  18: SetMessage  {Str = 30}         -- "A beautiful shell, much like the ones that Sally sells.  This certainly came from Emerald Island- I shall mark the shell off your list."
  19: Exit  {}

  20: Cmp  {"QBits", Value = 10,   jump = 30}         -- Brought longbow
  21: GoTo  {jump = 22}

  22: Cmp  {"Inventory", Value = 43,   jump = 24}         -- "Longbow"
  23: GoTo  {jump = 30}

  24: SetMessage  {Str = 29}         -- "This longbow certainly qualifies for the hunt.  Good work, I shall mark that off your list."
  25: Subtract  {"Inventory", Value = 43}         -- "Longbow"
  26: Subtract  {"QBits", Value = 3}         -- "Return a longbow to the Judge on Emerald Island."
  27: Add  {"Experience", Value = 500}
  28: Add  {"QBits", Value = 10}         -- Brought longbow
  29: Exit  {}

  30: Cmp  {"QBits", Value = 11,   jump = 40}         -- Brought tile
  31: GoTo  {jump = 32}

  32: Cmp  {"Inventory", Value = 636,   jump = 34}         -- "Floor Tile (w/ moon insignia)"
  33: GoTo  {jump = 40}

  34: SetMessage  {Str = 28}         -- "Adventurers indeed!  I didn't expect anyone to bring back a tile so quickly.  This is certainly a tile from the Temple, however so I shall mark the tile off your list."
  35: Subtract  {"Inventory", Value = 636}         -- "Floor Tile (w/ moon insignia)"
  36: Subtract  {"QBits", Value = 4}         -- "Return a floor tile to the Judge on Emerald Island."
  37: Add  {"Experience", Value = 500}
  38: Add  {"QBits", Value = 11}         -- Brought tile
  39: Exit  {}

  40: Cmp  {"QBits", Value = 12,   jump = 50}         -- Brought instrument
  41: GoTo  {jump = 42}

  42: Cmp  {"Inventory", Value = 632,   jump = 44}         -- "Lute"
  43: GoTo  {jump = 50}

  44: SetMessage  {Str = 27}         -- "Hmm, a fine lute this is.  Let me mark off the instrument from your list."
  45: Subtract  {"Inventory", Value = 632}         -- "Lute"
  46: Subtract  {"QBits", Value = 5}         -- "Return a musical instrument to the Judge on Emerald Island."
  47: Add  {"Experience", Value = 500}
  48: Add  {"QBits", Value = 12}         -- Brought instrument
  49: Exit  {}

  50: Cmp  {"QBits", Value = 13,   jump = 60}         -- Brought hat
  51: GoTo  {jump = 52}

  52: Cmp  {"Inventory", Value = 631,   jump = 54}         -- "Wealthy Hat"
  53: GoTo  {jump = 81}

  54: SetMessage  {Str = 26}         -- "I see you have found a wealthy hat.  I shall mark this off your list accordingly, good work."
  55: Subtract  {"Inventory", Value = 631}         -- "Wealthy Hat"
  56: Subtract  {"QBits", Value = 6}         -- "Return a wealthy hat to the Judge on Emerald Island."
  57: Add  {"Experience", Value = 500}
  58: Add  {"QBits", Value = 13}         -- Brought hat
  59: Exit  {}

  60: Cmp  {"QBits", Value = 1,   jump = 81}         -- "Return a red potion to the Judge on Emerald Island."
  61: GoTo  {jump = 62}

  62: Cmp  {"QBits", Value = 2,   jump = 81}         -- "Return a seashell to the Judge on Emerald Island."
  63: GoTo  {jump = 64}

  64: Cmp  {"QBits", Value = 3,   jump = 81}         -- "Return a longbow to the Judge on Emerald Island."
  65: GoTo  {jump = 66}

  66: Cmp  {"QBits", Value = 4,   jump = 81}         -- "Return a floor tile to the Judge on Emerald Island."
  67: GoTo  {jump = 68}

  68: Cmp  {"QBits", Value = 5,   jump = 81}         -- "Return a musical instrument to the Judge on Emerald Island."
  69: GoTo  {jump = 70}

  70: Cmp  {"QBits", Value = 6,   jump = 81}         -- "Return a wealthy hat to the Judge on Emerald Island."
  71: GoTo  {jump = 73}

  72: Exit  {}

  73: Add  {"QBits", Value = 7}         -- Finished Scavenger Hunt
  74: SetMessage  {Str = 32}         -- "Well, that's all six items.  You're the winner of the contest!  I suggest you talk to Lord Markham for the details on gaining your fiefdom, my work is done here."
  75: SetNPCTopic  {NPC = 2, Index = 0, Event = 0}         -- "Thomas the Judge"
  76: SetNPCTopic  {NPC = 2, Index = 1, Event = 0}         -- "Thomas the Judge"
  77: MoveNPC  {NPC = 2, HouseId = 0}         -- "Thomas the Judge"
  78: SetNPCTopic  {NPC = 1, Index = 1, Event = 0}         -- "Lord Markham"
  79: SetNPCGreeting  {NPC = 6, Greeting = 9}         -- "Mr. Malwick" : "I don't believe we have anything to talk about."
  80: Exit  {}

  81: SetMessage  {Str = 33}         -- "I'm sorry, but nothing you have is necessary for the hunt.  I don't mean to belittle what you have, but I'm not looking for any of it."
end

event 7  -- "Greetings"
  0:  SetMessage  {Str = 2}         -- "Welcome to Emerald Island!  I'll be your docent for your stay on the island.  It is my duty to see that you understand the rules of both the island and the contest.  For the duration of your stay on Emerald Island please refrain from gross violations of civilized behavior."
  1:  SetNPCTopic  {NPC = 3, Index = 0, Event = 8}         -- "Margaret the Docent" : "Emerald Island"
end

event 8  -- "Emerald Island"
  0:  SetMessage  {Str = 1}         --[[ "Emerald Island is southeast of Erathia, and far away from pirates and other ruffians.  It would be ideal, if not for the constant swarms of dragonflies that infest the island.  Fortunately, the large number of armed and skilled people this contest has attracted should thin their numbers a bit.

Lord Markham has supplemented the normally sparse village with a weapon, armor, and alchemist shop for your convenience during the contest.  A temple and basic magical guilds are also available.  I would suggest making sure that you are completely ready before you start off on the contest." ]]
end

event 9  -- "Contest"
  0:  CanShowTopic.Cmp  {"QBits", Value = 7,   jump = 3}         -- Finished Scavenger Hunt
  1:  CanShowTopic.Set  {Visible = true}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 4}         -- "The rules of the contest are simple:  The first person to return with the items is the winner.  All you need to do is collect a wealthy hat, a red potion, a longbow, a seashell, a musical instrument, and a floor tile from the Temple of the Moon and bring them to the judge to win."
end

event 10  -- "Scavenger Hunt"
  0:  SetMessage  {Str = 34}         -- "Are you contestants in Lord Markham's Scavenger Hunt?  How neat!  I'm here to provide entertainment to Lord Markham's entourage, the contestants, and to anyone else that would like to hear a song."
end

event 11  -- "Instruments"
  0:  SetMessage  {Str = 35}         -- "I own a few instruments, but I only brought my lute with me.  Its old and not quite as well kept as some of the others, but I didn't want one of my good instruments stolen by pirates or damaged from exposure to the humid, salty air."
end

event 12  -- "Lute"
  0:  ForPlayer  ("All")

  1:  CanShowTopic.Cmp  {"Inventory", Value = 632,   jump = 5}         -- "Lute"
  2:  CanShowTopic.Cmp  {"QBits", Value = 12,   jump = 5}         -- Brought instrument
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}
  5:  CanShowTopic.Set  {Visible = false}
  6:  CanShowTopic.Exit  {}

  7:  SetMessage  {Str = 36}         -- "You say you need an instrument for the Scavenger Hunt?  I suppose you could buy my lute, but I've had it for such a long time.  I guess I'd part with it for 500 gold.  Interested?"
  8:  SetNPCTopic  {NPC = 4, Index = 2, Event = 13}         -- "Ailyssa the Bard" : "Buy Lute for 500 gold"
end

event 13  -- "Buy Lute for 500 gold"
  0:  Cmp  {"Gold", Value = 500,   jump = 3}
  1:  SetMessage  {Str = 38}         -- "It would help if you had the 500 gold pieces.  Please don't try and cheat me out of my instrument."
  2:  Exit  {}

  3:  Subtract  {"Gold", Value = 500}
  4:  Add  {"Inventory", Value = 632}         -- "Lute"
  5:  SetMessage  {Str = 37}         -- "Well, promise to at least take care of it and not use it for firewood.  I suppose I'll have to make do without an instrument for the rest of this trip.  Maybe I should tell stories instead of sing until I get back home."
  6:  SetNPCItem  {NPC = 4, Item = 632, On = false}         -- "Ailyssa the Bard" : "Lute"
  7:  SetNPCTopic  {NPC = 4, Index = 2, Event = 0}         -- "Ailyssa the Bard"
  8:  SetNPCTopic  {NPC = 4, Index = 1, Event = 0}         -- "Ailyssa the Bard"
  9:  Exit  {}
end

event 14  -- "Ocean"
  0:  SetMessage  {Str = 12}         -- "I love being out on this side of the island, the view of the ocean is much better than from town, don't you agree?"
end

event 15  -- "Seashell"
  0:  SetMessage  {Str = 13}         -- "I have some nice sea shells for sale, shells that you can only find on Emerald Island.  Can I sell one to you?  They're only a hundred gold pieces each."
  1:  SetNPCTopic  {NPC = 5, Index = 1, Event = 16}         -- "Sally" : "Buy Seashell for 100 gold"
end

event 16  -- "Buy Seashell for 100 gold"
  0:  Cmp  {"Gold", Value = 100,   jump = 3}
  1:  SetMessage  {Str = 15}         -- "I really can't go any less than 100 gold; I need to make a living, too."
  2:  Exit  {}

  3:  Subtract  {"Gold", Value = 100}
  4:  Add  {"Inventory", Value = 635}         -- "Seashell"
  5:  SetMessage  {Str = 14}         -- "Here you go, I hope it reminds you of your trip to Emerald Island."
  6:  Exit  {}
end

event 17  -- "Harmondale"
  0:  CanShowTopic.Cmp  {"QBits", Value = 7,   jump = 3}         -- Finished Scavenger Hunt
  1:  CanShowTopic.Set  {Visible = true}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 10}         -- "We have reason to believe that whoever is in charge of Harmondale in the next few months will have an unprecedented opportunity to shape the future.  That is why I am here today--to make sure the shape of the future is pleasing to my associates.  I'm sure you understand."
end

event 18  -- "Proposal"
  0:  CanShowTopic.Cmp  {"QBits", Value = 7,   jump = 4}         -- Finished Scavenger Hunt
  1:  CanShowTopic.Cmp  {"Inventory", Value = 145,   jump = 4}         -- "Alacorn Wand of Fireballs"
  2:  CanShowTopic.Set  {Visible = true}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = false}
  5:  CanShowTopic.Exit  {}

  6:  SetMessage  {Str = 9}         -- "Allow me to introduce myself.  My name is Mr. Malwick.  I represent a group of, shall we say, ""investors in the future"".  I have been observing you since you arrived on this island, and I believe your values and goals have much in common with ours.  I am empowered to grant you a fireball wand to help you win the Hunt today, in exchange for a favor in the future.  What do you say?"
  7:  SetNPCTopic  {NPC = 6, Index = 0, Event = 19}         -- "Mr. Malwick" : "Accept Wand"
  8:  SetNPCTopic  {NPC = 6, Index = 1, Event = 20}         -- "Mr. Malwick" : "Decline Wand"
end

event 19  -- "Accept Wand"
  0:  CanShowTopic.Cmp  {"QBits", Value = 7,   jump = 3}         -- Finished Scavenger Hunt
  1:  CanShowTopic.Set  {Visible = true}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 11}         -- "Excellent.  Sometime in the future, I or a representative of my group will call on you to return the favor.  I hope you won't disappoint us.  Here is your fireball wand.  We should not be seen talking again, the others might get suspicious."
  6:  Set  {"QBits", Value = 14}         -- Accepted Fireball wand from Malwick
  7:  Set  {"AutonotesBits", Value = 1}         -- ""
  8:  Add  {"Inventory", Value = 145}         -- "Alacorn Wand of Fireballs"
  9:  SetNPCItem  {NPC = 6, Item = 145, On = false}         -- "Mr. Malwick" : "Alacorn Wand of Fireballs"
  10: SetNPCTopic  {NPC = 6, Index = 0, Event = 17}         -- "Mr. Malwick" : "Harmondale"
  11: SetNPCTopic  {NPC = 6, Index = 1, Event = 0}         -- "Mr. Malwick"
  12: SetNPCGreeting  {NPC = 6, Greeting = 7}         -- "Mr. Malwick" : "Did you need something, stranger?  <whisper> Get away from me, are you trying to get caught on purpose?!"
end

event 20  -- "Decline Wand"
  0:  CanShowTopic.Cmp  {"QBits", Value = 7,   jump = 3}         -- Finished Scavenger Hunt
  1:  CanShowTopic.Set  {Visible = true}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 3}         -- "I respect your decision.  I am, however, a patient man, and will offer you this chance until a winner in the contest is proclaimed."
  6:  SetNPCTopic  {NPC = 6, Index = 0, Event = 17}         -- "Mr. Malwick" : "Harmondale"
  7:  SetNPCTopic  {NPC = 6, Index = 1, Event = 18}         -- "Mr. Malwick" : "Proposal"
end

event 21  -- "Your hat, please…"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 631,   jump = 3}         -- "Wealthy Hat"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 16}         -- "I see you have a fine hat, there.  How about a deal:  You give me your hat, and we let you keep your lives?"
  6:  SetNPCTopic  {NPC = 7, Index = 0, Event = 23}         -- "Sal Sharktooth" : "Give Hat to Sal"
  7:  SetNPCTopic  {NPC = 7, Index = 1, Event = 24}         -- "Sal Sharktooth" : "Keep Hat"
end

event 22  -- "Temple"
  0:  SetMessage  {Str = 19}         -- "This Temple is a pretty nasty place.  You should probably watch your back around here-- you never know what might want to kill you."
end

event 23  -- "Give Hat to Sal"
  0:  SetMessage  {Str = 17}         -- "Thanks for the hat, friend!"
  1:  ForPlayer  ("All")
  2:  Subtract  {"Inventory", Value = 631}         -- "Wealthy Hat"
  3:  SetNPCTopic  {NPC = 7, Index = 0, Event = 0}         -- "Sal Sharktooth"
  4:  SetNPCTopic  {NPC = 7, Index = 1, Event = 25}         -- "Sal Sharktooth" : "I warned you…"
  5:  SetNPCItem  {NPC = 7, Item = 631, On = true}         -- "Sal Sharktooth" : "Wealthy Hat"
end

event 24  -- "Keep Hat"
  0:  SetMessage  {Str = 18}         -- "You should have accepted my offer…"
  1:  SetNPCTopic  {NPC = 7, Index = 0, Event = 0}         -- "Sal Sharktooth"
  2:  SetNPCTopic  {NPC = 7, Index = 1, Event = 0}         -- "Sal Sharktooth"
  3:  SetMonGroupBit  {NPCGroup = 3, Bit = const.MonsterBits.Hostile, On = true}         -- ""
end

event 25  -- "I warned you…"
  0:  SetMessage  {Str = 20}         -- "You should have listened to me; I warned you this was a nasty place.  Now get out of here before I decide to take something else from you."
end

event 26  -- "Very well, then…"
  0:  CanShowTopic.Cmp  {"QBits", Value = 7,   jump = 3}         -- Finished Scavenger Hunt
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 21}         -- "I take this to mean you don't wish to accept my proposal.  I believe our business is concluded."
  6:  SetNPCTopic  {NPC = 6, Index = 2, Event = 0}         -- "Mr. Malwick"
end

event 27  -- "Potion for a Hat?"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 222,   jump = 3}         -- "Cure Wounds"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 39}         -- "Hello there!  I suppose you're part of the contest?  Good to hear.  We were wondering if you would want to trade a red potion, assuming you have one, for a hat.  We could help each other along a little."
  6:  SetNPCTopic  {NPC = 8, Index = 0, Event = 30}         -- "Brent Filiant" : "Trade Potion for Hat"
  7:  SetNPCTopic  {NPC = 8, Index = 1, Event = 31}         -- "Brent Filiant" : "Keep Potion"
  8:  SetNPCTopic  {NPC = 8, Index = 2, Event = 0}         -- "Brent Filiant"
end

event 28  -- "Brigands"
  0:  SetMessage  {Str = 22}         -- "The toughest band of contestants have apparently hid out in the Temple of the Moon.  I think they might be wanting to ambush any group that tries to go there."
end

event 29  -- "Blue Potions"
  0:  SetMessage  {Str = 23}         -- "I know how to make a blue potion, but not red ones…Just about any blue herb will do.  Just mix it with an empty bottle and voila!  Instant blue potion.  I guess that making a red potion is similar, but I'm not sure.  They say mixing potions improperly can have really bad effects."
end

event 30  -- "Trade Potion for Hat"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 222,   jump = 7}         -- "Cure Wounds"
  2:  SetMessage  {Str = 42}         -- "Is this some sort of trick?  You don't even have a red potion.  You don't think I'll just give you the hat, do you?"
  3:  SetNPCTopic  {NPC = 8, Index = 0, Event = 0}         -- "Brent Filiant"
  4:  SetNPCTopic  {NPC = 8, Index = 1, Event = 28}         -- "Brent Filiant" : "Brigands"
  5:  SetNPCTopic  {NPC = 8, Index = 2, Event = 29}         -- "Brent Filiant" : "Blue Potions"
  6:  Exit  {}

  7:  SetMessage  {Str = 40}         -- "Wonderful!  Here's the hat and I'll take the potion.  Thanks so much, now we're almost finished with our list."
  8:  ForPlayer  ("Current")
  9:  Subtract  {"Inventory", Value = 222}         -- "Cure Wounds"
  10: Add  {"Inventory", Value = 631}         -- "Wealthy Hat"
  11: SetNPCItem  {NPC = 8, Item = 631, On = false}         -- "Brent Filiant" : "Wealthy Hat"
  12: SetNPCItem  {NPC = 8, Item = 222, On = true}         -- "Brent Filiant" : "Cure Wounds"
  13: SetNPCGroupNews  {NPCGroup = 2, NPCNews = 6}         -- "" : "Thanks for trading with us!"
  14: GoTo  {jump = 3}
end

event 31  -- "Keep Potion"
  0:  SetMessage  {Str = 41}         -- "What's the matter?  You don't like to work with others?  Fine then, you'll get no help from us."
  1:  SetNPCTopic  {NPC = 8, Index = 0, Event = 27}         -- "Brent Filiant" : "Potion for a Hat?"
  2:  SetNPCTopic  {NPC = 8, Index = 1, Event = 28}         -- "Brent Filiant" : "Brigands"
  3:  SetNPCTopic  {NPC = 8, Index = 2, Event = 29}         -- "Brent Filiant" : "Blue Potions"
end

event 32  -- "Boat Travel"
  0:  SetMessage  {Str = 24}         -- "Sorry mates, this vessel's moored until a winner has been declared in the contest."
end

event 33  -- "Cast off!"
  0:  SetMessage  {Str = 43}         -- "Good job, mates!  We'll be heading off for Harmondale right now.  Congratulations."
  1:  Subtract  {"QBits", Value = 16}         -- "Find the missing contestants on Emerald Island and bring back proof to Lord Markham."
  2:  SetNPCTopic  {NPC = 1, Index = 3, Event = 0}         -- "Lord Markham"
  3:  Add  {"History1", Value = 0}
  4:  Add  {"History2", Value = 0}
  5:  MoveNPC  {NPC = 1, HouseId = 275}         -- "Lord Markham" -> "Lord Markham's Chamber"
  6:  SetNPCGreeting  {NPC = 1, Greeting = 205}         -- "Lord Markham" : "Hmmph.  You don't actually expect me to act as though you really were a noble, do you?  Once a peasant, always a peasant, that's what my mother used to say.  Really, could you use the servant's entrance next time you stop by?  It really is embarrassing to have you dusty, mud spattered peasants coming in through the front door.  What will the neighbors think?"
  7:  Add  {"QBits", Value = 136}         -- Party doesn't come back to Out01 temple anymore
  8:  ShowMovie  {DoubleSize = 1, ExitCurrentScreen = true, Name = "pcout01 "}
  9:  MoveToMap  {X = -17331, Y = 12547, Z = 465, Direction = 1024, LookAngle = 0, SpeedZ = 0, HouseId = 0, Icon = 0, Name = "Out02.odm"}
end

event 34  -- "Missing Contestants"
  0:  SetMessage  {Str = 44}         -- "Keep in mind I have a 1000 gold reward for the group to bring back information on the contestants that have disappeared."
  1:  SetNPCTopic  {NPC = 1, Index = 3, Event = 35}         -- "Lord Markham" : "Missing Contestants"
  2:  Set  {"QBits", Value = 16}         -- "Find the missing contestants on Emerald Island and bring back proof to Lord Markham."
end

event 35  -- "Missing Contestants"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 658,   jump = 4}         -- "Contestant's Shield"
  2:  SetMessage  {Str = 45}         -- "No news on the missing people yet?"
  3:  Exit  {}

  4:  SetMessage  {Str = 46}         -- "There really is a dragon on the island?  I thought everyone was referring to the dragonflies everywhere.  I'll warn everyone to stay away from that cave so we don't lose anyone else."
  5:  Subtract  {"Inventory", Value = 658}         -- "Contestant's Shield"
  6:  Add  {"Awards", Value = 3}         -- "Found the missing contestants on Emerald Island"
  7:  Add  {"Experience", Value = 1000}
  8:  ForPlayer  ("Current")
  9:  Add  {"Gold", Value = 1000}
  10: Subtract  {"Reputation", Value = 5}
  11: Subtract  {"QBits", Value = 16}         -- "Find the missing contestants on Emerald Island and bring back proof to Lord Markham."
  12: SetNPCTopic  {NPC = 1, Index = 3, Event = 0}         -- "Lord Markham"
end

event 36  -- "Missing People"
  0:  SetMessage  {Str = 47}         -- "Hmm… I recall a few strangers poking around the entrance to the Dragon's Cave recently.  I didn't notice if they went inside, but I haven't seen them around since.  They must have realized how dangerous that place is and headed back to town."
end

event 37  -- "Abandoned Temple"
  0:  SetMessage  {Str = 48}         -- "The cave right behind my house is not the Abandoned Temple.  It belongs to Morcarack the Pitiless, the Dragon of Emerald Island.  He doesn't appreciate visitors, so I wouldn't advise going there.  The Abandoned Temple is buried in the hill south of my house.  You can get to it by entering the caves at the top of the hill."
end

event 38  -- "Dragonflies"
  0:  SetMessage  {Str = 49}         -- "Wild Dragonflies have infested the northwestern side of Emerald Island recently, making it dangerous to store things in our shed out there.  Dragonflies aren't terribly powerful, but they are fast and can even occasionally shoot fire at you.  Don't take them too lightly!"
end

event 39  -- "Dragon"
  0:  SetMessage  {Str = 50}         -- "The Dragon of Emerald Island lives in a cave in the northeast.  I wouldn't go there, though, he doesn't like visitors.  He spares our town so that we may pay him tribute, and in return he keeps pirates and undesirables out."
end

event 40  -- "Dragon Cave"
  0:  SetMessage  {Str = 51}         -- "You're contestants in the Scavenger Hunt?  If so, I wouldn't wander off to the Dragon Cave, then.  Morcarack doesn't tolerate strangers very well.  I bet the missing people went there thinking his cave was the Abandoned Temple--they're probably long dead."
end

event 41  -- "Contestants"
  0:  SetMessage  {Str = 52}         -- "I'd watch those other contestants-- some of them seem ruthless.  One particularly nasty group headed to the north side of the island, and I haven't seen them since.  I'm surprised at the attention this contest has received, apparently people are hoping to get on the good side of the contestants for future favors if they win."
end

event 42  -- "Tour Off"
  0:  SetMessage  {Str = 53}         -- "You have decided that you no longer desire my information about the places on Emerald Island.  If you later decide that you'd like to hear what I have to say, then select Tour On."
  1:  Set  {"QBits", Value = 17}         -- No more docent babble
  2:  SetNPCTopic  {NPC = 3, Index = 2, Event = 43}         -- "Margaret the Docent" : "Tour On"
end

event 43  -- "Tour On"
  0:  SetMessage  {Str = 54}         -- "You have decided to listen to my tour about the points of interest on Emerald Island.  If you decide that you no longer want me to point out areas of interest then select Tour Off."
  1:  Subtract  {"QBits", Value = 17}         -- No more docent babble
  2:  SetNPCTopic  {NPC = 3, Index = 2, Event = 42}         -- "Margaret the Docent" : "Tour Off"
end

event 44  -- "Rogue "
  0:  SetMessage  {Str = 55}         -- "Though the law may decide who is guilty and who is not, I decide who is called Thief, and who is just a criminal.  Bring me that lovely vase I saw on the mantle in Lord Markham’s manor, and I shall call you Rogue."
  1:  Add  {"QBits", Value = 18}         -- "Go to Lord Markham's estate in Tatalia, steal the vase there, and return it to William Lasker in the Erathian Sewers."
  2:  SetNPCTopic  {NPC = 15, Index = 0, Event = 45}         -- "William Lasker" : "Rogue "
end

event 45  -- "Rogue "
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 624,   jump = 4}         -- "Vase"
  2:  SetMessage  {Str = 56}         -- "Common criminals steal whatever catches their eye; Rogues steal what I tell them to steal.  I shall not grant titles to failures.  Return with Lord Markham’s Vase and I will promote all Thieves to Rogues, and all non-thieves to Honorary Rogues."
  3:  Exit  {}

  4:  SetMessage  {Str = 57}         -- "Well done.  Stealing that vase took guts and skill.  I grant you the title of Rogue, and a small payment for your services. "
  5:  ForPlayer  (0)
  6:  Cmp  {"ClassIs", Value = const.Class.Thief,   jump = 10}
  7:  Add  {"Awards", Value = 11}         -- "Promoted to Honorary Rogue"
  8:  Add  {"Experience", Value = 15000}
  9:  GoTo  {jump = 13}

  10: Set  {"ClassIs", Value = const.Class.Rogue}
  11: Add  {"Awards", Value = 10}         -- "Promoted to Rogue"
  12: Add  {"Experience", Value = 30000}
  13: ForPlayer  (1)
  14: Cmp  {"ClassIs", Value = const.Class.Thief,   jump = 18}
  15: Add  {"Awards", Value = 11}         -- "Promoted to Honorary Rogue"
  16: Add  {"Experience", Value = 15000}
  17: GoTo  {jump = 21}

  18: Set  {"ClassIs", Value = const.Class.Rogue}
  19: Add  {"Awards", Value = 10}         -- "Promoted to Rogue"
  20: Add  {"Experience", Value = 30000}
  21: ForPlayer  (2)
  22: Cmp  {"ClassIs", Value = const.Class.Thief,   jump = 26}
  23: Add  {"Awards", Value = 11}         -- "Promoted to Honorary Rogue"
  24: Add  {"Experience", Value = 15000}
  25: GoTo  {jump = 29}

  26: Set  {"ClassIs", Value = const.Class.Rogue}
  27: Add  {"Awards", Value = 10}         -- "Promoted to Rogue"
  28: Add  {"Experience", Value = 30000}
  29: ForPlayer  (3)
  30: Cmp  {"ClassIs", Value = const.Class.Thief,   jump = 34}
  31: Add  {"Awards", Value = 11}         -- "Promoted to Honorary Rogue"
  32: Add  {"Experience", Value = 15000}
  33: GoTo  {jump = 37}

  34: Set  {"ClassIs", Value = const.Class.Rogue}
  35: Add  {"Awards", Value = 10}         -- "Promoted to Rogue"
  36: Add  {"Experience", Value = 30000}
  37: Subtract  {"Inventory", Value = 624}         -- "Vase"
  38: Subtract  {"QBits", Value = 212}         -- Vase - I lost it
  39: ForPlayer  ("All")
  40: ForPlayer  ("Current")
  41: Add  {"Gold", Value = 5000}
  42: Subtract  {"QBits", Value = 18}         -- "Go to Lord Markham's estate in Tatalia, steal the vase there, and return it to William Lasker in the Erathian Sewers."
  43: SetNPCTopic  {NPC = 15, Index = 0, Event = 46}         -- "William Lasker" : "Spy"
end

event 46  -- "Spy"
  0:  ForPlayer  ("All")
  1:  Cmp  {"QBits", Value = 99,   jump = 8}         -- Chose the path of Light
  2:  Cmp  {"QBits", Value = 100,   jump = 4}         -- Chose the path of Dark
  3:  GoTo  {jump = 6}

  4:  SetMessage  {Str = 58}         -- "You have chosen the path of Darkness, and I will promote you no further.  Perhaps an Assassin would have something to teach you.  I hear there is one in Deyja."
  5:  Exit  {}

  6:  SetMessage  {Str = 59}         -- "You are not quite ready to take the next step.  The time is fast approaching when you must decide whether to follow the path of light, or the path of darkness.  If you choose the Light, return to me to complete your training."
  7:  Exit  {}

  8:  SetMessage  {Str = 60}         -- "Your next task is somewhat more difficult…more suited for Spies than Rogues.  I have been asked to ensure that Watchtower 6, the only tower to survive the recent wars against the Necromancers, be unable to defend itself the next time it is attacked.  Killing the guards inside won’t help—the Necromancers will just fill it again with more troops.  The tower is on the southern edge of the Necromancers’ land.  I want you to slip inside and move the counterweight in the gatehouse at the top of the tower to the gatehouse at the bottom of the tower.  It is a heavy weight that can be found in a slot against the wall with a rope tied to it.  When the time comes for an attack, the misplaced weights will be noticed too late, and the gate will not close.  If you can do this, you will have proven your status as a Spy."
  9:  Set  {"QBits", Value = 19}         -- "Go to Watchtower 6 in the Deyja Moors, and move the weight from the top of the tower to the bottom of the tower.  Then return to William Lasker in the Erathian Sewers."
  10: SetNPCTopic  {NPC = 15, Index = 0, Event = 47}         -- "William Lasker" : "Spy"
end

event 47  -- "Spy"
  0:  ForPlayer  ("All")
  1:  Cmp  {"QBits", Value = 20,   jump = 10}         -- Watchtower 6.  Weight in the appropriate box.  Important for Global event 47 (Spy promotion)
  2:  Cmp  {"Inventory", Value = 999,   jump = 6}         -- not found!
  3:  Cmp  {"QBits", Value = 56,   jump = 8}         -- Watchtower 6.  Taken the weight from the upper gatehouse.  Spy promo quest
  4:  SetMessage  {Str = 63}         -- "You haven’t done the job yet!  Remember, you must go to Watchtower 6 and move the weight from the box in the upper gatehouse to the lower gatehouse.  I will not promote you until that is done. "
  5:  Exit  {}

  6:  SetMessage  {Str = 61}         -- "Um…The weight needs to go in the box in the lower gatehouse—not here.  Go back to Watchtower 6 and put the weight in the right box!"
  7:  Exit  {}

  8:  SetMessage  {Str = 62}         -- "Hmm.  Removing the weight from the upper gatehouse was a start, but where is it now?!?  The plan won’t work unless you put the weight in the lower gatehouse!  Go back to Watchtower 6 and put the weight in the right box!"
  9:  Exit  {}

  10: SetMessage  {Str = 64}         -- "Good work!  Some day, your sabotage of that watchtower will save hundreds of lives.  For your services, I hereby promote the Rogues among you to the status of Spy, and the Honorary Rogues to Honorary Spies! Oh, and here’s some gold as payment. "
  11: ForPlayer  (0)
  12: Cmp  {"ClassIs", Value = const.Class.Rogue,   jump = 16}
  13: Add  {"Awards", Value = 13}         -- "Promoted to Honorary Spy"
  14: Add  {"Experience", Value = 40000}
  15: GoTo  {jump = 19}

  16: Set  {"ClassIs", Value = const.Class.Spy}
  17: Add  {"Awards", Value = 12}         -- "Promoted to Spy"
  18: Add  {"Experience", Value = 80000}
  19: ForPlayer  (1)
  20: Cmp  {"ClassIs", Value = const.Class.Rogue,   jump = 24}
  21: Add  {"Awards", Value = 13}         -- "Promoted to Honorary Spy"
  22: Add  {"Experience", Value = 40000}
  23: GoTo  {jump = 27}

  24: Set  {"ClassIs", Value = const.Class.Spy}
  25: Add  {"Awards", Value = 12}         -- "Promoted to Spy"
  26: Add  {"Experience", Value = 80000}
  27: ForPlayer  (2)
  28: Cmp  {"ClassIs", Value = const.Class.Rogue,   jump = 32}
  29: Add  {"Awards", Value = 13}         -- "Promoted to Honorary Spy"
  30: Add  {"Experience", Value = 40000}
  31: GoTo  {jump = 35}

  32: Set  {"ClassIs", Value = const.Class.Spy}
  33: Add  {"Awards", Value = 12}         -- "Promoted to Spy"
  34: Add  {"Experience", Value = 80000}
  35: ForPlayer  (3)
  36: Cmp  {"ClassIs", Value = const.Class.Rogue,   jump = 40}
  37: Add  {"Awards", Value = 13}         -- "Promoted to Honorary Spy"
  38: Add  {"Experience", Value = 40000}
  39: GoTo  {jump = 43}

  40: Set  {"ClassIs", Value = const.Class.Spy}
  41: Add  {"Awards", Value = 12}         -- "Promoted to Spy"
  42: Add  {"Experience", Value = 80000}
  43: Add  {"Gold", Value = 15000}
  44: Subtract  {"QBits", Value = 19}         -- "Go to Watchtower 6 in the Deyja Moors, and move the weight from the top of the tower to the bottom of the tower.  Then return to William Lasker in the Erathian Sewers."
  45: ForPlayer  ("All")
  46: SetNPCTopic  {NPC = 15, Index = 0, Event = 0}         -- "William Lasker"
  47: SetNPCGreeting  {NPC = 15, Greeting = 39}         -- "William Lasker" : "Greetings Spies, how may I be of service?"
end

event 48  -- "Drink Tea"
  0:  Cmp  {"EnduranceBonus", Value = 50,   jump = 3}
  1:  Set  {"EnduranceBonus", Value = 50}
  2:  StatusText  {Str = 66}         -- "Refreshing! (+50 Endurance temporary)"
  3:  Exit  {}
end

event 49  -- "Assassin"
  0:  ForPlayer  ("All")
  1:  Cmp  {"QBits", Value = 99,   jump = 6}         -- Chose the path of Light
  2:  Cmp  {"Awards", Value = 10,   jump = 8}         -- "Promoted to Rogue"
  3:  Cmp  {"Awards", Value = 11,   jump = 8}         -- "Promoted to Honorary Rogue"
  4:  SetMessage  {Str = 70}         -- "If you were looking for someone to train you in advanced stealth techniques, I  would be your man.  But you still need someone to teach you basic techniques.  Return to me when you achieve Rogue or Honorary Rogue status.  Then, perhaps, I can further your education.  Seek the Master Thief in the sewers of Erathia."
  5:  Exit  {}

  6:  SetMessage  {Str = 68}         -- "You have chosen the path of Light, and therefore can never become an effective Assassin.  I cannot train you.  Perhaps you should continue a softer hearted training with the Spy."
  7:  Exit  {}

  8:  Cmp  {"QBits", Value = 100,   jump = 11}         -- Chose the path of Dark
  9:  SetMessage  {Str = 69}         -- "I can turn a simple Rogue into a fearsome killer, but only if he has the right kind of temperament for the job.  The time is coming when you must choose to walk in the light, or in the dark.  If you prefer the shadow, come to me and I will complete your training."
  10: Exit  {}

  11: SetMessage  {Str = 67}         -- "So…you wish to become an Assassin.  Very well.  I can provide the Rogues among you the training necessary, but you must prove both your skill and your loyalty before I will invest time in you.  My superiors inform me that a certain Lady Eleanor Carmine’s life must end.  She used to work for us, but has taken up residence in the Celestial Court with our enemies, and is providing them with information damaging to our cause.  Silence her, and return with a trinket of hers to prove the job is done."
  12: Set  {"QBits", Value = 21}         -- "Go to the Celestial Court in Celeste and kill Lady Eleanor Carmine.  Return with proof to Seknit Undershadow in the Deyja Moors."
  13: SetNPCTopic  {NPC = 16, Index = 1, Event = 50}         -- "Seknit Undershadow" : "Assassin"
end

event 50  -- "Assassin"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 540,   jump = 4}         -- "Lady Carmine's Dagger"
  2:  SetMessage  {Str = 71}         -- "Without proof, I cannot assume Lady Carmine is dead.  Bring me proof, and I will honor you with the title of Assassin."
  3:  Exit  {}

  4:  SetMessage  {Str = 72}         -- "So, the job is done. [He examines the dagger slowly, then sighs.] She was very dear to me, but emotion is the enemy of reason.  I could not have done the job myself.  Thank you.  Truly now, you are Assassins.  The rogues among you, I will give special training to.  Here is a small payment to help cover the expenses you incurred on the job. "
  5:  ForPlayer  (0)
  6:  Cmp  {"ClassIs", Value = const.Class.Rogue,   jump = 10}
  7:  Add  {"Awards", Value = 15}         -- "Promoted to Honorary Assassin"
  8:  Add  {"Experience", Value = 40000}
  9:  GoTo  {jump = 13}

  10: Set  {"ClassIs", Value = const.Class.Assassin}
  11: Add  {"Awards", Value = 14}         -- "Promoted to Assassin"
  12: Add  {"Experience", Value = 80000}
  13: ForPlayer  (1)
  14: Cmp  {"ClassIs", Value = const.Class.Rogue,   jump = 18}
  15: Add  {"Awards", Value = 15}         -- "Promoted to Honorary Assassin"
  16: Add  {"Experience", Value = 40000}
  17: GoTo  {jump = 21}

  18: Set  {"ClassIs", Value = const.Class.Assassin}
  19: Add  {"Awards", Value = 14}         -- "Promoted to Assassin"
  20: Add  {"Experience", Value = 80000}
  21: ForPlayer  (2)
  22: Cmp  {"ClassIs", Value = const.Class.Rogue,   jump = 26}
  23: Add  {"Awards", Value = 15}         -- "Promoted to Honorary Assassin"
  24: Add  {"Experience", Value = 40000}
  25: GoTo  {jump = 29}

  26: Set  {"ClassIs", Value = const.Class.Assassin}
  27: Add  {"Awards", Value = 14}         -- "Promoted to Assassin"
  28: Add  {"Experience", Value = 80000}
  29: ForPlayer  (3)
  30: Cmp  {"ClassIs", Value = const.Class.Rogue,   jump = 34}
  31: Add  {"Awards", Value = 15}         -- "Promoted to Honorary Assassin"
  32: Add  {"Experience", Value = 40000}
  33: GoTo  {jump = 37}

  34: Set  {"ClassIs", Value = const.Class.Assassin}
  35: Add  {"Awards", Value = 14}         -- "Promoted to Assassin"
  36: Add  {"Experience", Value = 80000}
  37: Add  {"Gold", Value = 15000}
  38: Subtract  {"QBits", Value = 213}         -- Dagger - I lost it
  39: Subtract  {"QBits", Value = 21}         -- "Go to the Celestial Court in Celeste and kill Lady Eleanor Carmine.  Return with proof to Seknit Undershadow in the Deyja Moors."
  40: Add  {"Reputation", Value = 10}
  41: ForPlayer  ("All")
  42: SetNPCTopic  {NPC = 16, Index = 1, Event = 0}         -- "Seknit Undershadow"
  43: SetNPCGreeting  {NPC = 16, Greeting = 42}         -- "Seknit Undershadow" : "Hello again, fellow Assassins.  My tea and company are always yours."
end

event 51  -- "Crusader"
  0:  SetMessage  {Str = 74}         -- "Ha! So, thee wishes to take the test to be a crusader?  I cannot blame thee—the sense of pride one feels when one has accomplished a heroic deed is sublime!  The test is simple.  A dragon must be slain.  I know just the one—Wromthrax the Heartless!  He lives in a cave in Tatalia, and terrorizes the peasants who live near him when he’s home.  He should be in the cave this time of year.  Because this is probably thine first dragon, I will travel with thee to give thee pointers.  So, let us go forthwith, and spill this monster’s black blood!"
  1:  SetNPCTopic  {NPC = 17, Index = 0, Event = 52}         -- "Sir Charles Quixote" : "Crusader"
  2:  MoveNPC  {NPC = 17, HouseId = 0}         -- "Sir Charles Quixote"
  3:  Set  {"QBits", Value = 22}         -- "Kill Wromthrax the Heartless in his cave in Tatalia, then talk to Sir Charles Quixote."
  4:  SetNPCGreeting  {NPC = 17, Greeting = 44}         -- "Sir Charles Quixote" : "Why do we dally?  Even now that monster could be laying waste to the countryside!  Tally Ho!"
  5:  Set  {"NPCs", Value = 17}         -- "Sir Charles Quixote"
end

event 52  -- "Crusader"
  0:  ForPlayer  ("All")
  1:  Cmp  {"QBits", Value = 23,   jump = 4}         -- Killed dragon when on Crusader quest
  2:  SetMessage  {Str = 76}         -- "We must finish our quest before I can name thee Crusaders, friends."
  3:  Exit  {}

  4:  SetMessage  {Str = 75}         -- "Hurrah!  The Dragon has fallen!  Truly thou art grand Crusaders in good standing, with a fine deed behind thee.  I would stay and sing songs of thy bravery with thee, but duty calls.  Surely we will meet again, Crusaders!"
  5:  ForPlayer  (0)
  6:  Cmp  {"ClassIs", Value = const.Class.Paladin,   jump = 10}
  7:  Add  {"Awards", Value = 41}         -- "Promoted to Honorary Crusader"
  8:  Add  {"Experience", Value = 15000}
  9:  GoTo  {jump = 13}

  10: Set  {"ClassIs", Value = const.Class.Crusader}
  11: Add  {"Awards", Value = 40}         -- "Promoted to Crusader"
  12: Add  {"Experience", Value = 30000}
  13: ForPlayer  (1)
  14: Cmp  {"ClassIs", Value = const.Class.Paladin,   jump = 18}
  15: Add  {"Awards", Value = 41}         -- "Promoted to Honorary Crusader"
  16: Add  {"Experience", Value = 15000}
  17: GoTo  {jump = 21}

  18: Set  {"ClassIs", Value = const.Class.Crusader}
  19: Add  {"Awards", Value = 40}         -- "Promoted to Crusader"
  20: Add  {"Experience", Value = 30000}
  21: ForPlayer  (2)
  22: Cmp  {"ClassIs", Value = const.Class.Paladin,   jump = 26}
  23: Add  {"Awards", Value = 41}         -- "Promoted to Honorary Crusader"
  24: Add  {"Experience", Value = 15000}
  25: GoTo  {jump = 29}

  26: Set  {"ClassIs", Value = const.Class.Crusader}
  27: Add  {"Awards", Value = 40}         -- "Promoted to Crusader"
  28: Add  {"Experience", Value = 30000}
  29: ForPlayer  (3)
  30: Cmp  {"ClassIs", Value = const.Class.Paladin,   jump = 34}
  31: Add  {"Awards", Value = 41}         -- "Promoted to Honorary Crusader"
  32: Add  {"Experience", Value = 15000}
  33: GoTo  {jump = 37}

  34: Set  {"ClassIs", Value = const.Class.Crusader}
  35: Add  {"Awards", Value = 40}         -- "Promoted to Crusader"
  36: Add  {"Experience", Value = 30000}
  37: Subtract  {"QBits", Value = 22}         -- "Kill Wromthrax the Heartless in his cave in Tatalia, then talk to Sir Charles Quixote."
  38: Subtract  {"NPCs", Value = 17}         -- "Sir Charles Quixote"
  39: Subtract  {"Reputation", Value = 5}
  40: ForPlayer  ("All")
  41: MoveNPC  {NPC = 17, HouseId = 303}         -- "Sir Charles Quixote" -> "Quixote Residence"
  42: SetNPCTopic  {NPC = 17, Index = 0, Event = 53}         -- "Sir Charles Quixote" : "Hero"
  43: SetNPCGreeting  {NPC = 17, Greeting = 43}         -- "Sir Charles Quixote" : "Well met, my friends.  How goes the struggle against the forces of evil?"
end

event 53  -- "Hero"
  0:  Cmp  {"QBits", Value = 99,   jump = 6}         -- Chose the path of Light
  1:  Cmp  {"QBits", Value = 100,   jump = 4}         -- Chose the path of Dark
  2:  SetMessage  {Str = 79}         -- "Ah, fellow Crusaders!  I know thee thirsts for another task with which to hone thy Crusading skills, but first thee must pass a far more serious test.  Thee must agree to follow the Path of Light before I can help thee further.  You will know when you have made this choice.  Return to me then."
  3:  Exit  {}

  4:  SetMessage  {Str = 78}         -- "I will not have truck with thee further, scoundrel!  I see now thee hath chosen the path of Darkness.  Mayhaps thee should seek a villain like thyself for training."
  5:  Exit  {}

  6:  SetMessage  {Str = 77}         -- "I am pleased to see thee chose the path of Light, Crusaders!  A wrong has been committed, friends, and who else but us can put it right?  A wicked villain has kidnapped a fair maiden by the name of Alice Hargreaves.  His name is William Setag, and he has imprisoned her in his tower.  You must ride forthwith to put this villain to the sword and rescue sweet Alice!  If you succeed, you will truly be Heroes of the Land!"
  7:  SetNPCTopic  {NPC = 17, Index = 0, Event = 54}         -- "Sir Charles Quixote" : "Hero"
  8:  Set  {"QBits", Value = 24}         -- "Rescue Alice Hargreaves from William's Tower in the Deyja Moors then talk to Sir Charles Quixote."
  9:  SetNPCGreeting  {NPC = 17, Greeting = 43}         -- "Sir Charles Quixote" : "Well met, my friends.  How goes the struggle against the forces of evil?"
  10: MoveNPC  {NPC = 54, HouseId = 522}         -- "Alice Hargreaves" -> "Alice Hargreaves"
end

event 54  -- "Hero"
  0:  Cmp  {"NPCs", Value = 54,   jump = 3}         -- "Alice Hargreaves"
  1:  SetMessage  {Str = 81}         -- "Though thy deeds remain impressive indeed, crusaders, I cannot declare thee Heroes until you have rescued the girl!"
  2:  Exit  {}

  3:  SetMessage  {Str = 80}         -- "Thee’ve done it! I knew thee could do it!  I’m so proud of thee!  Alice has been freed of the clutches of the wicked William Setag, evil has been vanquished, and good upheld.  Where once there was wrong, now there is right! [Charles sighs and smiles broadly] Well.  My work here is done!  Thee have passed the tests and deserve thy reward.  Therefore do I solemnly declare thee Heroes! "
  4:  ForPlayer  (0)
  5:  Cmp  {"ClassIs", Value = const.Class.Crusader,   jump = 9}
  6:  Add  {"Awards", Value = 43}         -- "Promoted to Honorary Hero"
  7:  Add  {"Experience", Value = 40000}
  8:  GoTo  {jump = 12}

  9:  Set  {"ClassIs", Value = const.Class.Hero}
  10: Add  {"Awards", Value = 42}         -- "Promoted to Hero"
  11: Add  {"Experience", Value = 80000}
  12: ForPlayer  (1)
  13: Cmp  {"ClassIs", Value = const.Class.Crusader,   jump = 17}
  14: Add  {"Awards", Value = 43}         -- "Promoted to Honorary Hero"
  15: Add  {"Experience", Value = 40000}
  16: GoTo  {jump = 20}

  17: Set  {"ClassIs", Value = const.Class.Hero}
  18: Add  {"Awards", Value = 42}         -- "Promoted to Hero"
  19: Add  {"Experience", Value = 80000}
  20: ForPlayer  (2)
  21: Cmp  {"ClassIs", Value = const.Class.Crusader,   jump = 25}
  22: Add  {"Awards", Value = 43}         -- "Promoted to Honorary Hero"
  23: Add  {"Experience", Value = 40000}
  24: GoTo  {jump = 28}

  25: Set  {"ClassIs", Value = const.Class.Hero}
  26: Add  {"Awards", Value = 42}         -- "Promoted to Hero"
  27: Add  {"Experience", Value = 80000}
  28: ForPlayer  (3)
  29: Cmp  {"ClassIs", Value = const.Class.Crusader,   jump = 33}
  30: Add  {"Awards", Value = 43}         -- "Promoted to Honorary Hero"
  31: Add  {"Experience", Value = 40000}
  32: GoTo  {jump = 36}

  33: Set  {"ClassIs", Value = const.Class.Hero}
  34: Add  {"Awards", Value = 42}         -- "Promoted to Hero"
  35: Add  {"Experience", Value = 80000}
  36: Subtract  {"QBits", Value = 24}         -- "Rescue Alice Hargreaves from William's Tower in the Deyja Moors then talk to Sir Charles Quixote."
  37: Subtract  {"NPCs", Value = 54}         -- "Alice Hargreaves"
  38: Subtract  {"Reputation", Value = 10}
  39: ForPlayer  ("All")
  40: MoveNPC  {NPC = 54, HouseId = 303}         -- "Alice Hargreaves" -> "Quixote Residence"
  41: SetNPCGreeting  {NPC = 17, Greeting = 46}         -- "Sir Charles Quixote" : "Salutations Heroes!  I am certain thou hast much to accomplish before we dally about."
  42: SetNPCTopic  {NPC = 17, Index = 0, Event = 0}         -- "Sir Charles Quixote"
end

event 55  -- "Hello?"
  0:  Cmp  {"QBits", Value = 99,   jump = 4}         -- Chose the path of Light
  1:  Cmp  {"QBits", Value = 100,   jump = 11}         -- Chose the path of Dark
  2:  SetMessage  {Str = 83}         -- "It should be impossible for you to see this right now.  If you are reading this, tell Bryan that the event and/or logic of this quest is messed up because you should either be good attempting the Hero quest, or evil attempting the Villain quest and you are apparently neither."
  3:  Exit  {}

  4:  Cmp  {"QBits", Value = 25,   jump = 9}         -- Mini-dungeon Area 5.  Rescued/Captured Alice Hargreaves.
  5:  SetMessage  {Str = 84}         -- "Help!  William has captured me and imprisoned me in this tower.  Please get me out of here as quickly as possible, I don't want to die."
  6:  Set  {"QBits", Value = 25}         -- Mini-dungeon Area 5.  Rescued/Captured Alice Hargreaves.
  7:  Set  {"NPCs", Value = 54}         -- "Alice Hargreaves"
  8:  Exit  {}

  9:  SetMessage  {Str = 85}         -- "Thank you so much for helping me away from William's clutches."
  10: Exit  {}

  11: Cmp  {"QBits", Value = 25,   jump = 16}         -- Mini-dungeon Area 5.  Rescued/Captured Alice Hargreaves.
  12: SetMessage  {Str = 86}         -- "Excuse me, but who might you be?  Hey!  Get your hands off of me!  Help!"
  13: Set  {"QBits", Value = 25}         -- Mini-dungeon Area 5.  Rescued/Captured Alice Hargreaves.
  14: Set  {"NPCs", Value = 54}         -- "Alice Hargreaves"
  15: Exit  {}

  16: SetMessage  {Str = 87}         -- "Where do you think you're taking me?  I have a rich family-- you'll be in a lot of trouble if you don't let me go!"
  17: Exit  {}
end

event 56  -- "Villain"
  0:  Cmp  {"QBits", Value = 99,   jump = 4}         -- Chose the path of Light
  1:  Cmp  {"QBits", Value = 100,   jump = 6}         -- Chose the path of Dark
  2:  SetMessage  {Str = 90}         -- "Before you make this decision, you have a more pressing, immediate decision you will be forced to make.  If you choose the darker road, you may return to me and complete your training in the Paladins' arts."
  3:  Exit  {}

  4:  SetMessage  {Str = 89}         -- "I'd certainly love nothing more than to corrupt your obviously pious soul, but I'm afraid you wouldn't have the stomach to follow through with my teachings.  You have chosen the Path of Light, you will garner no assistance from me."
  5:  Exit  {}

  6:  SetMessage  {Str = 88}         -- "Let's get down to business, shall we?  I know you are well aware of my standing as the blackest Villain in Erathia.  It requires effort and drive to prove to be this evil-- I hope you have the mettle for it.  I would love nothing more than to keep you in my training for years and teach you the finest parts of being a Villain.  Unfortunately, I am under pressure to speed up your tutelage.  To this end, I have a direct way to learn the arts of Villainhood.  There is a woman, Alice Hargreaves, who is of noble blood and pure character.  Capture this woman from her residence in Castle Gryphonheart. Return here and imprison her in my tower.  Complete this, and I shall promote all Crusaders in your group to Villains, and the rest of your group to Honorary Villains."
  7:  Cmp  {"Awards", Value = 40,   jump = 11}         -- "Promoted to Crusader"
  8:  Cmp  {"Awards", Value = 41,   jump = 11}         -- "Promoted to Honorary Crusader"
  9:  SetMessage  {Str = 99}         -- "I cannot improve upon training you do not already have.  You must be promoted to Crusader before I can train you in the ways of villainy."
  10: Exit  {}

  11: Set  {"QBits", Value = 26}         -- "Capture Alice Hargreaves from her residence in Castle Gryphonheart and return her to William's Tower in the Deyja Moors."
  12: SetNPCTopic  {NPC = 18, Index = 0, Event = 57}         -- "William Setag" : "Villain"
  13: MoveNPC  {NPC = 54, HouseId = 522}         -- "Alice Hargreaves" -> "Alice Hargreaves"
end

event 57  -- "Villain"
  0:  Cmp  {"NPCs", Value = 54,   jump = 3}         -- "Alice Hargreaves"
  1:  SetMessage  {Str = 92}         -- "Where's Alice?  I'm not asking for much, just a simple kidnapping.  Is it really that difficult?  I suggest you speed up your efforts."
  2:  Exit  {}

  3:  SetMessage  {Str = 91}         -- "Capital!  You have shown dedication, daring, and the power of raw force.  Certainly the imprisonment of such a fair and noble creature in this wicked place earns you the right to be called a Villain-- or Honorary Villain.  Go now upon the world and make all fear your name."
  4:  ForPlayer  (0)
  5:  Cmp  {"ClassIs", Value = const.Class.Crusader,   jump = 9}
  6:  Add  {"Awards", Value = 45}         -- "Promoted to Honorary Villain"
  7:  Add  {"Experience", Value = 40000}
  8:  GoTo  {jump = 12}

  9:  Set  {"ClassIs", Value = const.Class.Villain}
  10: Add  {"Awards", Value = 44}         -- "Promoted to Villain"
  11: Add  {"Experience", Value = 80000}
  12: ForPlayer  (1)
  13: Cmp  {"ClassIs", Value = const.Class.Crusader,   jump = 17}
  14: Add  {"Awards", Value = 45}         -- "Promoted to Honorary Villain"
  15: Add  {"Experience", Value = 40000}
  16: GoTo  {jump = 20}

  17: Set  {"ClassIs", Value = const.Class.Villain}
  18: Add  {"Awards", Value = 44}         -- "Promoted to Villain"
  19: Add  {"Experience", Value = 80000}
  20: ForPlayer  (2)
  21: Cmp  {"ClassIs", Value = const.Class.Crusader,   jump = 25}
  22: Add  {"Awards", Value = 45}         -- "Promoted to Honorary Villain"
  23: Add  {"Experience", Value = 40000}
  24: GoTo  {jump = 28}

  25: Set  {"ClassIs", Value = const.Class.Villain}
  26: Add  {"Awards", Value = 44}         -- "Promoted to Villain"
  27: Add  {"Experience", Value = 80000}
  28: ForPlayer  (3)
  29: Cmp  {"ClassIs", Value = const.Class.Crusader,   jump = 33}
  30: Add  {"Awards", Value = 45}         -- "Promoted to Honorary Villain"
  31: Add  {"Experience", Value = 40000}
  32: GoTo  {jump = 36}

  33: Set  {"ClassIs", Value = const.Class.Villain}
  34: Add  {"Awards", Value = 44}         -- "Promoted to Villain"
  35: Add  {"Experience", Value = 80000}
  36: Add  {"Gold", Value = 10000}
  37: Subtract  {"QBits", Value = 26}         -- "Capture Alice Hargreaves from her residence in Castle Gryphonheart and return her to William's Tower in the Deyja Moors."
  38: Add  {"Reputation", Value = 10}
  39: ForPlayer  ("All")
  40: SetNPCTopic  {NPC = 18, Index = 0, Event = 0}         -- "William Setag"
  41: SetNPCGreeting  {NPC = 18, Greeting = 50}         -- "William Setag" : "Villains!  Welcome!  Too rarely do my villainous friends pay me visits."
  42: Subtract  {"NPCs", Value = 54}         -- "Alice Hargreaves"
end

event 58  -- "Initiate"
  0:  SetMessage  {Str = 93}         -- "Ah, it is normal for novice Monks to ask for the path of enlightenment.  I shall tell you of the path, though the journey is yours to make.  In the Barrow Downs is a series of tombs-- one of which was constructed on a site of great natural power.  You will know the right barrow because it is different from the rest.  Reach this barrow and meditate by the water, and your promotion to Initiate will be complete."
  1:  Set  {"QBits", Value = 27}         -- "Find the lost meditation spot in the Dwarven Barrows."
  2:  SetNPCTopic  {NPC = 38, Index = 0, Event = 59}         -- "Bartholomew Hume" : "Initiate"
end

event 59  -- "Initiate"
  0:  SetMessage  {Str = 95}         -- "You have not finished your journey.  Return to me only when you have completed your task."
end

event 60  -- "Initiate"
  0:  SetMessage  {Str = 94}         -- "[Bartholomew Hume contacts you mentally] Congratulations, young ones.  My final lesson given to you as Monks is this:  enlightenment is gained by the journey, not the destination.  In this case, the destination was critical to prove that you were capable of the journey.  I shall now promote all Monks to Initiates and everyone else to Honorary Initiates-- congratulations."
  1:  ForPlayer  (0)
  2:  Cmp  {"ClassIs", Value = const.Class.Monk,   jump = 6}
  3:  Add  {"Awards", Value = 23}         -- "Promoted to Honorary Initiate"
  4:  Add  {"Experience", Value = 15000}
  5:  GoTo  {jump = 9}

  6:  Set  {"ClassIs", Value = const.Class.Initiate}
  7:  Add  {"Awards", Value = 22}         -- "Promoted to Initiate"
  8:  Add  {"Experience", Value = 30000}
  9:  ForPlayer  (1)
  10: Cmp  {"ClassIs", Value = const.Class.Monk,   jump = 14}
  11: Add  {"Awards", Value = 23}         -- "Promoted to Honorary Initiate"
  12: Add  {"Experience", Value = 15000}
  13: GoTo  {jump = 17}

  14: Set  {"ClassIs", Value = const.Class.Initiate}
  15: Add  {"Awards", Value = 22}         -- "Promoted to Initiate"
  16: Add  {"Experience", Value = 30000}
  17: ForPlayer  (2)
  18: Cmp  {"ClassIs", Value = const.Class.Monk,   jump = 22}
  19: Add  {"Awards", Value = 23}         -- "Promoted to Honorary Initiate"
  20: Add  {"Experience", Value = 15000}
  21: GoTo  {jump = 25}

  22: Set  {"ClassIs", Value = const.Class.Initiate}
  23: Add  {"Awards", Value = 22}         -- "Promoted to Initiate"
  24: Add  {"Experience", Value = 30000}
  25: ForPlayer  (3)
  26: Cmp  {"ClassIs", Value = const.Class.Monk,   jump = 30}
  27: Add  {"Awards", Value = 23}         -- "Promoted to Honorary Initiate"
  28: Add  {"Experience", Value = 15000}
  29: GoTo  {jump = 33}

  30: Set  {"ClassIs", Value = const.Class.Initiate}
  31: Add  {"Awards", Value = 22}         -- "Promoted to Initiate"
  32: Add  {"Experience", Value = 30000}
  33: Subtract  {"QBits", Value = 27}         -- "Find the lost meditation spot in the Dwarven Barrows."
  34: ForPlayer  ("All")
  35: SetNPCTopic  {NPC = 38, Index = 0, Event = 61}         -- "Bartholomew Hume" : "Master"
  36: SetNPCTopic  {NPC = 55, Index = 0, Event = 0}         -- "Bartholomew Hume"
end

event 61  -- "Master"
  0:  Cmp  {"QBits", Value = 100,   jump = 4}         -- Chose the path of Dark
  1:  Cmp  {"QBits", Value = 99,   jump = 6}         -- Chose the path of Light
  2:  SetMessage  {Str = 98}         -- "A fork approaches in your path.  I will only train you after you've chosen to walk the lighter path."
  3:  Exit  {}

  4:  SetMessage  {Str = 97}         -- "I am sorry, but I am permitted to train you no longer.  You will need to find a new Master to learn from."
  5:  Exit  {}

  6:  SetMessage  {Str = 96}         -- "I see you wish to continue your journey.  Excellent!  Have no fear, for you are prepared for your next step.  You must extinguish the remnants of an evil order- the Order of Baa.  Defeat their High Priest and return to me and I shall complete your training and promote you to Master."
  7:  Set  {"QBits", Value = 28}         -- "Go to the Temple of Baa in Avlee and kill the High Priest of Baa, then return to Bartholomew Hume in Harmondale."
  8:  SetNPCTopic  {NPC = 38, Index = 0, Event = 62}         -- "Bartholomew Hume" : "Master"
end

event 62  -- "Master"
  0:  ForPlayer  ("All")
  1:  Cmp  {"QBits", Value = 243,   jump = 4}         -- Killed High Preist of Baa
  2:  SetMessage  {Str = 135}         -- "The Temple of Baa still stands, their High Priest still lives.  Until this is completed, you are not ready for the title of Master.  Go now and do not fail."
  3:  Exit  {}

  4:  SetMessage  {Str = 134}         -- "Good work.  No longer shall the Order of Baa stain the lands of Erathia.  Now, allow me to promote all Initiates to Masters, and all Honorary Initiates to Honorary Masters.  Keep in mind that this is but a stop along the path of enlightenment.  Your journey only ends with your eventual death-- never close your mind."
  5:  ForPlayer  (0)
  6:  Cmp  {"ClassIs", Value = const.Class.Initiate,   jump = 10}
  7:  Add  {"Awards", Value = 25}         -- "Promoted to Honorary Master"
  8:  Add  {"Experience", Value = 40000}
  9:  GoTo  {jump = 13}

  10: Set  {"ClassIs", Value = const.Class.Master}
  11: Add  {"Awards", Value = 24}         -- "Promoted to Master"
  12: Add  {"Experience", Value = 80000}
  13: ForPlayer  (1)
  14: Cmp  {"ClassIs", Value = const.Class.Initiate,   jump = 18}
  15: Add  {"Awards", Value = 25}         -- "Promoted to Honorary Master"
  16: Add  {"Experience", Value = 40000}
  17: GoTo  {jump = 21}

  18: Set  {"ClassIs", Value = const.Class.Master}
  19: Add  {"Awards", Value = 24}         -- "Promoted to Master"
  20: Add  {"Experience", Value = 80000}
  21: ForPlayer  (2)
  22: Cmp  {"ClassIs", Value = const.Class.Initiate,   jump = 26}
  23: Add  {"Awards", Value = 25}         -- "Promoted to Honorary Master"
  24: Add  {"Experience", Value = 40000}
  25: GoTo  {jump = 29}

  26: Set  {"ClassIs", Value = const.Class.Master}
  27: Add  {"Awards", Value = 24}         -- "Promoted to Master"
  28: Add  {"Experience", Value = 80000}
  29: ForPlayer  (3)
  30: Cmp  {"ClassIs", Value = const.Class.Initiate,   jump = 34}
  31: Add  {"Awards", Value = 25}         -- "Promoted to Honorary Master"
  32: Add  {"Experience", Value = 40000}
  33: GoTo  {jump = 37}

  34: Set  {"ClassIs", Value = const.Class.Master}
  35: Add  {"Awards", Value = 24}         -- "Promoted to Master"
  36: Add  {"Experience", Value = 80000}
  37: Add  {"Gold", Value = 7500}
  38: Subtract  {"QBits", Value = 28}         -- "Go to the Temple of Baa in Avlee and kill the High Priest of Baa, then return to Bartholomew Hume in Harmondale."
  39: Subtract  {"Reputation", Value = 10}
  40: ForPlayer  ("All")
  41: SetNPCTopic  {NPC = 38, Index = 0, Event = 0}         -- "Bartholomew Hume"
  42: SetNPCGreeting  {NPC = 38, Greeting = 52}         -- "Bartholomew Hume" : "Greetings again, Masters.  How can Bartholomew aid you?"
end

event 63  -- "Ninja"
  0:  Cmp  {"Awards", Value = 22,   jump = 4}         -- "Promoted to Initiate"
  1:  Cmp  {"Awards", Value = 23,   jump = 4}         -- "Promoted to Honorary Initiate"
  2:  SetMessage  {Str = 137}         -- "Ambition is good, but I only train experienced students.  Come back when you've achieved Initiate status, and perhaps I'll teach you…IF you have the right outlook.  If you're looking for someone who is willing to help you become an Initiate, perhaps you should start with that wimp Bartholomew Hume.  I'm sure he'd be willing to give you an elementary education."
  3:  Exit  {}

  4:  Cmp  {"QBits", Value = 99,   jump = 8}         -- Chose the path of Light
  5:  Cmp  {"QBits", Value = 100,   jump = 10}         -- Chose the path of Dark
  6:  SetMessage  {Str = 139}         -- "Though you have achieved initiate status, I am uncertain that you can stomach some of my more extreme teachings.  Return to me when you have formally rejected all philosophies that turn people into weaklings and cowards."
  7:  Exit  {}

  8:  SetMessage  {Str = 138}         -- "[Stephan Sand sneers] YOU want ME to teach you something?  You sniveling do-gooders make my knife arm twitch!  Get out of my sight before I REALLY teach you about fighting!"
  9:  Exit  {}

  10: SetMessage  {Str = 136}         -- "An agent of mine has sent me a message I need deciphered.  The cipher relies on knowing which word of which a certain book to match it against.  If you wish to become a Ninja, this is what you must do: Infiltrate the School of Wizardry and find out what the third word of the famed Scroll of Waves is.  Use it to decipher the message, then do what the message tells you to do.  It is the key to enter the Tomb of the Master.  You'll find the tomb in Southern Erathia.  [Stephan hands you a scrap of paper] Here is the encoded message."
  11: Set  {"QBits", Value = 29}         -- "Crack the code in the School of Sorcery in the Bracada Desert to reveal the location of the Tomb of Ashwar Nog'Nogoth.  Discover the tomb's location, enter it, and then return it to Stephan Sand in the Pit."
  12: SetNPCTopic  {NPC = 39, Index = 0, Event = 64}         -- "Stephan Sand" : "Ninja"
  13: Add  {"Inventory", Value = 701}         -- "Cipher"
  14: Add  {"QBits", Value = 215}         -- Cipher - I lost it
end

event 64  -- "Ninja"
  0:  ForPlayer  ("All")
  1:  Cmp  {"QBits", Value = 242,   jump = 7}         -- Opened chest with shadow mask
  2:  Cmp  {"QBits", Value = 57,   jump = 5}         -- Solved the code puzzle.  Ninja promo quest
  3:  SetMessage  {Str = 141}         -- "[Sand sighs] Once again, the cipher key is the third word of the first paragraph of the Scroll of Waves.  You can find it somewhere in the School of Wizardry.  I don't care how you get in there--kill anyone who gets in your way, or sneak in.  Whatever you want.  The only thing that matters is success.  Everything else is an excuse for personal weakness."
  4:  Exit  {}

  5:  SetMessage  {Str = 140}         -- "So you have the key, but you haven't followed the directions in the message.  Remember, the tomb is in Southern Erathia.  Complete your task, and return to me to report success.  If you can't complete your mission, don't bother returning to me.  Failure is pathetic."
  6:  Exit  {}

  7:  SetMessage  {Str = 142}         -- "Well done.  No one can argue with success except apologists for the weak and the cowardly.  I hereby promote all Initiates to Ninjas, and all non-Initiates to Honorary Ninjas.  Oh yeah, go ahead and keep that little trinket you stole from the tomb.  This was just a training exercise, after all."
  8:  ForPlayer  (0)
  9:  Cmp  {"ClassIs", Value = const.Class.Initiate,   jump = 13}
  10: Add  {"Awards", Value = 27}         -- "Promoted to Honorary Ninja"
  11: Add  {"Experience", Value = 40000}
  12: GoTo  {jump = 16}

  13: Set  {"ClassIs", Value = const.Class.Ninja}
  14: Add  {"Awards", Value = 26}         -- "Promoted to Ninja"
  15: Add  {"Experience", Value = 80000}
  16: ForPlayer  (1)
  17: Cmp  {"ClassIs", Value = const.Class.Initiate,   jump = 21}
  18: Add  {"Awards", Value = 27}         -- "Promoted to Honorary Ninja"
  19: Add  {"Experience", Value = 40000}
  20: GoTo  {jump = 24}

  21: Set  {"ClassIs", Value = const.Class.Ninja}
  22: Add  {"Awards", Value = 26}         -- "Promoted to Ninja"
  23: Add  {"Experience", Value = 80000}
  24: ForPlayer  (2)
  25: Cmp  {"ClassIs", Value = const.Class.Initiate,   jump = 29}
  26: Add  {"Awards", Value = 27}         -- "Promoted to Honorary Ninja"
  27: Add  {"Experience", Value = 40000}
  28: GoTo  {jump = 32}

  29: Set  {"ClassIs", Value = const.Class.Ninja}
  30: Add  {"Awards", Value = 26}         -- "Promoted to Ninja"
  31: Add  {"Experience", Value = 80000}
  32: ForPlayer  (3)
  33: Cmp  {"ClassIs", Value = const.Class.Initiate,   jump = 37}
  34: Add  {"Awards", Value = 27}         -- "Promoted to Honorary Ninja"
  35: Add  {"Experience", Value = 40000}
  36: GoTo  {jump = 40}

  37: Set  {"ClassIs", Value = const.Class.Ninja}
  38: Add  {"Awards", Value = 26}         -- "Promoted to Ninja"
  39: Add  {"Experience", Value = 80000}
  40: Subtract  {"QBits", Value = 29}         -- "Crack the code in the School of Sorcery in the Bracada Desert to reveal the location of the Tomb of Ashwar Nog'Nogoth.  Discover the tomb's location, enter it, and then return it to Stephan Sand in the Pit."
  41: Subtract  {"Reputation", Value = 10}
  42: ForPlayer  ("All")
  43: SetNPCTopic  {NPC = 39, Index = 0, Event = 0}         -- "Stephan Sand"
  44: SetNPCGreeting  {NPC = 39, Greeting = 55}         -- "Stephan Sand" : "Now that you've achieved the exaulted status of Ninja, I have nothing further to give you.  I hope my teachings take you far."
end

event 65  -- "Master Archer"
  0:  Cmp  {"Awards", Value = 34,   jump = 4}         -- "Promoted to Warrior Mage"
  1:  Cmp  {"Awards", Value = 35,   jump = 4}         -- "Promoted to Honorary Warrior Mage"
  2:  SetMessage  {Str = 146}         -- "I am the person to see if you want to become Master Archers, but you have come too soon!  You must have the proper background to become a Master, and that means first becoming a warrior mage.  Return when you are ready."
  3:  Exit  {}

  4:  Cmp  {"QBits", Value = 99,   jump = 10}         -- Chose the path of Light
  5:  Cmp  {"QBits", Value = 100,   jump = 8}         -- Chose the path of Dark
  6:  SetMessage  {Str = 144}         -- "So, you've achieved the rank of Warrior Mage, and wish to advance to Master Archer!  A worthy goal, but I only promote those who's heart and courage match their skill.  Come back to me when you have firmly committed to the Light.  Then I will help you."
  7:  Exit  {}

  8:  SetMessage  {Str = 145}         -- "You have chosen the path of Darkness.  I will never help you improve, for fear you will use your skills to advance your selfish goals!"
  9:  Exit  {}

  10: SetMessage  {Str = 143}         -- "A few generations ago, an enchanted bow was created by alchemists in the Tularean Forest to seal another peace treaty between the elves and the humans.  While en route to Erathia, the bow was taken from the couriers by the Titans in Avlee.  They have no use for the thing, so it's probably in their stronghold still.  Strike a blow for our profession, and get that bow back.  It is absolutely the finest thing of its kind ever made.  Oh, and while you're there, feel free to cut some of those bullies down to size--They stole it out of cruelty, not need!  If you are successful, I will promote all Warrior Mages to Master Archers, or honorary Master Archers, as the case may be."
  11: Add  {"QBits", Value = 30}         -- "Retrieve the Perfect Bow from the Titans' Stronghold in Avlee and return it to Lawrence Mark in Harmondale."
  12: SetNPCTopic  {NPC = 40, Index = 0, Event = 66}         -- "Lawrence Mark" : "Master Archer"
end

event 66  -- "Master Archer"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 542,   jump = 4}         -- "The Perfect Bow"
  2:  SetMessage  {Str = 148}         -- "No luck getting the bow?  Well, take your time, and plan your assault against the Titans carefully.  Against such powerful opponents, there is no shame in striking and retreating.  Do what you must to defeat these monsters."
  3:  Exit  {}

  4:  SetMessage  {Str = 147}         -- "You found the bow!  Let me take some measurements and adjust it to your specific style of archery. Once I have finished you should keep it, and use it in defense the of the land and the people.  I am happy to promote all Warrior Mages to Master Archers, and all Honorary Warrior Mages to Honorary Master Archers."
  5:  ForPlayer  (0)
  6:  Cmp  {"ClassIs", Value = const.Class.WarriorMage,   jump = 10}
  7:  Add  {"Awards", Value = 37}         -- "Promoted to Honorary Master Archer"
  8:  Add  {"Experience", Value = 40000}
  9:  GoTo  {jump = 13}

  10: Set  {"ClassIs", Value = const.Class.MasterArcher}
  11: Add  {"Awards", Value = 36}         -- "Promoted to Master Archer"
  12: Add  {"Experience", Value = 80000}
  13: ForPlayer  (1)
  14: Cmp  {"ClassIs", Value = const.Class.WarriorMage,   jump = 18}
  15: Add  {"Awards", Value = 37}         -- "Promoted to Honorary Master Archer"
  16: Add  {"Experience", Value = 40000}
  17: GoTo  {jump = 21}

  18: Set  {"ClassIs", Value = const.Class.MasterArcher}
  19: Add  {"Awards", Value = 36}         -- "Promoted to Master Archer"
  20: Add  {"Experience", Value = 80000}
  21: ForPlayer  (2)
  22: Cmp  {"ClassIs", Value = const.Class.WarriorMage,   jump = 26}
  23: Add  {"Awards", Value = 37}         -- "Promoted to Honorary Master Archer"
  24: Add  {"Experience", Value = 40000}
  25: GoTo  {jump = 29}

  26: Set  {"ClassIs", Value = const.Class.MasterArcher}
  27: Add  {"Awards", Value = 36}         -- "Promoted to Master Archer"
  28: Add  {"Experience", Value = 80000}
  29: ForPlayer  (3)
  30: Cmp  {"ClassIs", Value = const.Class.WarriorMage,   jump = 34}
  31: Add  {"Awards", Value = 37}         -- "Promoted to Honorary Master Archer"
  32: Add  {"Experience", Value = 40000}
  33: GoTo  {jump = 37}

  34: Set  {"ClassIs", Value = const.Class.MasterArcher}
  35: Add  {"Awards", Value = 36}         -- "Promoted to Master Archer"
  36: Add  {"Experience", Value = 80000}
  37: Subtract  {"QBits", Value = 30}         -- "Retrieve the Perfect Bow from the Titans' Stronghold in Avlee and return it to Lawrence Mark in Harmondale."
  38: Add  {"Inventory", Value = 543}         -- "The Perfect Bow"
  39: Subtract  {"Reputation", Value = 10}
  40: ForPlayer  ("All")
  41: Cmp  {"Inventory", Value = 542,   jump = 43}         -- "The Perfect Bow"
  42: GoTo  {jump = 44}

  43: Subtract  {"Inventory", Value = 542}         -- "The Perfect Bow"
  44: SetNPCTopic  {NPC = 40, Index = 0, Event = 0}         -- "Lawrence Mark"
  45: SetNPCGreeting  {NPC = 40, Greeting = 57}         -- "Lawrence Mark" : "Welcome my friends!  That's a fine weapon you have there, but don't think for a moment you'll best me in this year's Tourney--I'm still the Master!"
end

event 67  -- "Warrior Mage"
  0:  SetMessage  {Str = 149}         -- "[Wheeze] So you think you can become Warrior Mages, do you?  It isn't easy.  You must be equally proficient in magical skills and physical skills.  There is a test of this.  Visit the Red Dwarf Mines.  Inside you will find two kinds of beasts--one that can be harmed only with magic, and one that can be harmed only with steel.  In the back of the lower section of the mines you will find a machine created by the Dwarves that powers the lift-- the only access between the upper and lower sections of the mines.  To keep the creatures trapped in the lower section, you will have to replace the belt in the machine with this one, a worn belt that will only last about an hour before breaking.  This should give you enough time to get to the lift and get out before you are trapped down there.  Seal away these creatures and return to me-- only then will I call you Warrior Mages."
  1:  Add  {"Inventory", Value = 649}         -- "Worn Belt"
  2:  Add  {"QBits", Value = 31}         -- "Sabotage the lift in the Red Dwarf Mines in the Bracada Desert then return to Steagal Snick in Avlee."
  3:  Add  {"QBits", Value = 216}         -- Worn Belt - I lost it
  4:  SetNPCTopic  {NPC = 41, Index = 0, Event = 68}         -- "Steagal Snick" : "Warrior Mage"
end

event 68  -- "Warrior Mage"
  0:  Cmp  {"QBits", Value = 58,   jump = 3}         -- Destroyed critter generator in dungeon.  Warrior Mage promo quest.
  1:  SetMessage  {Str = 151}         -- "You haven't sabotaged the machine yet.  You must finish this before I'll promote you to Warrior Mage."
  2:  Exit  {}

  3:  SetMessage  {Str = 150}         -- "Very Good.  You have passed the test.  Now the creatures are sealed away and won't be able to prey on the dwarves any longer, and you have proven your ability in both sorcery and steel.  I am proud to declare all Archers amongst you Warrior Mages, and everyone else Honorary Warrior Mages.  Congratulations!  Now get out.  I already weary of your company."
  4:  ForPlayer  (0)
  5:  Cmp  {"ClassIs", Value = const.Class.Archer,   jump = 9}
  6:  Add  {"Awards", Value = 35}         -- "Promoted to Honorary Warrior Mage"
  7:  Add  {"Experience", Value = 15000}
  8:  GoTo  {jump = 12}

  9:  Set  {"ClassIs", Value = const.Class.WarriorMage}
  10: Add  {"Awards", Value = 34}         -- "Promoted to Warrior Mage"
  11: Add  {"Experience", Value = 30000}
  12: ForPlayer  (1)
  13: Cmp  {"ClassIs", Value = const.Class.Archer,   jump = 17}
  14: Add  {"Awards", Value = 35}         -- "Promoted to Honorary Warrior Mage"
  15: Add  {"Experience", Value = 15000}
  16: GoTo  {jump = 20}

  17: Set  {"ClassIs", Value = const.Class.WarriorMage}
  18: Add  {"Awards", Value = 34}         -- "Promoted to Warrior Mage"
  19: Add  {"Experience", Value = 30000}
  20: ForPlayer  (2)
  21: Cmp  {"ClassIs", Value = const.Class.Archer,   jump = 25}
  22: Add  {"Awards", Value = 35}         -- "Promoted to Honorary Warrior Mage"
  23: Add  {"Experience", Value = 15000}
  24: GoTo  {jump = 28}

  25: Set  {"ClassIs", Value = const.Class.WarriorMage}
  26: Add  {"Awards", Value = 34}         -- "Promoted to Warrior Mage"
  27: Add  {"Experience", Value = 30000}
  28: ForPlayer  (3)
  29: Cmp  {"ClassIs", Value = const.Class.Archer,   jump = 33}
  30: Add  {"Awards", Value = 35}         -- "Promoted to Honorary Warrior Mage"
  31: Add  {"Experience", Value = 15000}
  32: GoTo  {jump = 36}

  33: Set  {"ClassIs", Value = const.Class.WarriorMage}
  34: Add  {"Awards", Value = 34}         -- "Promoted to Warrior Mage"
  35: Add  {"Experience", Value = 30000}
  36: Subtract  {"QBits", Value = 31}         -- "Sabotage the lift in the Red Dwarf Mines in the Bracada Desert then return to Steagal Snick in Avlee."
  37: Add  {"Gold", Value = 7500}
  38: Subtract  {"Reputation", Value = 5}
  39: ForPlayer  ("All")
  40: SetNPCTopic  {NPC = 41, Index = 0, Event = 69}         -- "Steagal Snick" : "Sniper"
end

event 69  -- "Sniper"
  0:  Cmp  {"QBits", Value = 100,   jump = 6}         -- Chose the path of Dark
  1:  Cmp  {"QBits", Value = 99,   jump = 4}         -- Chose the path of Light
  2:  SetMessage  {Str = 153}         -- "Want to be a Sniper, eh? Maybe.  But I doubt you have the heart for it.  It needs to shrivel like a raisin and get hard as a stone to be able to do what you must.  Prove to me you are following the Path of Darkness, and then I will teach you further."
  3:  Exit  {}

  4:  SetMessage  {Str = 154}         -- "Following the Path of Light, are we?  How can you be a Sniper if you cry everytime you shoot someone in the back?  Maybe you should ask that lily-livered Lawrence Mark to help you.  I know that I will not."
  5:  Exit  {}

  6:  SetMessage  {Str = 152}         -- "Getting ambitious, are we?  Think you can earn the title of sniper?  Perhaps you can.  Here is what you must do:  In the stronghold of the Titans is a very special bow that was meant as a peace offering from the elves to the humans to quell a conflict long since forgotten.  [Master Snick shakes his head] Gads! This peace stuff makes me nauseous!  In any case, fetch the bow for the good of our profession, and I'll promote you to Sniper.  [Heh] you better act like snipers if you expect to defeat the Titans.  A toe to toe...or should I say head to knee fight won't go well for you."
  7:  Set  {"QBits", Value = 32}         -- "Retrieve the Perfect Bow from the Titans' Stronghold in Avlee and return it to Steagal Snick in Avlee."
  8:  SetNPCTopic  {NPC = 41, Index = 0, Event = 70}         -- "Steagal Snick" : "Sniper"
end

event 70  -- "Sniper"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 542,   jump = 4}         -- "The Perfect Bow"
  2:  SetMessage  {Str = 156}         -- "More failure? [Master Snick yawns]  How surprising.  I'll make it simple--no bow, no title."
  3:  Exit  {}

  4:  SetMessage  {Str = 155}         -- "You have the bow?!  Excellent!  It's been centuries since someone was brave enough to take on the Titans and try to get that bow back!  Let me take some measurements and adjust it to your specific style of archery.  I am proud to be the one to first call all Warrior Mages amongst you Snipers, and to say that all Honorary Warrior Mages are Honorary Snipers!  I must admit I didn't think you had it in you to succeed.  I am happy that I was wrong."
  5:  ForPlayer  (0)
  6:  Cmp  {"ClassIs", Value = const.Class.WarriorMage,   jump = 10}
  7:  Add  {"Awards", Value = 39}         -- "Promoted to Honorary Sniper"
  8:  Add  {"Experience", Value = 40000}
  9:  GoTo  {jump = 13}

  10: Set  {"ClassIs", Value = const.Class.Sniper}
  11: Add  {"Awards", Value = 38}         -- "Promoted to Sniper"
  12: Add  {"Experience", Value = 80000}
  13: ForPlayer  (1)
  14: Cmp  {"ClassIs", Value = const.Class.WarriorMage,   jump = 18}
  15: Add  {"Awards", Value = 39}         -- "Promoted to Honorary Sniper"
  16: Add  {"Experience", Value = 40000}
  17: GoTo  {jump = 21}

  18: Set  {"ClassIs", Value = const.Class.Sniper}
  19: Add  {"Awards", Value = 38}         -- "Promoted to Sniper"
  20: Add  {"Experience", Value = 80000}
  21: ForPlayer  (2)
  22: Cmp  {"ClassIs", Value = const.Class.WarriorMage,   jump = 26}
  23: Add  {"Awards", Value = 39}         -- "Promoted to Honorary Sniper"
  24: Add  {"Experience", Value = 40000}
  25: GoTo  {jump = 29}

  26: Set  {"ClassIs", Value = const.Class.Sniper}
  27: Add  {"Awards", Value = 38}         -- "Promoted to Sniper"
  28: Add  {"Experience", Value = 80000}
  29: ForPlayer  (3)
  30: Cmp  {"ClassIs", Value = const.Class.WarriorMage,   jump = 34}
  31: Add  {"Awards", Value = 39}         -- "Promoted to Honorary Sniper"
  32: Add  {"Experience", Value = 40000}
  33: GoTo  {jump = 37}

  34: Set  {"ClassIs", Value = const.Class.Sniper}
  35: Add  {"Awards", Value = 38}         -- "Promoted to Sniper"
  36: Add  {"Experience", Value = 80000}
  37: Subtract  {"QBits", Value = 32}         -- "Retrieve the Perfect Bow from the Titans' Stronghold in Avlee and return it to Steagal Snick in Avlee."
  38: Add  {"Inventory", Value = 543}         -- "The Perfect Bow"
  39: Subtract  {"Reputation", Value = 10}
  40: ForPlayer  ("All")
  41: Cmp  {"Inventory", Value = 542,   jump = 43}         -- "The Perfect Bow"
  42: GoTo  {jump = 44}

  43: Subtract  {"Inventory", Value = 542}         -- "The Perfect Bow"
  44: SetNPCTopic  {NPC = 41, Index = 0, Event = 0}         -- "Steagal Snick"
  45: SetNPCGreeting  {NPC = 41, Greeting = 59}         -- "Steagal Snick" : "Students…[Mr. Snick rasps the word, then smiles] no longer.  I am proud to have helped you on your way.  Use your new weapon…[wheeze] wisely."
end

event 71  -- "Champion"
  0:  Cmp  {"Awards", Value = 16,   jump = 4}         -- "Promoted to Cavalier"
  1:  Cmp  {"Awards", Value = 17,   jump = 4}         -- "Promoted to Honorary Cavalier"
  2:  SetMessage  {Str = 160}         -- "I am the person to talk to if you want to be called Champions.  First, though, you must practice.  Return to me when you've become Cavaliers.  Then, if you have the right outlook, I will tell you what you must do to become Champions."
  3:  Exit  {}

  4:  Cmp  {"QBits", Value = 100,   jump = 8}         -- Chose the path of Dark
  5:  Cmp  {"QBits", Value = 99,   jump = 10}         -- Chose the path of Light
  6:  SetMessage  {Str = 158}         -- "I can see you very much want to be called Champions, but I'm not so sure I should help you.  Prove to me that you follow the Path of Light, and then we'll talk about promotion."
  7:  Exit  {}

  8:  SetMessage  {Str = 159}         -- "Call you Champions?  Never!  The only reason I'm not hacking you evil doers to bits is that you came here peacefully.  Leave now, before I change my mind and rid the world of another problem."
  9:  Exit  {}

  10: SetMessage  {Str = 157}         -- "So you want to be champions, do you?  Ha!  How can you be a champion if you don't win any tournaments?  You know, I can't really promote you to Champion status--you have to do it yourself, just like everything else.  Go and win five championship tournaments in the Arena at Knight level, and come back to me.  I'll call you Champions then, if you want."
  11: Set  {"QBits", Value = 33}         -- "Win five arena challenges then return to Leda Rowan in the Bracada Desert."
  12: SetNPCTopic  {NPC = 42, Index = 0, Event = 72}         -- "Leda Rowan" : "Champion"
end

event 72  -- "Champion"
  0:  GoTo  {jump = 42}

  1:  SetMessage  {Str = 162}         -- "You have not yet won 5 championship tournaments in the Arena.  Return to me when you have won five, and I will promote you.  Remember, these battles MUST be at the Knight difficulty level."
  2:  Exit  {}

  3:  SetMessage  {Str = 161}         -- "Congratulations for you recent tourney victories, my friends!  I gladly name the Cavaliers among you Champions, and the Honorary Cavaliers I name Honorary Champions!  Always fight for the Light, Champions!"
  4:  ForPlayer  (0)
  5:  Cmp  {"ClassIs", Value = const.Class.Cavalier,   jump = 9}
  6:  Add  {"Awards", Value = 19}         -- "Promoted to Honorary Champion"
  7:  Add  {"Experience", Value = 40000}
  8:  GoTo  {jump = 12}

  9:  Set  {"ClassIs", Value = const.Class.Champion}
  10: Add  {"Awards", Value = 18}         -- "Promoted to Champion"
  11: Add  {"Experience", Value = 80000}
  12: ForPlayer  (1)
  13: Cmp  {"ClassIs", Value = const.Class.Cavalier,   jump = 17}
  14: Add  {"Awards", Value = 19}         -- "Promoted to Honorary Champion"
  15: Add  {"Experience", Value = 40000}
  16: GoTo  {jump = 20}

  17: Set  {"ClassIs", Value = const.Class.Champion}
  18: Add  {"Awards", Value = 18}         -- "Promoted to Champion"
  19: Add  {"Experience", Value = 80000}
  20: ForPlayer  (2)
  21: Cmp  {"ClassIs", Value = const.Class.Cavalier,   jump = 25}
  22: Add  {"Awards", Value = 19}         -- "Promoted to Honorary Champion"
  23: Add  {"Experience", Value = 40000}
  24: GoTo  {jump = 28}

  25: Set  {"ClassIs", Value = const.Class.Champion}
  26: Add  {"Awards", Value = 18}         -- "Promoted to Champion"
  27: Add  {"Experience", Value = 80000}
  28: ForPlayer  (3)
  29: Cmp  {"ClassIs", Value = const.Class.Cavalier,   jump = 33}
  30: Add  {"Awards", Value = 19}         -- "Promoted to Honorary Champion"
  31: Add  {"Experience", Value = 40000}
  32: GoTo  {jump = 36}

  33: Set  {"ClassIs", Value = const.Class.Champion}
  34: Add  {"Awards", Value = 18}         -- "Promoted to Champion"
  35: Add  {"Experience", Value = 80000}
  36: Subtract  {"QBits", Value = 33}         -- "Win five arena challenges then return to Leda Rowan in the Bracada Desert."
  37: Subtract  {"Reputation", Value = 10}
  38: ForPlayer  ("All")
  39: SetNPCTopic  {NPC = 42, Index = 0, Event = 0}         -- "Leda Rowan"
  40: SetNPCGreeting  {NPC = 42, Greeting = 61}         -- "Leda Rowan" : "Hail, champions!  Your courage and skill has all the tongues in the Kingdom wagging!  I am very proud of you!"
  41: Exit  {}

  42: Cmp  {"ArenaWinsKnight", Value = 4,   jump = 47}
  43: Cmp  {"ArenaWinsKnight", Value = 3,   jump = 48}
  44: Cmp  {"ArenaWinsKnight", Value = 2,   jump = 49}
  45: Cmp  {"ArenaWinsKnight", Value = 1,   jump = 50}
  46: GoTo  {jump = 51}

  47: Cmp  {"ArenaWinsLord", Value = 1,   jump = 3}
  48: Cmp  {"ArenaWinsLord", Value = 2,   jump = 3}
  49: Cmp  {"ArenaWinsLord", Value = 3,   jump = 3}
  50: Cmp  {"ArenaWinsLord", Value = 4,   jump = 3}
  51: Cmp  {"ArenaWinsLord", Value = 5,   jump = 3}
  52: Cmp  {"ArenaWinsKnight", Value = 5,   jump = 3}
  53: GoTo  {jump = 1}
end

event 73  -- "Cavalier"
  0:  SetMessage  {Str = 163}         -- "The hallmark of the Cavalier is courage.  I can promote you to Cavalier status, but before I'll do that, you'll have to prove to me your bravery in battle.  Since most people are yellow bellied cowards at heart, I doubt you'll succeed.  But if you want to try, here is what you must do: Destroy all the undead in the haunted mansion in the Barrow Downs."
  1:  Set  {"QBits", Value = 34}         -- "Destroy all the undead in the Haunted House in the Barrow Downs and return to Frederick Org in Erathia."
  2:  SetNPCTopic  {NPC = 43, Index = 0, Event = 74}         -- "Frederick Org" : "Cavalier"
end

event 74  -- "Cavalier"
  0:  ForPlayer  ("All")
  1:  Cmp  {"QBits", Value = 140,   jump = 4}         -- Cleaned out the haunted mansion (Cavalier promo)
  2:  SetMessage  {Str = 165}         -- "Did one little haunted house send you packing in fear?  I've seen chocolate eclairs with more backbone than you!  Get you gone, and don't come back 'til you've stiffened your spine!"
  3:  Exit  {}

  4:  SetMessage  {Str = 164}         -- "So you're back!  And from the look on your faces I see you have finished the job.  Well done!  I hereby officially promote all Knights amongst you to Cavaliers, and everyone else to honorary Cavaliers.  Carry your title with pride!"
  5:  ForPlayer  (0)
  6:  Cmp  {"ClassIs", Value = const.Class.Knight,   jump = 10}
  7:  Add  {"Awards", Value = 17}         -- "Promoted to Honorary Cavalier"
  8:  Add  {"Experience", Value = 15000}
  9:  GoTo  {jump = 13}

  10: Set  {"ClassIs", Value = const.Class.Cavalier}
  11: Add  {"Awards", Value = 16}         -- "Promoted to Cavalier"
  12: Add  {"Experience", Value = 30000}
  13: ForPlayer  (1)
  14: Cmp  {"ClassIs", Value = const.Class.Knight,   jump = 18}
  15: Add  {"Awards", Value = 17}         -- "Promoted to Honorary Cavalier"
  16: Add  {"Experience", Value = 15000}
  17: GoTo  {jump = 21}

  18: Set  {"ClassIs", Value = const.Class.Cavalier}
  19: Add  {"Awards", Value = 16}         -- "Promoted to Cavalier"
  20: Add  {"Experience", Value = 30000}
  21: ForPlayer  (2)
  22: Cmp  {"ClassIs", Value = const.Class.Knight,   jump = 26}
  23: Add  {"Awards", Value = 17}         -- "Promoted to Honorary Cavalier"
  24: Add  {"Experience", Value = 15000}
  25: GoTo  {jump = 29}

  26: Set  {"ClassIs", Value = const.Class.Cavalier}
  27: Add  {"Awards", Value = 16}         -- "Promoted to Cavalier"
  28: Add  {"Experience", Value = 30000}
  29: ForPlayer  (3)
  30: Cmp  {"ClassIs", Value = const.Class.Knight,   jump = 34}
  31: Add  {"Awards", Value = 17}         -- "Promoted to Honorary Cavalier"
  32: Add  {"Experience", Value = 15000}
  33: GoTo  {jump = 37}

  34: Set  {"ClassIs", Value = const.Class.Cavalier}
  35: Add  {"Awards", Value = 16}         -- "Promoted to Cavalier"
  36: Add  {"Experience", Value = 30000}
  37: Subtract  {"QBits", Value = 34}         -- "Destroy all the undead in the Haunted House in the Barrow Downs and return to Frederick Org in Erathia."
  38: Subtract  {"Reputation", Value = 5}
  39: ForPlayer  ("All")
  40: SetNPCTopic  {NPC = 43, Index = 0, Event = 75}         -- "Frederick Org" : "Black Knight"
end

event 75  -- "Black Knight"
  0:  Cmp  {"QBits", Value = 100,   jump = 6}         -- Chose the path of Dark
  1:  Cmp  {"QBits", Value = 99,   jump = 4}         -- Chose the path of Light
  2:  SetMessage  {Str = 167}         -- "It's true that I am the one you go to when you're looking to be promoted to Black Knight status.  But how can you become a Black Knight when you haven't even decided whether or not you're evil?  Return to me when you have fully committed to Darkness.  Only then will I resume your training."
  3:  Exit  {}

  4:  SetMessage  {Str = 168}         -- "Bah!  You do-gooders are worthless!  It is impossible for me to teach anything more to you!  "
  5:  Exit  {}

  6:  SetMessage  {Str = 166}         -- "So you think you can become Black Knights, do you?  Very well.  You know, I've heard many people say that criminals are cowards.  That just isn't true.  It takes a lot of courage to risk your life in a robbery, or in battle.  You've already proven you are courageous, and now it's time to put that courage and your skills to use.  I want you to rob the Elvish Treasury.  It's one of the biggest hoards of treasure in the land, and it is very well guarded.  Do the deed and abscond with the wealth.  Return to me when you've finished.  Then I will promote you to Black Knights."
  7:  Set  {"QBits", Value = 35}         -- "Raid the Elven Treasury at Castle Navan in the Tularean Forest and return to Frederick Org in Erathia."
  8:  SetNPCTopic  {NPC = 43, Index = 0, Event = 76}         -- "Frederick Org" : "Black Knight"
end

event 76  -- "Black Knight"
  0:  Cmp  {"QBits", Value = 60,   jump = 3}         -- Robbed Elven treasury.  Black Knight promo quest.
  1:  SetMessage  {Str = 170}         -- "Robbery not complete?  No.  Don't come to me and report failure.  Don't come and tell me you lost your nerve.  Get out there and rob that treasury!  Failure is not an option!"
  2:  Exit  {}

  3:  SetMessage  {Str = 169}         -- "All RIGHT!  That robbery was brilliant!  I am very proud of you.  Keep the loot--it's your reward for a job well done.  I can safely say the Cavaliers among you have become Black Knights today, and I'll throw in an Honorary Black Knight title for the rest of you.  You've done well, my students!"
  4:  ForPlayer  (0)
  5:  Cmp  {"ClassIs", Value = const.Class.Cavalier,   jump = 9}
  6:  Add  {"Awards", Value = 21}         -- "Promoted to Honorary Black Knight"
  7:  Add  {"Experience", Value = 40000}
  8:  GoTo  {jump = 12}

  9:  Set  {"ClassIs", Value = const.Class.BlackKnight}
  10: Add  {"Awards", Value = 20}         -- "Promoted to Black Knight"
  11: Add  {"Experience", Value = 80000}
  12: ForPlayer  (1)
  13: Cmp  {"ClassIs", Value = const.Class.Cavalier,   jump = 17}
  14: Add  {"Awards", Value = 21}         -- "Promoted to Honorary Black Knight"
  15: Add  {"Experience", Value = 40000}
  16: GoTo  {jump = 20}

  17: Set  {"ClassIs", Value = const.Class.BlackKnight}
  18: Add  {"Awards", Value = 20}         -- "Promoted to Black Knight"
  19: Add  {"Experience", Value = 80000}
  20: ForPlayer  (2)
  21: Cmp  {"ClassIs", Value = const.Class.Cavalier,   jump = 25}
  22: Add  {"Awards", Value = 21}         -- "Promoted to Honorary Black Knight"
  23: Add  {"Experience", Value = 40000}
  24: GoTo  {jump = 28}

  25: Set  {"ClassIs", Value = const.Class.BlackKnight}
  26: Add  {"Awards", Value = 20}         -- "Promoted to Black Knight"
  27: Add  {"Experience", Value = 80000}
  28: ForPlayer  (3)
  29: Cmp  {"ClassIs", Value = const.Class.Cavalier,   jump = 33}
  30: Add  {"Awards", Value = 21}         -- "Promoted to Honorary Black Knight"
  31: Add  {"Experience", Value = 40000}
  32: GoTo  {jump = 36}

  33: Set  {"ClassIs", Value = const.Class.BlackKnight}
  34: Add  {"Awards", Value = 20}         -- "Promoted to Black Knight"
  35: Add  {"Experience", Value = 80000}
  36: Subtract  {"QBits", Value = 35}         -- "Raid the Elven Treasury at Castle Navan in the Tularean Forest and return to Frederick Org in Erathia."
  37: Add  {"Reputation", Value = 10}
  38: ForPlayer  ("All")
  39: SetNPCTopic  {NPC = 43, Index = 0, Event = 0}         -- "Frederick Org"
  40: SetNPCGreeting  {NPC = 43, Greeting = 63}         -- "Frederick Org" : "[Frederick rises hastily to his feet] None shall pass! [he blinks and rubs his eyes] Oh.  It's you.  Sorry, I thought you were someone else.  How goes the villainy?"
end

event 77  -- "Ranger Lord"
  0:  Cmp  {"Awards", Value = 28,   jump = 4}         -- "Promoted to Hunter"
  1:  Cmp  {"Awards", Value = 29,   jump = 4}         -- "Promoted to Honorary Hunter"
  2:  SetMessage  {Str = 173}         -- "[Lysander shakes his head, smiling gently] Too soon, eager ones.  I train only the most advanced students.  Seek me out again when you reach Hunter status."
  3:  Exit  {}

  4:  Cmp  {"QBits", Value = 99,   jump = 10}         -- Chose the path of Light
  5:  Cmp  {"QBits", Value = 100,   jump = 8}         -- Chose the path of Dark
  6:  SetMessage  {Str = 172}         -- "I would like to be your teacher--I really would, but I'm not sure you're cut out to be a Ranger Lord.  Soon you must make a decision of the heart.  If you choose the Path of Light, return to me.  I would be honored to be your teacher."
  7:  Exit  {}

  8:  SetMessage  {Str = 174}         -- "[Lysander frowns] You've chosen the path of darkness.  I refuse to teach such as you--you would only use my lessons to further your selfish goals.  May Heaven have mercy on your souls."
  9:  Exit  {}

  10: SetMessage  {Str = 171}         -- "Well, it looks like you might be able to do the job I have in mind.  The fundamental task a Ranger Lord faces is caring for the land.  Recently, poachers removed a magical gemstone called the ""heart of the forest"" from the Tularean Forest.  The forest has become restless, and attacks travelers who come too close.  The forest blames all 'Walkers' for the theft, and won't calm down until the stone is returned.  Find the stone and return it to the oldest tree in the Forest.  Come back to me when you've done this."
  11: Set  {"QBits", Value = 36}         -- "Calm the trees in the Tularean Forest by speaking to the Oldest Tree then return to Lysander Sweet in the Bracada Desert."
  12: SetNPCTopic  {NPC = 44, Index = 0, Event = 78}         -- "Lysander Sweet" : "Ranger Lord"
end

event 78  -- "Ranger Lord"
  0:  Cmp  {"QBits", Value = 41,   jump = 6}         -- Solved Tree quest
  1:  Cmp  {"QBits", Value = 40,   jump = 4}         -- Talked to the Oldest Tree
  2:  SetMessage  {Str = 175}         -- "If you can't figure out where to start, you should try finding the oldest tree in the forest.  It should be somewhere outside of Pierpont in Avlee.  The oldest tree has the power of speech, and may know something helpful.  It will be happy to tell you whatever you want to hear, plus a whole lot more.  You'll see."
  3:  Exit  {}

  4:  SetMessage  {Str = 176}         -- "Well, you've spoken with the tree, and now know as much as I do about the theft.  If you manage to find the stone, take it directly to the tree and then come see me."
  5:  Exit  {}

  6:  SetMessage  {Str = 177}         -- "You've done a good thing, returning the Heart.  The forest is quieter now, and no longer attacks travelers.  You've probably saved many lives.  For service to the Land and the Light, I hereby promote all Hunters among you to Ranger Lords, and all honorary Hunters to honorary Ranger Lords!"
  7:  ForPlayer  (0)
  8:  Cmp  {"ClassIs", Value = const.Class.Hunter,   jump = 12}
  9:  Add  {"Awards", Value = 31}         -- "Promoted to Honorary Ranger Lord"
  10: Add  {"Experience", Value = 40000}
  11: GoTo  {jump = 15}

  12: Set  {"ClassIs", Value = const.Class.RangerLord}
  13: Add  {"Awards", Value = 30}         -- "Promoted to Ranger Lord"
  14: Add  {"Experience", Value = 80000}
  15: ForPlayer  (1)
  16: Cmp  {"ClassIs", Value = const.Class.Hunter,   jump = 20}
  17: Add  {"Awards", Value = 31}         -- "Promoted to Honorary Ranger Lord"
  18: Add  {"Experience", Value = 40000}
  19: GoTo  {jump = 23}

  20: Set  {"ClassIs", Value = const.Class.RangerLord}
  21: Add  {"Awards", Value = 30}         -- "Promoted to Ranger Lord"
  22: Add  {"Experience", Value = 80000}
  23: ForPlayer  (2)
  24: Cmp  {"ClassIs", Value = const.Class.Hunter,   jump = 28}
  25: Add  {"Awards", Value = 31}         -- "Promoted to Honorary Ranger Lord"
  26: Add  {"Experience", Value = 40000}
  27: GoTo  {jump = 31}

  28: Set  {"ClassIs", Value = const.Class.RangerLord}
  29: Add  {"Awards", Value = 30}         -- "Promoted to Ranger Lord"
  30: Add  {"Experience", Value = 80000}
  31: ForPlayer  (3)
  32: Cmp  {"ClassIs", Value = const.Class.Hunter,   jump = 36}
  33: Add  {"Awards", Value = 31}         -- "Promoted to Honorary Ranger Lord"
  34: Add  {"Experience", Value = 40000}
  35: GoTo  {jump = 39}

  36: Set  {"ClassIs", Value = const.Class.RangerLord}
  37: Add  {"Awards", Value = 30}         -- "Promoted to Ranger Lord"
  38: Add  {"Experience", Value = 80000}
  39: Subtract  {"QBits", Value = 36}         -- "Calm the trees in the Tularean Forest by speaking to the Oldest Tree then return to Lysander Sweet in the Bracada Desert."
  40: Subtract  {"Reputation", Value = 10}
  41: ForPlayer  ("All")
  42: SetNPCTopic  {NPC = 44, Index = 0, Event = 0}         -- "Lysander Sweet"
  43: SetNPCGreeting  {NPC = 44, Greeting = 65}         -- "Lysander Sweet" : "Your good works have served the forest well.  And, I can see, the experience has served you well in turn.  May you continue to reap the rewards of your good deeds, my friends!"
end

event 79  -- "Hunter"
  0:  SetMessage  {Str = 178}         -- "Think you can improve?  I have a test for you.  A hunter needs to understand the woods, and a hunter needs to be as skilled with magic as with a blade.  The best teachers for that are the faeries.  There's a faerie mound in Northern Avlee.  Figure out how to get in, and the Faeries will grant magic to the genuine rangers among you, meaning that they will be promoted to Hunter status.  The rest of you will be honorary hunters. "
  1:  Set  {"QBits", Value = 37}         -- "Solve the secret to the entrance of the Faerie Mound in Avlee and speak to the Faerie King."
  2:  SetNPCTopic  {NPC = 45, Index = 0, Event = 80}         -- "Ebednezer Sower" : "Hunter"
end

event 80  -- "Hunter"
  0:  SetMessage  {Str = 179}         -- "Foxed by the Faeries? [Ebednezer snickers, then begins to laugh uproariously at his own wit] Foxed?  Faeries?  Hahahah!  Get it?  Foxed… you know…ah ahahah.  Maybe not.  Well, I've already told you how to become Hunters.  Get inside the Faerie Mound in Avlee.  Now, stop bothering me!  "
end

event 81  -- "Bounty Hunter"
  0:  Cmp  {"QBits", Value = 99,   jump = 4}         -- Chose the path of Light
  1:  Cmp  {"QBits", Value = 100,   jump = 6}         -- Chose the path of Dark
  2:  SetMessage  {Str = 181}         -- "I'll be blunt.  I don't think I like you.  You'll have to prove to me you're worth something.  Soon, you will have to choose if you'll follow the Path of Dark or the Path of Light.  If you choose Light, don't even bother speaking to me again.  Got it?"
  3:  Exit  {}

  4:  SetMessage  {Str = 182}         -- "Gahhh!  I can smell the stink of self righteousness on you!  Get away from me!  G'won, get!"
  5:  Exit  {}

  6:  SetMessage  {Str = 180}         -- "Better a bounty hunter than a plain old hunter, huh?  Well, this test is even simpler than the Faerie Mound idea, and you won't have to think so hard.  Ever notice how the town halls are always looking for someone to kill a monster for them?  All you have to do is collect 10,000 in bounties from town halls.  When you've done that, come back to me, and I'll promote you to Bounty Hunters.  "
  7:  Set  {"QBits", Value = 38}         -- "Collect 10,000 gold worth of bounties from the Bounty Hunts in the town halls, then return to Ebednezer Sower in the Tularean Forest."
  8:  SetNPCTopic  {NPC = 45, Index = 0, Event = 82}         -- "Ebednezer Sower" : "Bounty Hunter"
end

event 82  -- "Bounty Hunter"
  0:  Cmp  {"MontersHunted", Value = 10000,   jump = 3}
  1:  SetMessage  {Str = 184}         -- "Not yet, not good enough!  You need to collect more bounties, and more importantly, kill more creatures.  There's some good clean fun in that.  Killing, don't you know."
  2:  Exit  {}

  3:  SetMessage  {Str = 183}         -- "So, how did if feel?  All that killing?  Mmmmm.  Heh.  You qualify, my friends.  You definitely qualify.  All Hunters amongst you are now Bounty Hunters, and all Honorary hunters and Honorary Bounty Hunters!  Good job."
  4:  ForPlayer  (0)
  5:  Cmp  {"ClassIs", Value = const.Class.Hunter,   jump = 9}
  6:  Add  {"Awards", Value = 33}         -- "Promoted to Honorary Bounty Hunter"
  7:  Add  {"Experience", Value = 40000}
  8:  GoTo  {jump = 12}

  9:  Set  {"ClassIs", Value = const.Class.BountyHunter}
  10: Add  {"Awards", Value = 32}         -- "Promoted to Bounty Hunter"
  11: Add  {"Experience", Value = 80000}
  12: ForPlayer  (1)
  13: Cmp  {"ClassIs", Value = const.Class.Hunter,   jump = 17}
  14: Add  {"Awards", Value = 33}         -- "Promoted to Honorary Bounty Hunter"
  15: Add  {"Experience", Value = 40000}
  16: GoTo  {jump = 20}

  17: Set  {"ClassIs", Value = const.Class.BountyHunter}
  18: Add  {"Awards", Value = 32}         -- "Promoted to Bounty Hunter"
  19: Add  {"Experience", Value = 80000}
  20: ForPlayer  (2)
  21: Cmp  {"ClassIs", Value = const.Class.Hunter,   jump = 25}
  22: Add  {"Awards", Value = 33}         -- "Promoted to Honorary Bounty Hunter"
  23: Add  {"Experience", Value = 40000}
  24: GoTo  {jump = 28}

  25: Set  {"ClassIs", Value = const.Class.BountyHunter}
  26: Add  {"Awards", Value = 32}         -- "Promoted to Bounty Hunter"
  27: Add  {"Experience", Value = 80000}
  28: ForPlayer  (3)
  29: Cmp  {"ClassIs", Value = const.Class.Hunter,   jump = 33}
  30: Add  {"Awards", Value = 33}         -- "Promoted to Honorary Bounty Hunter"
  31: Add  {"Experience", Value = 40000}
  32: GoTo  {jump = 36}

  33: Set  {"ClassIs", Value = const.Class.BountyHunter}
  34: Add  {"Awards", Value = 32}         -- "Promoted to Bounty Hunter"
  35: Add  {"Experience", Value = 80000}
  36: Subtract  {"QBits", Value = 38}         -- "Collect 10,000 gold worth of bounties from the Bounty Hunts in the town halls, then return to Ebednezer Sower in the Tularean Forest."
  37: Subtract  {"Reputation", Value = 10}
  38: ForPlayer  ("All")
  39: SetNPCTopic  {NPC = 45, Index = 0, Event = 0}         -- "Ebednezer Sower"
  40: SetNPCGreeting  {NPC = 45, Greeting = 67}         -- "Ebednezer Sower" : "Bounty Hunters.  [Ebednezer smiles slowly and evilly]  Now THERE'S a job!  Yes sir.  Get things done righteo quick, I'll say. Heh."
end

event 83  -- "Hunter?"
  0:  CanShowTopic.Cmp  {"QBits", Value = 37,   jump = 3}         -- "Solve the secret to the entrance of the Faerie Mound in Avlee and speak to the Faerie King."
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 185}         -- "Come to my door looking for magic?  Thee've always had it, if thee knew where to look.  Some I tell this to, and they still can't see it, though it be plain as the nose on their face.  Those amongst thee that are simple Rangers are now Hunters, and those who aren't are but Honorary Hunters.  Clever the ones who can knock on my door!"
  6:  ForPlayer  (0)
  7:  Cmp  {"ClassIs", Value = const.Class.Ranger,   jump = 11}
  8:  Add  {"Awards", Value = 29}         -- "Promoted to Honorary Hunter"
  9:  Add  {"Experience", Value = 15000}
  10: GoTo  {jump = 14}

  11: Set  {"ClassIs", Value = const.Class.Hunter}
  12: Add  {"Awards", Value = 28}         -- "Promoted to Hunter"
  13: Add  {"Experience", Value = 30000}
  14: ForPlayer  (1)
  15: Cmp  {"ClassIs", Value = const.Class.Ranger,   jump = 19}
  16: Add  {"Awards", Value = 29}         -- "Promoted to Honorary Hunter"
  17: Add  {"Experience", Value = 15000}
  18: GoTo  {jump = 22}

  19: Set  {"ClassIs", Value = const.Class.Hunter}
  20: Add  {"Awards", Value = 28}         -- "Promoted to Hunter"
  21: Add  {"Experience", Value = 30000}
  22: ForPlayer  (2)
  23: Cmp  {"ClassIs", Value = const.Class.Ranger,   jump = 27}
  24: Add  {"Awards", Value = 29}         -- "Promoted to Honorary Hunter"
  25: Add  {"Experience", Value = 15000}
  26: GoTo  {jump = 30}

  27: Set  {"ClassIs", Value = const.Class.Hunter}
  28: Add  {"Awards", Value = 28}         -- "Promoted to Hunter"
  29: Add  {"Experience", Value = 30000}
  30: ForPlayer  (3)
  31: Cmp  {"ClassIs", Value = const.Class.Ranger,   jump = 35}
  32: Add  {"Awards", Value = 29}         -- "Promoted to Honorary Hunter"
  33: Add  {"Experience", Value = 15000}
  34: GoTo  {jump = 38}

  35: Set  {"ClassIs", Value = const.Class.Hunter}
  36: Add  {"Awards", Value = 28}         -- "Promoted to Hunter"
  37: Add  {"Experience", Value = 30000}
  38: Subtract  {"QBits", Value = 37}         -- "Solve the secret to the entrance of the Faerie Mound in Avlee and speak to the Faerie King."
  39: ForPlayer  ("All")
  40: SetNPCTopic  {NPC = 45, Index = 0, Event = 81}         -- "Ebednezer Sower" : "Bounty Hunter"
  41: SetNPCTopic  {NPC = 52, Index = 0, Event = 0}         -- "Faerie King"
end

event 84  -- "Heart of the Wood"
  0:  CanShowTopic.Cmp  {"QBits", Value = 36,   jump = 3}         -- "Calm the trees in the Tularean Forest by speaking to the Oldest Tree then return to Lysander Sweet in the Bracada Desert."
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 186}         -- "The thieves reached deep inside me to take my Heart.  The grapevines say they are hiding in the Mercenary Guild in Tatalia.  We would squeeze them, but they aren't close enough to reach.  Walkers are needed to catch walkers.  Catch the thieves for us.  Ok?"
  6:  Set  {"QBits", Value = 39}         -- "Find the Heart of the Forest in the Mercenary Guild in Tatalia and return it to the Oldest Tree in the Tularean Forest."
  7:  SetNPCTopic  {NPC = 53, Index = 0, Event = 85}         -- "The Oldest Tree" : "Heart of the Wood"
end

event 85  -- "Heart of the Wood"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 600,   jump = 4}         -- "Heart of the Wood"
  2:  SetMessage  {Str = 188}         -- "Oh, the forest is still very angry.  The grapevines say the thieves have not left their hiding place.  You will catch the thieves for us, won't you?"
  3:  Exit  {}

  4:  SetMessage  {Str = 187}         -- "Ahhh!  [The tree sighs happily]  You have the heart!  The forest sings with joy!  Tonight we will recite the song of the ancestors.  Will you stay and recite with us?"
  5:  Subtract  {"Inventory", Value = 600}         -- "Heart of the Wood"
  6:  Subtract  {"QBits", Value = 217}         -- Heart of Wood - I lost it
  7:  Add  {"Experience", Value = 5000}
  8:  Subtract  {"QBits", Value = 39}         -- "Find the Heart of the Forest in the Mercenary Guild in Tatalia and return it to the Oldest Tree in the Tularean Forest."
  9:  Set  {"QBits", Value = 41}         -- Solved Tree quest
  10: SetNPCTopic  {NPC = 53, Index = 0, Event = 0}         -- "The Oldest Tree"
  11: SetNPCGreeting  {NPC = 53, Greeting = 71}         -- "The Oldest Tree" : "Ohhhhh…It's the Walkers from the South.  I remember you!  You returned the Heart.  The trees are very happy, and promise not to kill any more walkers.  Come and talk to me any time."
  12: Set  {"Awards", Value = 61}         -- "Retrieved the Heart of the Wood"
  13: SetMonGroupBit  {NPCGroup = 10, Bit = const.MonsterBits.Hostile, On = false}         -- "Southern Village Group in Harmondy"
end

event 86  -- "Priest of Light"
  0:  Cmp  {"Awards", Value = 62,   jump = 4}         -- "Promoted to Priest"
  1:  Cmp  {"Awards", Value = 63,   jump = 4}         -- "Promoted to Honorary Priest"
  2:  SetMessage  {Str = 191}         -- "If you wish to become Priests of the Light, you must first become Priests.  I don't have time to train priests, but my bitter rival, Daedalus Falk, does.  Do not worry, he will promote you fairly, even if you do not wish to follow the terrible path of darkness that he represents."
  3:  Exit  {}

  4:  Cmp  {"QBits", Value = 99,   jump = 10}         -- Chose the path of Light
  5:  Cmp  {"QBits", Value = 100,   jump = 8}         -- Chose the path of Dark
  6:  SetMessage  {Str = 190}         -- "If you wish to follow the Path of Light, first you must formally choose it.  Soon you will be asked to make the choice, and the way will be clear.  Until then, I cannot be your guide."
  7:  Exit  {}

  8:  SetMessage  {Str = 192}         -- "You've come to the wrong person if you want to be promoted beyond priest.  I am well aware of your choice to follow the Path of the Dark, and I will have nothing to do with you."
  9:  Exit  {}

  10: SetMessage  {Str = 189}         --[[ "Priests.  You have come to me seeking that I be your guide on the Path of Light.  But be warned, to learn its ways, you must learn the ways of your own soul.  I would suggest that we meditate on this for awhile, but you look like you're in a hurry.  South of Bracada is an island called Evenmorn, and upon that island are the old temples of the Sun and the Moon.  Both are inhabited by the remnants of the two religions, their once proud churches reduced to two old temples fighting for a small island.

The Church of the Sun was the founding religion for our current faith, the Path of Light.  I propose we help them out and tip the balance in favor of the Church of the Sun.  Using the map that Daedalus Falk sent you to find in order to become priests, convince a sea captain to bring you to the island.  There, bring aid and comfort to the Church of the Sun by purifying the altar in the Church of the Moon.  This will so weaken the Moon cult that the Church of the Sun will be able to overcome them in battle.  Return to me when you have done this.   " ]]
  11: Set  {"QBits", Value = 42}         -- "Purify the Altar of Evil in the Temple of the Moon on Evenmorn Isle then return to Rebecca Devine in Celeste."
  12: SetNPCTopic  {NPC = 46, Index = 0, Event = 87}         -- "Rebecca Devine" : "Priest of Light"
end

event 87  -- "Priest of Light"
  0:  Cmp  {"QBits", Value = 62,   jump = 3}         -- Purified the Altar of Evil.  Priest of Light promo quest.
  1:  SetMessage  {Str = 194}         -- "You must visit Evenmorn island and purify the Altar of Darkness in the Church of the Moon.  Only then can I promote you to Priests of the Light."
  2:  Exit  {}

  3:  SetMessage  {Str = 193}         -- "Your bravery has advanced our faith tremendously, Priests.  It's with a glad heart that I can hereby promote all Priests to Priests of the Light, and all honorary Priests to Honorary Priests of the Light.  Thank you so much for your help!"
  4:  ForPlayer  (0)
  5:  Cmp  {"ClassIs", Value = const.Class.Priest,   jump = 9}
  6:  Add  {"Awards", Value = 65}         -- "Promoted to Honorary Priest of the Light"
  7:  Add  {"Experience", Value = 40000}
  8:  GoTo  {jump = 12}

  9:  Set  {"ClassIs", Value = const.Class.PriestLight}
  10: Add  {"Awards", Value = 64}         -- "Promoted to Priest of the Light"
  11: Add  {"Experience", Value = 80000}
  12: ForPlayer  (1)
  13: Cmp  {"ClassIs", Value = const.Class.Priest,   jump = 17}
  14: Add  {"Awards", Value = 65}         -- "Promoted to Honorary Priest of the Light"
  15: Add  {"Experience", Value = 40000}
  16: GoTo  {jump = 20}

  17: Set  {"ClassIs", Value = const.Class.PriestLight}
  18: Add  {"Awards", Value = 64}         -- "Promoted to Priest of the Light"
  19: Add  {"Experience", Value = 80000}
  20: ForPlayer  (2)
  21: Cmp  {"ClassIs", Value = const.Class.Priest,   jump = 25}
  22: Add  {"Awards", Value = 65}         -- "Promoted to Honorary Priest of the Light"
  23: Add  {"Experience", Value = 40000}
  24: GoTo  {jump = 28}

  25: Set  {"ClassIs", Value = const.Class.PriestLight}
  26: Add  {"Awards", Value = 64}         -- "Promoted to Priest of the Light"
  27: Add  {"Experience", Value = 80000}
  28: ForPlayer  (3)
  29: Cmp  {"ClassIs", Value = const.Class.Priest,   jump = 33}
  30: Add  {"Awards", Value = 65}         -- "Promoted to Honorary Priest of the Light"
  31: Add  {"Experience", Value = 40000}
  32: GoTo  {jump = 36}

  33: Set  {"ClassIs", Value = const.Class.PriestLight}
  34: Add  {"Awards", Value = 64}         -- "Promoted to Priest of the Light"
  35: Add  {"Experience", Value = 80000}
  36: Subtract  {"QBits", Value = 42}         -- "Purify the Altar of Evil in the Temple of the Moon on Evenmorn Isle then return to Rebecca Devine in Celeste."
  37: Add  {"Gold", Value = 10000}
  38: Subtract  {"Reputation", Value = 10}
  39: ForPlayer  ("All")
  40: SetNPCTopic  {NPC = 46, Index = 0, Event = 0}         -- "Rebecca Devine"
  41: SetNPCGreeting  {NPC = 46, Greeting = 73}         -- "Rebecca Devine" : "Sunlight Reveal, my fellow Priests.  I am always delighted to see you!"
end

event 88  -- "Priest"
  0:  SetMessage  {Str = 195}         -- "[Falk gives you a grandfatherly smile] You have, perhaps, an ambition to be priests?  I can help you, if you'll help me.  There is an island south of Bracada where stands an old temple that I need to find again.  I think the pirates west of Erathia must know where the island is.  The Erathian navy is rather feeble, and hasn't been able to root them out of their hiding places amongst the Tidewater Caverns.  Perhaps the pirates have a map.  If you can bring me that map, I would promote you to Priest status immediately."
  1:  Set  {"QBits", Value = 43}         -- "Find the lost pirate map in the Tidewater Caverns in Tatalia and return to Daedalus Falk in the Deyja Moors."
  2:  SetNPCTopic  {NPC = 47, Index = 0, Event = 89}         -- "Daedalus Falk" : "Priest"
end

event 89  -- "Priest"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 683,   jump = 4}         -- "Map to Evenmorn Island"
  2:  SetMessage  {Str = 197}         -- "If there is a map that says where that island is, the map would be in the Tidewater Caverns of western Erathia.  When you bring me that map, then I will be happy to promote you all to Priests."
  3:  Exit  {}

  4:  SetMessage  {Str = 196}         -- "The Map!  You found it!  [Falk looks at the map, and points at the island] There it is.  The island has been shrouded in mist since the Churches of the Sun and Moon began fighting over a century ago.  Keep the map--I have the coordinates now, and will have no trouble finding the place when I need to.  I am proud to declare the Clerics amongst you to be Priests, and the rest to be honorary Priests.  Thank you so much for your good work!"
  5:  ForPlayer  (0)
  6:  Cmp  {"ClassIs", Value = const.Class.Cleric,   jump = 10}
  7:  Add  {"Awards", Value = 63}         -- "Promoted to Honorary Priest"
  8:  Add  {"Experience", Value = 15000}
  9:  GoTo  {jump = 13}

  10: Set  {"ClassIs", Value = const.Class.Priest}
  11: Add  {"Awards", Value = 62}         -- "Promoted to Priest"
  12: Add  {"Experience", Value = 30000}
  13: ForPlayer  (1)
  14: Cmp  {"ClassIs", Value = const.Class.Cleric,   jump = 18}
  15: Add  {"Awards", Value = 63}         -- "Promoted to Honorary Priest"
  16: Add  {"Experience", Value = 15000}
  17: GoTo  {jump = 21}

  18: Set  {"ClassIs", Value = const.Class.Priest}
  19: Add  {"Awards", Value = 62}         -- "Promoted to Priest"
  20: Add  {"Experience", Value = 30000}
  21: ForPlayer  (2)
  22: Cmp  {"ClassIs", Value = const.Class.Cleric,   jump = 26}
  23: Add  {"Awards", Value = 63}         -- "Promoted to Honorary Priest"
  24: Add  {"Experience", Value = 15000}
  25: GoTo  {jump = 29}

  26: Set  {"ClassIs", Value = const.Class.Priest}
  27: Add  {"Awards", Value = 62}         -- "Promoted to Priest"
  28: Add  {"Experience", Value = 30000}
  29: ForPlayer  (3)
  30: Cmp  {"ClassIs", Value = const.Class.Cleric,   jump = 34}
  31: Add  {"Awards", Value = 63}         -- "Promoted to Honorary Priest"
  32: Add  {"Experience", Value = 15000}
  33: GoTo  {jump = 37}

  34: Set  {"ClassIs", Value = const.Class.Priest}
  35: Add  {"Awards", Value = 62}         -- "Promoted to Priest"
  36: Add  {"Experience", Value = 30000}
  37: Subtract  {"QBits", Value = 43}         -- "Find the lost pirate map in the Tidewater Caverns in Tatalia and return to Daedalus Falk in the Deyja Moors."
  38: Add  {"Gold", Value = 5000}
  39: Subtract  {"Reputation", Value = 5}
  40: ForPlayer  ("All")
  41: Subtract  {"Inventory", Value = 683}         -- "Map to Evenmorn Island"
  42: Subtract  {"QBits", Value = 218}         -- Map to Evenmorn - I lost it
  43: SetNPCTopic  {NPC = 47, Index = 0, Event = 90}         -- "Daedalus Falk" : "Priest of Dark"
  44: Set  {"QBits", Value = 64}         -- Activate boat to area 9.  Priest promo quest
end

event 90  -- "Priest of Dark"
  0:  Cmp  {"QBits", Value = 99,   jump = 4}         -- Chose the path of Light
  1:  Cmp  {"QBits", Value = 100,   jump = 6}         -- Chose the path of Dark
  2:  SetMessage  {Str = 199}         -- "If you wish to follow the Path of Darkness, first you must formally choose it.  Soon you will be asked to make the choice, and the way will be clear.  Until then, I cannot be your guide."
  3:  Exit  {}

  4:  SetMessage  {Str = 200}         -- "How dare you insult me with your presence?  You have chosen the Path of the Light, and have forever renounced me as your teacher.  Go now, and wallow in your weakness somewhere else."
  5:  Exit  {}

  6:  SetMessage  {Str = 198}         --[[ "Priests.  [Falk gazes coldly at you] Well it is that you have come to see the wisdom of the Path of the Dark.  Never regret your decision, and never look back.  South of Bracada is an island called Evenmorn, and upon that island are the old temples of the Sun and the Moon.  Both are inhabited by the remnants of the two religions, their once proud churches reduced to two old temples fighting for a small island.

The Church of the Moon was the founding religion for our current faith, the Path of Darkness.  I propose we help them out and tip the balance in favor of the Church of the Moon.  Using the map that I sent you to find, convince a sea captain to bring you to the island.  There, bring aid and comfort to the Church of the Moon by defiling the altar in the Church of the Sun.  This will so weaken the Sun cult that the Church of the Moon will be able to overcome them in battle.  Return to me when you have done this.   " ]]
  7:  Set  {"QBits", Value = 44}         -- "Deface the Altar of Good in the Temple of the Sun on Evenmorn Isle then return to Daedalus Falk in the Deyja Moors."
  8:  SetNPCTopic  {NPC = 47, Index = 0, Event = 91}         -- "Daedalus Falk" : "Priest of Dark"
end

event 91  -- "Priest of Dark"
  0:  Cmp  {"QBits", Value = 63,   jump = 3}         -- Defaced the Altar of Good.  Priest of Dark promo quest.
  1:  SetMessage  {Str = 202}         -- "You must visit Evenmorn island and defile the Altar of Light in the Church of the Sun.  Only then can I promote you to Priests of the Dark."
  2:  Exit  {}

  3:  SetMessage  {Str = 201}         -- "Your bravery has advanced our faith tremendously, Priests.  It's with pleasure that I can hereby promote all Priests to Priests of the Dark, and all honorary Priests to Honorary Priests of the Dark.  Thank you so much for your help!"
  4:  ForPlayer  (0)
  5:  Cmp  {"ClassIs", Value = const.Class.Priest,   jump = 9}
  6:  Add  {"Awards", Value = 67}         -- "Promoted to Honorary Priest of the Dark"
  7:  Add  {"Experience", Value = 40000}
  8:  GoTo  {jump = 12}

  9:  Set  {"ClassIs", Value = const.Class.PriestDark}
  10: Add  {"Awards", Value = 66}         -- "Promoted to Priest of the Dark"
  11: Add  {"Experience", Value = 80000}
  12: ForPlayer  (1)
  13: Cmp  {"ClassIs", Value = const.Class.Priest,   jump = 17}
  14: Add  {"Awards", Value = 67}         -- "Promoted to Honorary Priest of the Dark"
  15: Add  {"Experience", Value = 40000}
  16: GoTo  {jump = 20}

  17: Set  {"ClassIs", Value = const.Class.PriestDark}
  18: Add  {"Awards", Value = 66}         -- "Promoted to Priest of the Dark"
  19: Add  {"Experience", Value = 80000}
  20: ForPlayer  (2)
  21: Cmp  {"ClassIs", Value = const.Class.Priest,   jump = 25}
  22: Add  {"Awards", Value = 67}         -- "Promoted to Honorary Priest of the Dark"
  23: Add  {"Experience", Value = 40000}
  24: GoTo  {jump = 28}

  25: Set  {"ClassIs", Value = const.Class.PriestDark}
  26: Add  {"Awards", Value = 66}         -- "Promoted to Priest of the Dark"
  27: Add  {"Experience", Value = 80000}
  28: ForPlayer  (3)
  29: Cmp  {"ClassIs", Value = const.Class.Priest,   jump = 33}
  30: Add  {"Awards", Value = 67}         -- "Promoted to Honorary Priest of the Dark"
  31: Add  {"Experience", Value = 40000}
  32: GoTo  {jump = 36}

  33: Set  {"ClassIs", Value = const.Class.PriestDark}
  34: Add  {"Awards", Value = 66}         -- "Promoted to Priest of the Dark"
  35: Add  {"Experience", Value = 80000}
  36: Subtract  {"QBits", Value = 44}         -- "Deface the Altar of Good in the Temple of the Sun on Evenmorn Isle then return to Daedalus Falk in the Deyja Moors."
  37: Add  {"Gold", Value = 10000}
  38: Subtract  {"Reputation", Value = 10}
  39: ForPlayer  ("All")
  40: SetNPCTopic  {NPC = 47, Index = 0, Event = 0}         -- "Daedalus Falk"
  41: SetNPCGreeting  {NPC = 47, Greeting = 75}         -- "Daedalus Falk" : "Shadow Conceal, Brethren.  My time is always yours."
end

event 92  -- "Wizard"
  0:  SetMessage  {Str = 203}         --[[ "I am indeed the one to speak to if you wish to become Wizards.  Every student of mine must complete a project before I name them Wizards.  This year's project is to build a golem.  There are spare parts scattered about the lands from here to Avlee.  You'll need all four limbs plus the torso and the head.  Pay special attention to where you get the head--one of my students made a mistake while making a head last summer and gave the defective head away as a joke.  

When you have all the parts, come talk to me.  I'll promote you to Wizards then, and I'll animate your Golem.  Well, on your way, and have fun!" ]]
  1:  Set  {"QBits", Value = 45}         -- "Collect the six golem pieces and construct a complete golem, then return to Thomas Grey in the School of Sorcery."
  2:  Set  {"NPCs", Value = 56}         -- "Golem"
  3:  SetNPCTopic  {NPC = 48, Index = 0, Event = 93}         -- "Thomas Grey" : "Wizard"
end

event 93  -- "Wizard"
  0:  Cmp  {"QBits", Value = 74,   jump = 4}         -- Finished constructing Golem with normal head
  1:  Cmp  {"QBits", Value = 73,   jump = 4}         -- Finished constructing Golem with Abbey normal head
  2:  SetMessage  {Str = 205}         -- "You have to have all the parts together and properly assembled for me to animate it, students!  I can't animate incomplete golems."
  3:  Exit  {}

  4:  SetMessage  {Str = 204}         -- "[You proudly display your assembled golem to Master Grey, and he nods approvingly] Well done.  Head looks alright, but you can never be sure…Well, good work!  Clearly, you qualify for Wizard status.  All Sorcerers amongst you are now Wizards, and all non Sorcerers are now honorary Wizards!  [Master Grey spends awhile casting the spell that animates your golem] He's all yours!  Take him back to your castle and put him where you want.  He'll attack intruders relentlessly.  "
  5:  ForPlayer  (0)
  6:  Cmp  {"ClassIs", Value = const.Class.Sorcerer,   jump = 10}
  7:  Add  {"Awards", Value = 75}         -- "Promoted to Honorary Wizard"
  8:  Add  {"Experience", Value = 15000}
  9:  GoTo  {jump = 13}

  10: Set  {"ClassIs", Value = const.Class.Wizard}
  11: Add  {"Awards", Value = 74}         -- "Promoted to Wizard"
  12: Add  {"Experience", Value = 30000}
  13: ForPlayer  (1)
  14: Cmp  {"ClassIs", Value = const.Class.Sorcerer,   jump = 18}
  15: Add  {"Awards", Value = 75}         -- "Promoted to Honorary Wizard"
  16: Add  {"Experience", Value = 15000}
  17: GoTo  {jump = 21}

  18: Set  {"ClassIs", Value = const.Class.Wizard}
  19: Add  {"Awards", Value = 74}         -- "Promoted to Wizard"
  20: Add  {"Experience", Value = 30000}
  21: ForPlayer  (2)
  22: Cmp  {"ClassIs", Value = const.Class.Sorcerer,   jump = 26}
  23: Add  {"Awards", Value = 75}         -- "Promoted to Honorary Wizard"
  24: Add  {"Experience", Value = 15000}
  25: GoTo  {jump = 29}

  26: Set  {"ClassIs", Value = const.Class.Wizard}
  27: Add  {"Awards", Value = 74}         -- "Promoted to Wizard"
  28: Add  {"Experience", Value = 30000}
  29: ForPlayer  (3)
  30: Cmp  {"ClassIs", Value = const.Class.Sorcerer,   jump = 34}
  31: Add  {"Awards", Value = 75}         -- "Promoted to Honorary Wizard"
  32: Add  {"Experience", Value = 15000}
  33: GoTo  {jump = 37}

  34: Set  {"ClassIs", Value = const.Class.Wizard}
  35: Add  {"Awards", Value = 74}         -- "Promoted to Wizard"
  36: Add  {"Experience", Value = 30000}
  37: Subtract  {"QBits", Value = 45}         -- "Collect the six golem pieces and construct a complete golem, then return to Thomas Grey in the School of Sorcery."
  38: ForPlayer  ("All")
  39: SetNPCTopic  {NPC = 48, Index = 0, Event = 94}         -- "Thomas Grey" : "Archmage"
  40: SetNPCGreeting  {NPC = 56, Greeting = 84}         -- "Golem" : "I am yours to command, master."
  41: Set  {"QBits", Value = 46}         -- Player Castle.  Golem should appear in castle bit.
  42: Subtract  {"QBits", Value = 219}         -- Golem Head - I lost it
  43: Subtract  {"QBits", Value = 220}         -- Abby normal head - I lost it
end

event 94  -- "Archmage"
  0:  Cmp  {"QBits", Value = 99,   jump = 6}         -- Chose the path of Light
  1:  Cmp  {"QBits", Value = 100,   jump = 4}         -- Chose the path of Dark
  2:  SetMessage  {Str = 207}         -- "Archmage training is reserved only for people dedicated to the Path of Light.  Prove to me you have chosen the right way, and I will be proud to be your teacher."
  3:  Exit  {}

  4:  SetMessage  {Str = 208}         -- "You've chosen Darkness, my students.  I will teach you no more."
  5:  Exit  {}

  6:  SetMessage  {Str = 206}         --[[ "Welcome back, students.  The golem lesson was just an exercise, but to advance to Archmage, you really have to do something for the profession.  Copies of the fabled Divine Intervention spell are very rare, and unfortunately the School doesn't have one.  There's been a history of bad luck regarding the spell.

It has been around for time immemorial, but the spell has never found its way into our hands.  Always just out of reach, we often send guild members to find it, but every one has failed.  Sometimes they have it in their hands, but lose it on the way back, other times, the book seems to vanish, only to resurface 20 years later in some old dungeon, or on a deserted island.  Right now, we think it's in the Breeding Zone in the Pit.  Find the spell, and return with it.  Break the curse!" ]]
  7:  Set  {"QBits", Value = 47}         -- "Find the Book of Divine Intervention in the Breeding Zone in the Pit and return it to Thomas Grey in the School of Sorcery."
  8:  SetNPCTopic  {NPC = 48, Index = 0, Event = 95}         -- "Thomas Grey" : "Archmage"
end

event 95  -- "Archmage"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 487,   jump = 4}         -- "Divine Intervention"
  2:  SetMessage  {Str = 210}         -- "I expect trouble finding the book, which is why I'm sending you to find it.  I know you can succeed in this mission.  Keep trying!"
  3:  Exit  {}

  4:  SetMessage  {Str = 209}         -- "The book!  The book!  [Master Grey clutches his ears and spins around in joy] You did it!  Oh, what a wonderful day!  I am so proud of you!  You're all Archmages!  Of course, if you weren't Wizards to begin with, it's only an honorary title, but who cares?  You found the book!  [The Master sets the book down on a table next to a blank book.  Both open simultaneously, and quill arises from the desk to begin copying the text in the new book] You may keep the copy, and you should start seeing more copies in the Light guilds of Bracada and Celeste."
  5:  ForPlayer  (0)
  6:  Cmp  {"ClassIs", Value = const.Class.Wizard,   jump = 10}
  7:  Add  {"Awards", Value = 77}         -- "Promoted to Honorary Archmage"
  8:  Add  {"Experience", Value = 40000}
  9:  GoTo  {jump = 13}

  10: Set  {"ClassIs", Value = const.Class.ArchMage}
  11: Add  {"Awards", Value = 76}         -- "Promoted to Archmage"
  12: Add  {"Experience", Value = 80000}
  13: ForPlayer  (1)
  14: Cmp  {"ClassIs", Value = const.Class.Wizard,   jump = 18}
  15: Add  {"Awards", Value = 77}         -- "Promoted to Honorary Archmage"
  16: Add  {"Experience", Value = 40000}
  17: GoTo  {jump = 21}

  18: Set  {"ClassIs", Value = const.Class.ArchMage}
  19: Add  {"Awards", Value = 76}         -- "Promoted to Archmage"
  20: Add  {"Experience", Value = 80000}
  21: ForPlayer  (2)
  22: Cmp  {"ClassIs", Value = const.Class.Wizard,   jump = 26}
  23: Add  {"Awards", Value = 77}         -- "Promoted to Honorary Archmage"
  24: Add  {"Experience", Value = 40000}
  25: GoTo  {jump = 29}

  26: Set  {"ClassIs", Value = const.Class.ArchMage}
  27: Add  {"Awards", Value = 76}         -- "Promoted to Archmage"
  28: Add  {"Experience", Value = 80000}
  29: ForPlayer  (3)
  30: Cmp  {"ClassIs", Value = const.Class.Wizard,   jump = 34}
  31: Add  {"Awards", Value = 77}         -- "Promoted to Honorary Archmage"
  32: Add  {"Experience", Value = 40000}
  33: GoTo  {jump = 37}

  34: Set  {"ClassIs", Value = const.Class.ArchMage}
  35: Add  {"Awards", Value = 76}         -- "Promoted to Archmage"
  36: Add  {"Experience", Value = 80000}
  37: Subtract  {"QBits", Value = 47}         -- "Find the Book of Divine Intervention in the Breeding Zone in the Pit and return it to Thomas Grey in the School of Sorcery."
  38: Subtract  {"QBits", Value = 226}         -- Book of Divine Intervention - I lost it
  39: Add  {"Gold", Value = 10000}
  40: ForPlayer  ("All")
  41: SetNPCTopic  {NPC = 48, Index = 0, Event = 0}         -- "Thomas Grey"
  42: SetNPCGreeting  {NPC = 48, Greeting = 77}         -- "Thomas Grey" : "I am honored to be graced with your presence, my lords."
end

event 96  -- "Lich"
  0:  Cmp  {"Awards", Value = 74,   jump = 4}         -- "Promoted to Wizard"
  1:  Cmp  {"Awards", Value = 75,   jump = 4}         -- "Promoted to Honorary Wizard"
  2:  SetMessage  {Str = 212}         -- "If you haven't even become Wizards yet, you aren't ready to become Liches.  Trouble me not 'til you're qualified."
  3:  Exit  {}

  4:  Cmp  {"QBits", Value = 100,   jump = 10}         -- Chose the path of Dark
  5:  Cmp  {"QBits", Value = 99,   jump = 8}         -- Chose the path of Light
  6:  SetMessage  {Str = 213}         -- "Only followers of the Dark Path can become Liches.  You have not yet chosen the path.  Return when you choose Darkness."
  7:  Exit  {}

  8:  SetMessage  {Str = 214}         -- "Having chosen the path of Light, you are not suited to become Liches.  The Ritual would reject you, and you would die a real death.  If that is what you want, you certainly don't need my help…"
  9:  Exit  {}

  10: SetMessage  {Str = 211}         --[[ "Fear not death?  I can perform the Ritual on any Wizard.  You need a Soul Jar.  Years ago the Wizards stole a shipment of Jars en route from Nighon to Deyja.  The jars are very hard to destroy, so they hid them, thinking we would never be able to find them.

Fortunately for us, dead men do indeed tell tales.  Better, in fact, than living ones--dead men never forget, never refuse to talk, and never lie.  So, we found the one who buried the Jars, and made him die.  He was very cooperative after his death, and said he hid them somewhere in the Walls of Mist for the Wizards in Celeste. 

Retrieve these jars and I will perform the Ritual on all Wizards amongst you.  The rest may become Honorary Liches, for what that's worth, in thanks for finding the extra Jars for us." ]]
  11: Set  {"QBits", Value = 48}         -- "Retrieve the lich jars from the Proving Grounds in Celeste and bring them back to Halfgild Wynac in the Pit."
  12: SetNPCTopic  {NPC = 49, Index = 0, Event = 97}         -- "Halfgild Wynac" : "Lich"
end

event 97  -- "Lich"
  0:  ForPlayer  (0)
  1:  Cmp  {"Inventory", Value = 615,   jump = 3}         -- "Lich Jar"
  2:  GoTo  {jump = 11}

  3:  ForPlayer  (1)
  4:  Cmp  {"Inventory", Value = 615,   jump = 6}         -- "Lich Jar"
  5:  GoTo  {jump = 11}

  6:  ForPlayer  (2)
  7:  Cmp  {"Inventory", Value = 615,   jump = 9}         -- "Lich Jar"
  8:  GoTo  {jump = 11}

  9:  ForPlayer  (3)
  10: Cmp  {"Inventory", Value = 615,   jump = 13}         -- "Lich Jar"
  11: SetMessage  {Str = 216}         -- "I have no spare Jars with which to perform the Ritual.  It is impossible for me to promote you until you return with the Jars.  Remember, each one of you must have a Jar to be Promoted."
  12: Exit  {}

  13: SetMessage  {Str = 215}         -- "Jars.  Yessss.  You have helped us greatly.  Now for the Ritual.  [The Lich draws a knife, and approaches you]  This won't hurt a bit!  [The ritual actually hurts quite a bit, and takes several hours to complete.  When it is over, the Lich speaks again]  So, now it is done.  Those among you who were Wizards are now most certainly Liches.  Those who were not, have my gratitude for returning the jars, and I will call you ""Honorary Liches"".  Remember, Liches must keep their Soul Jars with them at all times while they travel.  You cannot be separated from your Jar for long, or you will die a real death."
  14: ForPlayer  (0)
  15: Cmp  {"ClassIs", Value = const.Class.Wizard,   jump = 19}
  16: Add  {"Awards", Value = 79}         -- "Promoted to Honorary Lich"
  17: Add  {"Experience", Value = 40000}
  18: GoTo  {jump = 22}

  19: Set  {"ClassIs", Value = const.Class.Lich}
  20: Add  {"Awards", Value = 78}         -- "Promoted to Lich"
  21: Add  {"Experience", Value = 80000}
  22: ForPlayer  (1)
  23: Cmp  {"ClassIs", Value = const.Class.Wizard,   jump = 27}
  24: Add  {"Awards", Value = 79}         -- "Promoted to Honorary Lich"
  25: Add  {"Experience", Value = 40000}
  26: GoTo  {jump = 30}

  27: Set  {"ClassIs", Value = const.Class.Lich}
  28: Add  {"Awards", Value = 78}         -- "Promoted to Lich"
  29: Add  {"Experience", Value = 80000}
  30: ForPlayer  (2)
  31: Cmp  {"ClassIs", Value = const.Class.Wizard,   jump = 35}
  32: Add  {"Awards", Value = 79}         -- "Promoted to Honorary Lich"
  33: Add  {"Experience", Value = 40000}
  34: GoTo  {jump = 38}

  35: Set  {"ClassIs", Value = const.Class.Lich}
  36: Add  {"Awards", Value = 78}         -- "Promoted to Lich"
  37: Add  {"Experience", Value = 80000}
  38: ForPlayer  (3)
  39: Cmp  {"ClassIs", Value = const.Class.Wizard,   jump = 43}
  40: Add  {"Awards", Value = 79}         -- "Promoted to Honorary Lich"
  41: Add  {"Experience", Value = 40000}
  42: GoTo  {jump = 46}

  43: Set  {"ClassIs", Value = const.Class.Lich}
  44: Add  {"Awards", Value = 78}         -- "Promoted to Lich"
  45: Add  {"Experience", Value = 80000}
  46: Subtract  {"QBits", Value = 48}         -- "Retrieve the lich jars from the Proving Grounds in Celeste and bring them back to Halfgild Wynac in the Pit."
  47: Subtract  {"QBits", Value = 229}         -- Lich Jar (Empty) - I lost it
  48: Add  {"Gold", Value = 7500}
  49: Subtract  {"Reputation", Value = 10}
  50: ForPlayer  ("All")
  51: Cmp  {"Inventory", Value = 615,   jump = 53}         -- "Lich Jar"
  52: GoTo  {jump = 55}

  53: Subtract  {"Inventory", Value = 615}         -- "Lich Jar"
  54: GoTo  {jump = 51}

  55: SetNPCTopic  {NPC = 49, Index = 0, Event = 0}         -- "Halfgild Wynac"
  56: SetNPCGreeting  {NPC = 49, Greeting = 79}         -- "Halfgild Wynac" : "Why do you insist on bothering me?  [The Lich's eyes flare a hellish red for a moment] "
end

event 98  -- "Great Druid"
  0:  SetMessage  {Str = 217}         -- "Advancement as a Druid is simple.  You must visit the three ancient temples to nature we erected centuries ago and pray at their centers.  They are in Tatalia, Evenmorn Isle, and Avlee, and look like circles of stone with an altar of water in their centers.  Where exactly I will not say, but exploring the land about them is part of the process.  When you have visited all three Circles, return to me to detail your experience."
  1:  Set  {"QBits", Value = 49}         -- "Visit the three stonehenge monoliths in Tatalia, the Evenmorn Islands, and Avlee, then return to Anthony Green in the Tularean Forest."
  2:  SetNPCTopic  {NPC = 50, Index = 0, Event = 99}         -- "Anthony Green" : "Great Druid"
end

event 99  -- "Great Druid"
  0:  Cmp  {"QBits", Value = 50,   jump = 8}         -- Visited all stonehenges
  1:  Cmp  {"QBits", Value = 51,   jump = 6}         -- Visited stonehenge 1 (area 9)
  2:  Cmp  {"QBits", Value = 52,   jump = 6}         -- Visited stonehenge 2 (area 13)
  3:  Cmp  {"QBits", Value = 53,   jump = 6}         -- Visited stonehenge 3 (area 14)
  4:  SetMessage  {Str = 218}         -- "Visit the Circles, then return to me.  That is the process.  "
  5:  Exit  {}

  6:  SetMessage  {Str = 219}         -- "You've found a circle!  Very good, but you must find all three before you will be ready for promotion.  Remember, circles three, then return to me."
  7:  Exit  {}

  8:  SetMessage  {Str = 220}         -- "I have only to look into your eyes to see where you've been.  You have seen the circles, and they have left their imprint upon you.  Telling you that all Druids amongst you are now Great Druids is but a formality.  Telling the rest of you that you're now honorary Druids is showing you respect for the respect you have shown me and my faith.  "
  9:  ForPlayer  (0)
  10: Cmp  {"ClassIs", Value = const.Class.Druid,   jump = 14}
  11: Add  {"Awards", Value = 69}         -- "Promoted to Honorary Great Druid"
  12: Add  {"Experience", Value = 15000}
  13: GoTo  {jump = 17}

  14: Set  {"ClassIs", Value = const.Class.GreatDruid}
  15: Add  {"Awards", Value = 68}         -- "Promoted to Great Druid"
  16: Add  {"Experience", Value = 30000}
  17: ForPlayer  (1)
  18: Cmp  {"ClassIs", Value = const.Class.Druid,   jump = 22}
  19: Add  {"Awards", Value = 69}         -- "Promoted to Honorary Great Druid"
  20: Add  {"Experience", Value = 15000}
  21: GoTo  {jump = 25}

  22: Set  {"ClassIs", Value = const.Class.GreatDruid}
  23: Add  {"Awards", Value = 68}         -- "Promoted to Great Druid"
  24: Add  {"Experience", Value = 30000}
  25: ForPlayer  (2)
  26: Cmp  {"ClassIs", Value = const.Class.Druid,   jump = 30}
  27: Add  {"Awards", Value = 69}         -- "Promoted to Honorary Great Druid"
  28: Add  {"Experience", Value = 15000}
  29: GoTo  {jump = 33}

  30: Set  {"ClassIs", Value = const.Class.GreatDruid}
  31: Add  {"Awards", Value = 68}         -- "Promoted to Great Druid"
  32: Add  {"Experience", Value = 30000}
  33: ForPlayer  (3)
  34: Cmp  {"ClassIs", Value = const.Class.Druid,   jump = 38}
  35: Add  {"Awards", Value = 69}         -- "Promoted to Honorary Great Druid"
  36: Add  {"Experience", Value = 15000}
  37: GoTo  {jump = 41}

  38: Set  {"ClassIs", Value = const.Class.GreatDruid}
  39: Add  {"Awards", Value = 68}         -- "Promoted to Great Druid"
  40: Add  {"Experience", Value = 30000}
  41: Subtract  {"QBits", Value = 49}         -- "Visit the three stonehenge monoliths in Tatalia, the Evenmorn Islands, and Avlee, then return to Anthony Green in the Tularean Forest."
  42: Subtract  {"Reputation", Value = 5}
  43: ForPlayer  ("All")
  44: SetNPCTopic  {NPC = 50, Index = 0, Event = 100}         -- "Anthony Green" : "Arch Druid"
end

event 100  -- "Arch Druid"
  0:  Cmp  {"QBits", Value = 99,   jump = 6}         -- Chose the path of Light
  1:  Cmp  {"QBits", Value = 100,   jump = 4}         -- Chose the path of Dark
  2:  SetMessage  {Str = 222}         -- "I am dedicated to the service of the Light.  I will not promote you further until you are as dedicated as I.  Come back to me when you choose the Light."
  3:  Exit  {}

  4:  SetMessage  {Str = 223}         -- "Servants of Darkness, I am sorry I promoted you earlier.  I am ashamed I didn't notice the darkness in your souls until it was too late.  Leave me."
  5:  Exit  {}

  6:  SetMessage  {Str = 221}         --[[ "To be named an Arch Druid, you must serve the land.  I know of a service you could perform.  In the land above Stone City, where the Dwarves bury their dead, is the barrow of King Zokarr IV.  He died fighting in defense of Stone City during the invasion of Erathia by Nighon.  His remains were never recovered and still lie in those tunnels.    

Retrieve his bones and place them in his coffin in his barrow.  When you have done this, the King will rest, and so will the land.  Return to me when you've performed this service, and I will perform the Ceremony of Ascension and name you Arch Druids." ]]
  7:  Set  {"QBits", Value = 54}         -- "Retrieve the bones of the Dwarf King from the tunnels between Stone City and Nighon and place them in their proper resting place in the Barrow Downs, then return to Anthony Green in the Tularean Forest."
  8:  SetNPCTopic  {NPC = 50, Index = 0, Event = 101}         -- "Anthony Green" : "Arch Druid"
end

event 101  -- "Arch Druid"
  0:  Cmp  {"QBits", Value = 65,   jump = 3}         -- Barrow downs.   Returned the bones of the Dwarf King.  Arch Druid promo quest.
  1:  SetMessage  {Str = 225}         -- "The Service is not easy, but it needs to be done.  Remember, you must bring the bones of King Zokarr IV from where they lie in the tunnels between Stone City and Nighon to Zokarr's coffin in a secret dwarven barrow.  Only then can I perform the Ceremony of Ascension and promote you."
  2:  Exit  {}

  3:  SetMessage  {Str = 224}         --[[ "[Master Green seems beside himself with joy at your accomplishment] I felt the King's soul return to the land of the dead when you returned his bones.  The land breathed a sigh of relief--did you feel it?  

The Ceremony of Ascension is complete.  I'm happy to promote all Great Druids amongst you to Arch Druids, and all honorary Great Druids to Honorary Arch Druids.  This is a very happy day!  Your service will be remembered!" ]]
  4:  ForPlayer  (0)
  5:  Cmp  {"ClassIs", Value = const.Class.GreatDruid,   jump = 9}
  6:  Add  {"Awards", Value = 71}         -- "Promoted to Honorary Arch Druid"
  7:  Add  {"Experience", Value = 40000}
  8:  GoTo  {jump = 12}

  9:  Set  {"ClassIs", Value = const.Class.ArchDruid}
  10: Add  {"Awards", Value = 70}         -- "Promoted to Arch Druid"
  11: Add  {"Experience", Value = 80000}
  12: ForPlayer  (1)
  13: Cmp  {"ClassIs", Value = const.Class.GreatDruid,   jump = 17}
  14: Add  {"Awards", Value = 71}         -- "Promoted to Honorary Arch Druid"
  15: Add  {"Experience", Value = 40000}
  16: GoTo  {jump = 20}

  17: Set  {"ClassIs", Value = const.Class.ArchDruid}
  18: Add  {"Awards", Value = 70}         -- "Promoted to Arch Druid"
  19: Add  {"Experience", Value = 80000}
  20: ForPlayer  (2)
  21: Cmp  {"ClassIs", Value = const.Class.GreatDruid,   jump = 25}
  22: Add  {"Awards", Value = 71}         -- "Promoted to Honorary Arch Druid"
  23: Add  {"Experience", Value = 40000}
  24: GoTo  {jump = 28}

  25: Set  {"ClassIs", Value = const.Class.ArchDruid}
  26: Add  {"Awards", Value = 70}         -- "Promoted to Arch Druid"
  27: Add  {"Experience", Value = 80000}
  28: ForPlayer  (3)
  29: Cmp  {"ClassIs", Value = const.Class.GreatDruid,   jump = 33}
  30: Add  {"Awards", Value = 71}         -- "Promoted to Honorary Arch Druid"
  31: Add  {"Experience", Value = 40000}
  32: GoTo  {jump = 36}

  33: Set  {"ClassIs", Value = const.Class.ArchDruid}
  34: Add  {"Awards", Value = 70}         -- "Promoted to Arch Druid"
  35: Add  {"Experience", Value = 80000}
  36: Subtract  {"QBits", Value = 54}         -- "Retrieve the bones of the Dwarf King from the tunnels between Stone City and Nighon and place them in their proper resting place in the Barrow Downs, then return to Anthony Green in the Tularean Forest."
  37: Subtract  {"Reputation", Value = 10}
  38: ForPlayer  ("All")
  39: SetNPCTopic  {NPC = 50, Index = 0, Event = 0}         -- "Anthony Green"
  40: SetNPCGreeting  {NPC = 50, Greeting = 81}         -- "Anthony Green" : "Fortune be your friend, lords.  Do you seek my advice today?"
end

event 102  -- "Warlock"
  0:  Cmp  {"Awards", Value = 68,   jump = 4}         -- "Promoted to Great Druid"
  1:  Cmp  {"Awards", Value = 69,   jump = 4}         -- "Promoted to Honorary Great Druid"
  2:  SetMessage  {Str = 227}         -- "I would love to get you started on the way to becoming Warlocks, but nothing I can do for you will be of any use until you become Great Druids.  Return when you have achieved that level of understanding."
  3:  Exit  {}

  4:  Cmp  {"QBits", Value = 100,   jump = 10}         -- Chose the path of Dark
  5:  Cmp  {"QBits", Value = 99,   jump = 8}         -- Chose the path of Light
  6:  SetMessage  {Str = 228}         -- "Though I like to think of the Warlocks as being followers of the Path of Twilight, or Dawn, we are technically followers of the Path of Darkness.  You must be dedicated followers of Darkness before I can help you.  "
  7:  Exit  {}

  8:  SetMessage  {Str = 229}         -- "Hmmmm.  [Tor looks at you carefully]  Nope.  Can't teach you.  You chose the Path of Light.  I can smell it on you.  I can sympathize with your choice, but I know that none of our spells or rituals can promote you once you have started down that path.  Sorry."
  9:  Exit  {}

  10: SetMessage  {Str = 226}         --[[ "Becoming a Warlock for some is a simple process, and for others it is nearly impossible.  You need to find a familiar suited to your personality.  The familiar will help to focus your magical abilities and sharpen your concentration.  Sometimes a single familiar can be shared, other times not.  The magical effects will not be noticed by anyone but a Great Druid--someone who is already attuned to nature.  Now, let me see what kind of familiar you will need...[Tor picks up an elaborately carved gem and peers at you through it.  He frowns.]  Hmm.  Well, the good news is that you all need the same familiar, and when you find it, you will be very powerful.  The bad news is that you need to find a dragon familiar.  

You must find a dragon egg.  Bring them back here and I will hatch it, and cast the familiar spell.  The baby dragon will imprint to you all, and you to it.  You may be able to find an egg in a dragon cave in the Land of the Giants.  'Ware the mother, though." ]]
  11: Set  {"QBits", Value = 55}         -- "Retrieve the dragon egg from the Dragon Cave in the Land of the Giants and return it to Tor Anwyn in Mount Nighon."
  12: SetNPCTopic  {NPC = 51, Index = 0, Event = 103}         -- "Tor Anwyn" : "Warlock"
end

event 103  -- "Warlock"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 647,   jump = 4}         -- "Dragon Egg"
  2:  SetMessage  {Str = 231}         -- "You need to bring me a dragon's egg so you I can hatch your familiar.  There is no way around this.  Try looking in the Land of the Giants for a dragon cave-- perhaps there you can find an egg."
  3:  Exit  {}

  4:  SetMessage  {Str = 230}         -- "[Tor looks at you in astonishment] You really found a dragon egg!  It's been more than a century since any Warlock has both needed and found a dragon familiar!  This will go down in the history books, that's for sure!  My spell book!  I need my book!  Ah, here it is.  [Tor chants a spell from the book, then taps the egg three times.  The egg hatches, and a baby dragon crawls out of the shell]  There you are!  Awww, isn't he cute?  Congratulations!  No longer are you simple Great Druids, but Warlocks!  Of course, that's just an honorary title if you weren't a natural Great Druid to begin with, but nonetheless, something to be proud of.  "
  5:  ForPlayer  (0)
  6:  Cmp  {"ClassIs", Value = const.Class.GreatDruid,   jump = 10}
  7:  Add  {"Awards", Value = 73}         -- "Promoted to Honorary Warlock"
  8:  Add  {"Experience", Value = 40000}
  9:  GoTo  {jump = 13}

  10: Set  {"ClassIs", Value = const.Class.Warlock}
  11: Add  {"Awards", Value = 72}         -- "Promoted to Warlock"
  12: Add  {"Experience", Value = 80000}
  13: ForPlayer  (1)
  14: Cmp  {"ClassIs", Value = const.Class.GreatDruid,   jump = 18}
  15: Add  {"Awards", Value = 73}         -- "Promoted to Honorary Warlock"
  16: Add  {"Experience", Value = 40000}
  17: GoTo  {jump = 21}

  18: Set  {"ClassIs", Value = const.Class.Warlock}
  19: Add  {"Awards", Value = 72}         -- "Promoted to Warlock"
  20: Add  {"Experience", Value = 80000}
  21: ForPlayer  (2)
  22: Cmp  {"ClassIs", Value = const.Class.GreatDruid,   jump = 26}
  23: Add  {"Awards", Value = 73}         -- "Promoted to Honorary Warlock"
  24: Add  {"Experience", Value = 40000}
  25: GoTo  {jump = 29}

  26: Set  {"ClassIs", Value = const.Class.Warlock}
  27: Add  {"Awards", Value = 72}         -- "Promoted to Warlock"
  28: Add  {"Experience", Value = 80000}
  29: ForPlayer  (3)
  30: Cmp  {"ClassIs", Value = const.Class.GreatDruid,   jump = 34}
  31: Add  {"Awards", Value = 73}         -- "Promoted to Honorary Warlock"
  32: Add  {"Experience", Value = 40000}
  33: GoTo  {jump = 37}

  34: Set  {"ClassIs", Value = const.Class.Warlock}
  35: Add  {"Awards", Value = 72}         -- "Promoted to Warlock"
  36: Add  {"Experience", Value = 80000}
  37: Subtract  {"QBits", Value = 55}         -- "Retrieve the dragon egg from the Dragon Cave in the Land of the Giants and return it to Tor Anwyn in Mount Nighon."
  38: Subtract  {"Reputation", Value = 10}
  39: ForPlayer  ("All")
  40: Subtract  {"Inventory", Value = 647}         -- "Dragon Egg"
  41: Subtract  {"QBits", Value = 227}         -- Dragon Egg - I lost it
  42: SetNPCTopic  {NPC = 51, Index = 0, Event = 0}         -- "Tor Anwyn"
  43: SetNPCGreeting  {NPC = 50, Greeting = 83}         -- "Anthony Green" : "A delight and a pleasure, lords.  Have you come for business or conversation?"
  44: Set  {"NPCs", Value = 57}         -- "Baby Dragon"
end

event 104  -- "Golem Parts"
  0:  ForPlayer  ("All")

  1:  CanShowTopic.Cmp  {"QBits", Value = 73,   jump = 5}         -- Finished constructing Golem with Abbey normal head
  2:  CanShowTopic.Cmp  {"QBits", Value = 74,   jump = 5}         -- Finished constructing Golem with normal head
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}
  5:  CanShowTopic.Set  {Visible = false}
  6:  CanShowTopic.Exit  {}

  7:  Cmp  {"QBits", Value = 66,   jump = 15}         -- Placed Golem torso
  8:  Cmp  {"Inventory", Value = 639,   jump = 10}         -- "Golem chest"
  9:  GoTo  {jump = 15}

  10: Add  {"QBits", Value = 66}         -- Placed Golem torso
  11: Subtract  {"Inventory", Value = 639}         -- "Golem chest"
  12: Subtract  {"QBits", Value = 225}         -- Torso - I lost it
  13: SetMessage  {Str = 232}         -- "You prepare the torso for assembly with the rest of the parts."
  14: Exit  {}

  15: Cmp  {"QBits", Value = 67,   jump = 24}         -- Placed Golem left leg
  16: GoTo  {jump = 17}

  17: Cmp  {"Inventory", Value = 642,   jump = 19}         -- "Golem left leg"
  18: GoTo  {jump = 24}

  19: Subtract  {"Inventory", Value = 642}         -- "Golem left leg"
  20: Subtract  {"QBits", Value = 224}         -- Left leg - I lost it
  21: Add  {"QBits", Value = 67}         -- Placed Golem left leg
  22: SetMessage  {Str = 233}         -- "You prepare the left leg for assembly with the rest of the parts."
  23: Exit  {}

  24: Cmp  {"QBits", Value = 68,   jump = 33}         -- Placed Golem right leg
  25: GoTo  {jump = 26}

  26: Cmp  {"Inventory", Value = 643,   jump = 28}         -- "Golem right leg"
  27: GoTo  {jump = 33}

  28: SetMessage  {Str = 234}         -- "You prepare the right leg for assembly with the rest of the parts."
  29: Subtract  {"Inventory", Value = 643}         -- "Golem right leg"
  30: Subtract  {"QBits", Value = 223}         -- Right leg - I lost it
  31: Add  {"QBits", Value = 68}         -- Placed Golem right leg
  32: Exit  {}

  33: Cmp  {"QBits", Value = 69,   jump = 42}         -- Placed Golem left arm
  34: GoTo  {jump = 35}

  35: Cmp  {"Inventory", Value = 645,   jump = 37}         -- "Golem left arm"
  36: GoTo  {jump = 42}

  37: SetMessage  {Str = 235}         -- "You prepare the left arm for assembly with the rest of the parts."
  38: Subtract  {"Inventory", Value = 645}         -- "Golem left arm"
  39: Subtract  {"QBits", Value = 222}         -- Left arm - I lost it
  40: Add  {"QBits", Value = 69}         -- Placed Golem left arm
  41: Exit  {}

  42: Cmp  {"QBits", Value = 70,   jump = 51}         -- Placed Golem left leg
  43: GoTo  {jump = 44}

  44: Cmp  {"Inventory", Value = 644,   jump = 46}         -- "Golem right arm"
  45: GoTo  {jump = 51}

  46: SetMessage  {Str = 236}         -- "You prepare the right arm for assembly with the rest of the parts."
  47: Subtract  {"Inventory", Value = 644}         -- "Golem right arm"
  48: Subtract  {"QBits", Value = 221}         -- Right arm - I lost it
  49: Add  {"QBits", Value = 70}         -- Placed Golem left leg
  50: Exit  {}

  51: Cmp  {"QBits", Value = 71,   jump = 71}         -- Placed Golem head
  52: Cmp  {"QBits", Value = 72,   jump = 71}         -- Placed Golem Abbey normal head
  53: GoTo  {jump = 54}

  54: Cmp  {"Inventory", Value = 641,   jump = 56}         -- "Golem head"
  55: GoTo  {jump = 61}

  56: SetMessage  {Str = 237}         -- "You prepare the head for assembly with the rest of the parts."
  57: Subtract  {"Inventory", Value = 641}         -- "Golem head"
  58: Subtract  {"QBits", Value = 219}         -- Golem Head - I lost it
  59: Add  {"QBits", Value = 71}         -- Placed Golem head
  60: Exit  {}

  61: Cmp  {"QBits", Value = 71,   jump = 71}         -- Placed Golem head
  62: Cmp  {"QBits", Value = 72,   jump = 71}         -- Placed Golem Abbey normal head
  63: GoTo  {jump = 64}

  64: Cmp  {"Inventory", Value = 640,   jump = 66}         -- "Abbey Normal Golem Head"
  65: GoTo  {jump = 92}

  66: SetMessage  {Str = 238}         -- "You prepare the head (with a dent in it) for assembly with the rest of the parts."
  67: Subtract  {"Inventory", Value = 640}         -- "Abbey Normal Golem Head"
  68: Subtract  {"QBits", Value = 220}         -- Abby normal head - I lost it
  69: Add  {"QBits", Value = 72}         -- Placed Golem Abbey normal head
  70: Exit  {}

  71: Cmp  {"QBits", Value = 66,   jump = 73}         -- Placed Golem torso
  72: GoTo  {jump = 92}

  73: Cmp  {"QBits", Value = 67,   jump = 75}         -- Placed Golem left leg
  74: GoTo  {jump = 92}

  75: Cmp  {"QBits", Value = 68,   jump = 77}         -- Placed Golem right leg
  76: GoTo  {jump = 92}

  77: Cmp  {"QBits", Value = 69,   jump = 79}         -- Placed Golem left arm
  78: GoTo  {jump = 92}

  79: Cmp  {"QBits", Value = 70,   jump = 81}         -- Placed Golem left leg
  80: GoTo  {jump = 92}

  81: Cmp  {"QBits", Value = 71,   jump = 84}         -- Placed Golem head
  82: Cmp  {"QBits", Value = 72,   jump = 88}         -- Placed Golem Abbey normal head
  83: GoTo  {jump = 92}

  84: Add  {"QBits", Value = 74}         -- Finished constructing Golem with normal head
  85: SetMessage  {Str = 240}         -- "You have all the parts together!  Now you just have to return to Master Grey for the animation process."
  86: SetNPCTopic  {NPC = 56, Index = 1, Event = 0}         -- "Golem"
  87: Exit  {}

  88: Add  {"QBits", Value = 73}         -- Finished constructing Golem with Abbey normal head
  89: SetMessage  {Str = 240}         -- "You have all the parts together!  Now you just have to return to Master Grey for the animation process."
  90: SetNPCTopic  {NPC = 56, Index = 1, Event = 0}         -- "Golem"
  91: Exit  {}

  92: SetMessage  {Str = 239}         -- "You have no parts to assemble yet."
end

event 105  -- "Swap Heads"
  0:  ForPlayer  ("All")

  1:  CanShowTopic.Cmp  {"QBits", Value = 71,   jump = 5}         -- Placed Golem head
  2:  CanShowTopic.Cmp  {"QBits", Value = 72,   jump = 8}         -- Placed Golem Abbey normal head
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}
  5:  CanShowTopic.Cmp  {"Inventory", Value = 640,   jump = 11}         -- "Abbey Normal Golem Head"
  6:  CanShowTopic.Set  {Visible = false}
  7:  CanShowTopic.Exit  {}
  8:  CanShowTopic.Cmp  {"Inventory", Value = 641,   jump = 11}         -- "Golem head"
  9:  CanShowTopic.Set  {Visible = false}
  10: CanShowTopic.Exit  {}
  11: CanShowTopic.Set  {Visible = true}
  12: CanShowTopic.Exit  {}

  13: Cmp  {"Inventory", Value = 640,   jump = 17}         -- "Abbey Normal Golem Head"
  14: Cmp  {"Inventory", Value = 641,   jump = 26}         -- "Golem head"
  15: SetMessage  {Str = 243}         -- "You should not be reading this message.  This means that you somehow have triggered this event without holding the normal or Abbey normal Golem heads which, based on the preconditions for this event, is absolutely impossible.  Please tell Bryan that he lost his bet and owes Keith 5 bucks because this event doesn't work properly."
  16: Exit  {}

  17: Subtract  {"Inventory", Value = 640}         -- "Abbey Normal Golem Head"
  18: Subtract  {"QBits", Value = 220}         -- Abby normal head - I lost it
  19: ForPlayer  ("Current")
  20: Add  {"Inventory", Value = 641}         -- "Golem head"
  21: Add  {"QBits", Value = 219}         -- Golem Head - I lost it
  22: Subtract  {"QBits", Value = 71}         -- Placed Golem head
  23: Add  {"QBits", Value = 72}         -- Placed Golem Abbey normal head
  24: SetMessage  {Str = 241}         -- "You remove the normal head and replace it with the dented head."
  25: Exit  {}

  26: Subtract  {"Inventory", Value = 641}         -- "Golem head"
  27: Subtract  {"QBits", Value = 219}         -- Golem Head - I lost it
  28: ForPlayer  ("Current")
  29: Add  {"Inventory", Value = 640}         -- "Abbey Normal Golem Head"
  30: Add  {"QBits", Value = 220}         -- Abby normal head - I lost it
  31: Subtract  {"QBits", Value = 72}         -- Placed Golem Abbey normal head
  32: Add  {"QBits", Value = 71}         -- Placed Golem head
  33: SetMessage  {Str = 242}         -- "You remove the dented head and replace it with the normal head."
  34: Exit  {}
end

event 106  -- "Goblins"
  0:  Cmp  {"QBits", Value = 135,   jump = 3}         -- Player castle goblins are all dead
  1:  SetMessage  {Str = 245}         -- "I fear that talking will fail with these goblins, my lords.  May I suggest violence?"
  2:  Exit  {}

  3:  SetMessage  {Str = 244}         -- "Thank heavens you've cleaned them out!  Now we need to find a way to clean up the castle and rebuild the damaged sections.  The only people I can think of who would have the inclination and the ability to do this are the Dwarves in Stone City, located in the Barrow Downs to the south.  The entrance to Stone City lies in the center of the Barrow Downs on one of the largest hills.  "
  4:  ForPlayer  ("All")
  5:  Add  {"Experience", Value = 5000}
  6:  Subtract  {"QBits", Value = 75}         -- "Clean out Castle Harmondale and return to the Butler in the tavern, On the House, in Harmondale."
  7:  Add  {"Awards", Value = 4}         -- "Removed goblins from Castle Harmondale"
  8:  MoveNPC  {NPC = 58, HouseId = 174}         -- "Butler" -> "Throne Room"
  9:  SetNPCTopic  {NPC = 58, Index = 0, Event = 0}         -- "Butler"
  10: SetNPCGreeting  {NPC = 58, Greeting = 86}         -- "Butler" : "You rang, my lords?"
  11: Set  {"QBits", Value = 146}         -- "Talk to the Dwarves in Stone City in the Barrow Downs to find a way to repair Castle Harmondale."
end

event 107  -- "Rescue Dwarves"
  0:  SetMessage  {Str = 246}         --[[ "So…The new lords of Harmondale I have before me.  Not impressed.  Doubt other kings think much of you either.  Hrmph.  Probably get yourselves killed soon.  But maybe there's more than meets the eye here.  Yes.  Maybe you can do something for me, and I for you.  Medusas have taken my mines in eastern Bracada.  Turned a few of my people to stone.  Dangerous monsters, don't want to lose more lives on a rescue.  Ok to lose yours though.  

Take this elixir and pour it on the statues.  Wake them up.  Then I will fix up your castle.  Give you respect.  Go now, and beware the griffins in Bracada.  " ]]
  1:  Set  {"QBits", Value = 76}         -- "Rescue the dwarves from the Red Dwarf Mines and return to the Dwarf King in Stone City in the Barrow Downs."
  2:  Subtract  {"QBits", Value = 146}         -- "Talk to the Dwarves in Stone City in the Barrow Downs to find a way to repair Castle Harmondale."
  3:  Add  {"Inventory", Value = 629}         -- "Elixir"
  4:  Add  {"QBits", Value = 230}         -- Elixir - I lost it
  5:  SetNPCTopic  {NPC = 59, Index = 0, Event = 108}         -- "Hothfarr IX" : "Rescue Dwarves"
end

event 108  -- "Rescue Dwarves"
  0:  Cmp  {"NPCs", Value = 60,   jump = 2}         -- "Drathen Keldin"
  1:  GoTo  {jump = 13}

  2:  Cmp  {"NPCs", Value = 61,   jump = 4}         -- "Jaycen Keldin"
  3:  GoTo  {jump = 13}

  4:  Cmp  {"NPCs", Value = 62,   jump = 6}         -- "Yarrow Keldin"
  5:  GoTo  {jump = 13}

  6:  Cmp  {"NPCs", Value = 63,   jump = 8}         -- "Fausil Keldin"
  7:  GoTo  {jump = 13}

  8:  Cmp  {"NPCs", Value = 64,   jump = 10}         -- "Red Keldin"
  9:  GoTo  {jump = 13}

  10: Cmp  {"NPCs", Value = 65,   jump = 12}         -- "Thom Keldin"
  11: GoTo  {jump = 13}

  12: Cmp  {"NPCs", Value = 66,   jump = 15}         -- "Arvin Keldin"
  13: SetMessage  {Str = 248}         -- "Back again, eh?  Your part of the bargain isn't finished.  No help 'til you're done.  "
  14: Exit  {}

  15: SetMessage  {Str = 247}         --[[ "Welcome back, Lords of Harmondale!  Now, I will help you.  My engineer will work for you.  Fix up your castle.  You have my thanks.  You are welcome here forever.

Hmmph.  One more thing.  Your work has interested the other courts.  They will send ambassadors to you now--check your throne room.  Watch your back, my friends." ]]
  16: Add  {"History4", Value = 0}
  17: Add  {"Gold", Value = 5000}
  18: Subtract  {"QBits", Value = 76}         -- "Rescue the dwarves from the Red Dwarf Mines and return to the Dwarf King in Stone City in the Barrow Downs."
  19: Subtract  {"Reputation", Value = 5}
  20: ForPlayer  ("All")
  21: Add  {"Awards", Value = 5}         -- "Rescued the dwarves from the Red Dwarf Mine"
  22: Add  {"Experience", Value = 12500}
  23: Subtract  {"Inventory", Value = 629}         -- "Elixir"
  24: Subtract  {"QBits", Value = 230}         -- Elixir - I lost it
  25: Set  {"QBits", Value = 98}         -- Built Castle to Level 2 (rescued dwarf guy)
  26: Subtract  {"NPCs", Value = 60}         -- "Drathen Keldin"
  27: MoveNPC  {NPC = 60, HouseId = 999}         -- "Drathen Keldin" -> not found!
  28: MoveNPC  {NPC = 67, HouseId = 174}         -- "Ellen Rockway" -> "Throne Room"
  29: MoveNPC  {NPC = 68, HouseId = 174}         -- "Alain Hani" -> "Throne Room"
  30: Subtract  {"NPCs", Value = 61}         -- "Jaycen Keldin"
  31: Subtract  {"NPCs", Value = 62}         -- "Yarrow Keldin"
  32: Subtract  {"NPCs", Value = 63}         -- "Fausil Keldin"
  33: Subtract  {"NPCs", Value = 64}         -- "Red Keldin"
  34: Subtract  {"NPCs", Value = 65}         -- "Thom Keldin"
  35: Subtract  {"NPCs", Value = 66}         -- "Arvin Keldin"
  36: SetNPCTopic  {NPC = 59, Index = 0, Event = 0}         -- "Hothfarr IX"
  37: SetNPCGreeting  {NPC = 59, Greeting = 88}         -- "Hothfarr IX" : "Welcome, Harmondale!  Stone city is at your disposal."
end

event 109  -- "Use Elixir"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 674,   jump = 3}         -- "Elixir Placeholder"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  Set  {"NPCs", Value = 60}         -- "Drathen Keldin"
  6:  SetNPCGreeting  {NPC = 60, Greeting = 89}         -- "Drathen Keldin" : "Thanks for rescuing me.  I am at your service."
end

event 110  -- "Use Elixir"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 674,   jump = 3}         -- "Elixir Placeholder"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  Set  {"NPCs", Value = 61}         -- "Jaycen Keldin"
  6:  SetNPCGreeting  {NPC = 61, Greeting = 90}         -- "Jaycen Keldin" : "Thanks for rescuing me.  I owe you my life."
end

event 111  -- "Use Elixir"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 674,   jump = 3}         -- "Elixir Placeholder"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  Set  {"NPCs", Value = 62}         -- "Yarrow Keldin"
  6:  SetNPCGreeting  {NPC = 62, Greeting = 90}         -- "Yarrow Keldin" : "Thanks for rescuing me.  I owe you my life."
end

event 112  -- "Use Elixir"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 674,   jump = 3}         -- "Elixir Placeholder"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  Set  {"NPCs", Value = 63}         -- "Fausil Keldin"
  6:  SetNPCGreeting  {NPC = 63, Greeting = 90}         -- "Fausil Keldin" : "Thanks for rescuing me.  I owe you my life."
end

event 113  -- "Use Elixir"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 674,   jump = 3}         -- "Elixir Placeholder"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  Set  {"NPCs", Value = 64}         -- "Red Keldin"
  6:  SetNPCGreeting  {NPC = 64, Greeting = 90}         -- "Red Keldin" : "Thanks for rescuing me.  I owe you my life."
end

event 114  -- "Use Elixir"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 674,   jump = 3}         -- "Elixir Placeholder"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  Set  {"NPCs", Value = 65}         -- "Thom Keldin"
  6:  SetNPCGreeting  {NPC = 65, Greeting = 90}         -- "Thom Keldin" : "Thanks for rescuing me.  I owe you my life."
end

event 115  -- "Use Elixir"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 674,   jump = 3}         -- "Elixir Placeholder"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  Set  {"NPCs", Value = 66}         -- "Arvin Keldin"
  6:  SetNPCGreeting  {NPC = 66, Greeting = 90}         -- "Arvin Keldin" : "Thanks for rescuing me.  I owe you my life."
end

event 116  -- "An invitation…"
  0:  Cmp  {"QBits", Value = 88,   jump = 3}         -- Talked to Catherine
  1:  SetMessage  {Str = 249}         -- "Your Queen wishes to speak with you as soon as possible.  Since the War, she has taken up residence at Gryphonheart Castle in Steadwick.  This is strictly business--whenever new lords assume their office she meets with them to make sure there are no misunderstandings.  Queen Catherine is particularly interested in you, and has told me she wishes to employ your services."
  2:  Exit  {}

  3:  Cmp  {"QBits", Value = 81,   jump = 6}         -- Gave Loren to Catherine
  4:  SetMessage  {Str = 250}         -- "I've received word that you met with the Queen.  I hope it went well."
  5:  Exit  {}

  6:  SetMessage  {Str = 251}         -- "The queen is very pleased with you!  The rescue operation went well, and Loren can no longer be held as a bargaining chip for that wicked King Parson!  When the current Harmondale conflict is over, I'm sure the Queen will reward you for your aid."
end

event 117  -- "False Plans"
  0:  CanShowTopic.Cmp  {"QBits", Value = 82,   jump = 3}         -- Gave false plans to elfking (betray)
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 252}         -- "The Queen tells me your loyalty is very strong.  You did the right thing when you informed the Queen of the treachery King Parson was plotting.  And I'll tell you this:  Your loyalty is not only strong, but it is well placed.  Harmondale is the rightful province of Erathia, despite Elvish claims to the contrary.  Your work for us helps to ensure that Harmondale will forever be in the hands of Humans."
end

event 118  -- "Artifact"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 634,   jump = 3}         -- "Gryphonheart's Trumpet"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 253}         -- "[Lady Ellen gasps in delight] You have Gryphonheart's Trumpet!  This is wonderful!  When it disappeared from the strongbox, we thought it had been stolen by the enemy!  Thank you for bringing it back to us!"
  6:  Add  {"Gold", Value = 5000}
  7:  ForPlayer  ("All")
  8:  Add  {"Experience", Value = 10000}
  9:  Subtract  {"Inventory", Value = 634}         -- "Gryphonheart's Trumpet"
  10: Subtract  {"QBits", Value = 79}         -- "Retrieve Gryphonheart's Trumpet from the battle in the Tularean Forest and return it to whichever side you choose."
  11: Set  {"QBits", Value = 84}         -- Gave artifact to humans
  12: SetNPCTopic  {NPC = 67, Index = 2, Event = 0}         -- "Ellen Rockway"
end

event 119  -- "Betrayed?"
  0:  CanShowTopic.Cmp  {"QBits", Value = 83,   jump = 3}         -- Gave false Loren to Catherine (betray)
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 255}         -- "I've learned from Queen Catherine that you betrayed us with the old false prisoner trick.  [Lady Ellen curtsies respectfully] Your skills in the art of deception are formidable.  I will be sure not to be tricked so easily by your sincere manner again."
end

event 120  -- "An invitation…"
  0:  Cmp  {"QBits", Value = 89,   jump = 3}         -- Talked to elfking
  1:  SetMessage  {Str = 256}         -- "Though Avlee is not currently in charge of Harmondale, my King, Eldrich Parson of Avlee, lays claim to this territory as our rightful domain.  The reasons are complicated, but boil down to the simple fact that Erathia stole our land in the Timber Wars many years ago, and we will not give up until we have it back.  My King wishes to speak with you.  Please travel to Pierpont in the Tularean Forest and meet with him.  We will make it worth your while."
  2:  Exit  {}

  3:  Cmp  {"QBits", Value = 80,   jump = 6}         -- Gave plans to elfking
  4:  SetMessage  {Str = 257}         -- "Messengers have informed me of your visit with my King.  I hope you can see now why we are the rightful rulers of Harmondale.  "
  5:  Exit  {}

  6:  SetMessage  {Str = 258}         -- "I've heard of your daring infiltration of Fort Riverstride, and I am impressed!  Our strategists are analyzing the plans now, and they say the information will be very useful in any assault they mount against the Fort.  You have Avlee's gratitude!"
end

event 121  -- "False Prisoner"
  0:  CanShowTopic.Cmp  {"QBits", Value = 83,   jump = 3}         -- Gave false Loren to Catherine (betray)
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 259}         -- "Word from Court is that you rejected a request from Erathia to break that spy Loren Steel out of prison.  Not only that, you helped us plant a false prisoner who has been feeding them misinformation ever since he got there.  Avlee is in your debt!"
end

event 122  -- "Artifact"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 634,   jump = 3}         -- "Gryphonheart's Trumpet"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 260}         -- "You have Gryphonheart's Trumpet!  Excellent!  We lost track of it during the raid, and were afraid that one of the Erathians got away with it.  Thank you very much for your help!"
  6:  Add  {"Gold", Value = 5000}
  7:  ForPlayer  ("All")
  8:  Add  {"Experience", Value = 10000}
  9:  Subtract  {"Inventory", Value = 634}         -- "Gryphonheart's Trumpet"
  10: Subtract  {"QBits", Value = 79}         -- "Retrieve Gryphonheart's Trumpet from the battle in the Tularean Forest and return it to whichever side you choose."
  11: Set  {"QBits", Value = 85}         -- Gave artifact to elves
  12: SetNPCTopic  {NPC = 68, Index = 2, Event = 0}         -- "Alain Hani"
end

event 123  -- "Betrayed?"
  0:  CanShowTopic.Cmp  {"QBits", Value = 82,   jump = 3}         -- Gave false plans to elfking (betray)
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 262}         -- "I've received a warning from my superiors regarding your delivery of falsified plans from Erathia.  The King is not amused. And there was some concern that you had more treachery in store for us.  [Alain smiles, true to his profession] All's fair in love and war, so it's all water under the bridge, eh?  Yes, all is forgotten.  [The ambassador chuckles heartily].  "
end

event 124  -- "Prisoner of War"
  0:  SetMessage  {Str = 263}         --[[ "[Queen Catherine inclines her head regally] You are the lot that won Lord Markham's silly contest, I see.  I must admit I had little faith until the Dwarf King recognized you as the rightful rulers of Harmondale.  You must have done something to win his respect, or he would have nothing to do with you.  I'm still not sure what he saw in you, but perhaps there really is something of substance here.  We shall see.

Maybe you can do something for me that would make me think I should let you keep your new titles.  Recently, a valuable...agent of mine was arrested in the Tularean Forest for merely doing his job.  They're keeping him in a cave somewhere outside of Pierpont.  His name is Loren Steel, and they are threatening to execute him if certain unacceptable conditions are not met in 28 days.  Return with him before then and you will win respect, gold, and gratitude." ]]
  1:  SetNPCTopic  {NPC = 69, Index = 0, Event = 125}         -- "Queen Catherine" : "Prisoner of War"
  2:  Add  {"QBits", Value = 78}         -- "Rescue Loren Steel from the Tularean Caves in the Tularean Forest and return him to Queen Catherine."
  3:  Add  {"QBits", Value = 88}         -- Talked to Catherine
  4:  Set  {"Counter1", Value = 0}
end

event 125  -- "Prisoner of War"
  0:  Cmp  {"Counter1", Value = 672,   jump = 5}
  1:  Cmp  {"NPCs", Value = 71,   jump = 13}         -- "Loren Steel"
  2:  Cmp  {"NPCs", Value = 72,   jump = 27}         -- "Fake Loren"
  3:  SetMessage  {Str = 265}         -- "Loren's life is on the line.  I cannot give into the Elvish demands, or many more lives will be lost.  Please hurry.  I'm sure Avlee will execute him on schedule."
  4:  Exit  {}

  5:  SetMessage  {Str = 273}         -- "Well, time ran out for poor Loren.  He was executed for espionage by Avlee on schedule.  Don't bother with the rescue.  He's gone."
  6:  SetNPCTopic  {NPC = 69, Index = 0, Event = 0}         -- "Queen Catherine"
  7:  SetNPCTopic  {NPC = 69, Index = 1, Event = 0}         -- "Queen Catherine"
  8:  Subtract  {"NPCs", Value = 71}         -- "Loren Steel"
  9:  Subtract  {"NPCs", Value = 72}         -- "Fake Loren"
  10: Subtract  {"QBits", Value = 78}         -- "Rescue Loren Steel from the Tularean Caves in the Tularean Forest and return him to Queen Catherine."
  11: Subtract  {"QBits", Value = 95}         -- "Return the Loren imposter to Queen Catherine in Castle Gryphonheart in Erathia."
  12: Exit  {}

  13: SetMessage  {Str = 264}         -- "[Catherine stands and smiles] Good job!  You've really solved a terrible dilemma for me.  [Catherine turns to Loren and shakes his hand] Loren.  It's good to meet you at last.  Since everyone knows who you are now, you're not much good to me as a spy, but I would like to offer you a job in the Royal Diplomatic Corps.  Please give it some thought.  As for our heroes, you have my thanks.  My purser will credit your bank account with 5000 gold pieces for your services.   "
  14: Subtract  {"QBits", Value = 78}         -- "Rescue Loren Steel from the Tularean Caves in the Tularean Forest and return him to Queen Catherine."
  15: Add  {"QBits", Value = 81}         -- Gave Loren to Catherine
  16: ForPlayer  ("Current")
  17: Add  {"BankGold", Value = 5000}
  18: Subtract  {"Reputation", Value = 5}
  19: ForPlayer  ("All")
  20: Add  {"Experience", Value = 10000}
  21: Add  {"Awards", Value = 6}         -- "Rescued Loren Steel"
  22: SetNPCTopic  {NPC = 69, Index = 0, Event = 0}         -- "Queen Catherine"
  23: SetNPCTopic  {NPC = 69, Index = 1, Event = 0}         -- "Queen Catherine"
  24: Subtract  {"NPCs", Value = 71}         -- "Loren Steel"
  25: Subtract  {"NPCs", Value = 72}         -- "Fake Loren"
  26: Exit  {}

  27: SetMessage  {Str = 266}         -- "[Catherine stands and smiles] Good job!  You've really solved a terrible dilemma for me.  [Catherine turns to the false Loren and shakes his hand] Loren.  It's good to meet you at last.  Since everyone knows who you are now, you're not much good to me as a spy, but I would like to offer you a job in the Royal Diplomatic Corps.  Please give it some thought.  As for our heroes, you have my thanks.   "
  28: Subtract  {"QBits", Value = 78}         -- "Rescue Loren Steel from the Tularean Caves in the Tularean Forest and return him to Queen Catherine."
  29: Subtract  {"QBits", Value = 95}         -- "Return the Loren imposter to Queen Catherine in Castle Gryphonheart in Erathia."
  30: Add  {"QBits", Value = 83}         -- Gave false Loren to Catherine (betray)
  31: Add  {"Reputation", Value = 5}
  32: ForPlayer  ("All")
  33: Add  {"Awards", Value = 7}         -- "Gave Loren Imposter to Catherine"
  34: SetNPCTopic  {NPC = 69, Index = 0, Event = 0}         -- "Queen Catherine"
  35: SetNPCTopic  {NPC = 69, Index = 1, Event = 0}         -- "Queen Catherine"
  36: Subtract  {"NPCs", Value = 71}         -- "Loren Steel"
  37: Subtract  {"NPCs", Value = 72}         -- "Fake Loren"
end

event 126  -- "Here's a fake prisoner…"
  0:  CanShowTopic.Cmp  {"NPCs", Value = 72,   jump = 3}         -- "Fake Loren"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 267}         -- "[The Queen's eyes narrow] What's this?  You're admitting to treachery?  How noble.  Guards!  Off with their heads!"
  6:  Subtract  {"NPCs", Value = 71}         -- "Loren Steel"
  7:  Subtract  {"NPCs", Value = 72}         -- "Fake Loren"
  8:  Subtract  {"QBits", Value = 78}         -- "Rescue Loren Steel from the Tularean Caves in the Tularean Forest and return him to Queen Catherine."
  9:  Subtract  {"QBits", Value = 95}         -- "Return the Loren imposter to Queen Catherine in Castle Gryphonheart in Erathia."
  10: Set  {"QBits", Value = 90}         -- Told Catherine about fake prisoner
  11: SetNPCTopic  {NPC = 69, Index = 0, Event = 0}         -- "Queen Catherine"
  12: SetNPCTopic  {NPC = 69, Index = 1, Event = 0}         -- "Queen Catherine"
  13: ForPlayer  (0)
  14: Set  {"Dead", Value = 1}
  15: ForPlayer  (1)
  16: Set  {"Dead", Value = 1}
  17: ForPlayer  (2)
  18: Set  {"Dead", Value = 1}
  19: ForPlayer  (3)
  20: Set  {"Dead", Value = 1}
end

event 127  -- "Riverstride plans"
  0:  CanShowTopic.Cmp  {"QBits", Value = 77,   jump = 3}         -- "Retrieve plans from Fort Riverstride and return them to Eldrich Parson in Castle Navan in the Tularean Forest."
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Cmp  {"QBits", Value = 92,   jump = 7}         -- Fort Riverstride.  Opened chest with plans
  4:  CanShowTopic.Cmp  {"Counter2", Value = 672,   jump = 7}
  5:  CanShowTopic.Set  {Visible = true}
  6:  CanShowTopic.Exit  {}
  7:  CanShowTopic.Set  {Visible = false}
  8:  CanShowTopic.Exit  {}

  9:  SetMessage  {Str = 268}         -- "King Parson asked you to steal the floor plan to Fort Riverstride?  Hmmm.  [Catherine turns to one of her advisors] Have some false plans of Fort Riverstride drawn up.  Make it painful.  [She turns back to you] If it's plans he wants, it's plans he'll get.  Give these plans to the King.  I'm sure he'll be grateful.  Make sure you don't let him know they're fake.  [After awhile the advisor returns with the plans and gives them to you]  You'll need to get the plans back to him on time, of course.  I'm sure he plans to attack us soon."
  10: SetNPCTopic  {NPC = 69, Index = 2, Event = 128}         -- "Queen Catherine" : "Riverstride plans"
  11: Set  {"QBits", Value = 94}         -- "Give false Riverstride plans to Eldrich Parson in Castle Navan in the Tularean Forest."
  12: Add  {"Inventory", Value = 706}         -- "False Riverstride Plans"
  13: Subtract  {"QBits", Value = 77}         -- "Retrieve plans from Fort Riverstride and return them to Eldrich Parson in Castle Navan in the Tularean Forest."
end

event 128  -- "Riverstride plans"
  0:  Cmp  {"QBits", Value = 82,   jump = 22}         -- Gave false plans to elfking (betray)
  1:  Cmp  {"QBits", Value = 91,   jump = 13}         -- Told Elfking about fake plans
  2:  Cmp  {"Counter2", Value = 672,   jump = 5}
  3:  SetMessage  {Str = 270}         -- "You have to get the plans to him before he attacks Riverstride.  If you don't, they won't lead his forces into all the traps we've prepared for them.  So hurry up and deliver those plans!  I'm counting on you!"
  4:  Exit  {}

  5:  SetMessage  {Str = 274}         -- "King Parson is beyond the date when he could have used those false papers.  Don't bother taking them to him--it doesn't matter anymore.  "
  6:  Subtract  {"Inventory", Value = 706}         -- "False Riverstride Plans"
  7:  Subtract  {"Inventory", Value = 705}         -- "Riverstride Plans"
  8:  SetNPCTopic  {NPC = 69, Index = 2, Event = 0}         -- "Queen Catherine"
  9:  SetNPCTopic  {NPC = 69, Index = 3, Event = 0}         -- "Queen Catherine"
  10: Subtract  {"QBits", Value = 94}         -- "Give false Riverstride plans to Eldrich Parson in Castle Navan in the Tularean Forest."
  11: Subtract  {"QBits", Value = 77}         -- "Retrieve plans from Fort Riverstride and return them to Eldrich Parson in Castle Navan in the Tularean Forest."
  12: Exit  {}

  13: SetMessage  {Str = 271}         -- "You told the king the plans were fake?!?  [The Queen puts her hand on her head, jaw agape] I have never seen such incompetence in all my life!  Astounding!  Get out of my sight!  Just go!  "
  14: ForPlayer  ("All")
  15: Subtract  {"Inventory", Value = 706}         -- "False Riverstride Plans"
  16: Subtract  {"Inventory", Value = 705}         -- "Riverstride Plans"
  17: Subtract  {"QBits", Value = 94}         -- "Give false Riverstride plans to Eldrich Parson in Castle Navan in the Tularean Forest."
  18: Subtract  {"QBits", Value = 77}         -- "Retrieve plans from Fort Riverstride and return them to Eldrich Parson in Castle Navan in the Tularean Forest."
  19: SetNPCTopic  {NPC = 69, Index = 2, Event = 0}         -- "Queen Catherine"
  20: SetNPCTopic  {NPC = 69, Index = 3, Event = 0}         -- "Queen Catherine"
  21: Exit  {}

  22: SetMessage  {Str = 269}         -- "He took the plans?  Excellent!  I'll have the Riverstride commander roll out the red carpet for them.  As for you, I've instructed my purser to deposit 5,000 gold pieces in your account."
  23: Subtract  {"Reputation", Value = 5}
  24: Subtract  {"QBits", Value = 94}         -- "Give false Riverstride plans to Eldrich Parson in Castle Navan in the Tularean Forest."
  25: Subtract  {"QBits", Value = 77}         -- "Retrieve plans from Fort Riverstride and return them to Eldrich Parson in Castle Navan in the Tularean Forest."
  26: ForPlayer  ("All")
  27: Add  {"Experience", Value = 5000}
  28: ForPlayer  ("Current")
  29: Add  {"BankGold", Value = 5000}
  30: SetNPCTopic  {NPC = 69, Index = 2, Event = 0}         -- "Queen Catherine"
  31: SetNPCTopic  {NPC = 69, Index = 3, Event = 0}         -- "Queen Catherine"
end

event 129  -- "We stole the plans…"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 705,   jump = 3}         -- "Riverstride Plans"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 272}         -- "[The Queen raises her eyebrows with interest as you tell her how you infiltrated her fort, stole secret plans, and killed many of her guards while in the service of a foreign king] I wish I could truthfully say this is the most shocking treason I have ever witnessed, but unfortunately, it's not.  Nonetheless...Guards!  Off with their heads!"
  6:  Subtract  {"Inventory", Value = 705}         -- "Riverstride Plans"
  7:  Subtract  {"Inventory", Value = 706}         -- "False Riverstride Plans"
  8:  Subtract  {"QBits", Value = 77}         -- "Retrieve plans from Fort Riverstride and return them to Eldrich Parson in Castle Navan in the Tularean Forest."
  9:  Subtract  {"QBits", Value = 94}         -- "Give false Riverstride plans to Eldrich Parson in Castle Navan in the Tularean Forest."
  10: SetNPCTopic  {NPC = 69, Index = 2, Event = 0}         -- "Queen Catherine"
  11: SetNPCTopic  {NPC = 69, Index = 3, Event = 0}         -- "Queen Catherine"
  12: ForPlayer  (0)
  13: Set  {"Dead", Value = 1}
  14: ForPlayer  (1)
  15: Set  {"Dead", Value = 1}
  16: ForPlayer  (2)
  17: Set  {"Dead", Value = 1}
  18: ForPlayer  (3)
  19: Set  {"Dead", Value = 1}
end

event 130  -- "Artifact"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 634,   jump = 3}         -- "Gryphonheart's Trumpet"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 287}         -- "My loyal subjects!  You were the ones who took the Trumpet!  Good work.  We thought it lost forever.  Once again, my purser will deposit gold in your account.  5,000 gold, to be exact."
  6:  Add  {"BankGold", Value = 5000}
  7:  Subtract  {"Reputation", Value = 5}
  8:  ForPlayer  ("All")
  9:  Add  {"Experience", Value = 10000}
  10: Subtract  {"Inventory", Value = 634}         -- "Gryphonheart's Trumpet"
  11: Subtract  {"QBits", Value = 79}         -- "Retrieve Gryphonheart's Trumpet from the battle in the Tularean Forest and return it to whichever side you choose."
  12: Set  {"QBits", Value = 84}         -- Gave artifact to humans
  13: SetNPCTopic  {NPC = 69, Index = 4, Event = 0}         -- "Queen Catherine"
end

event 131  -- "Riverstride plans"
  0:  SetMessage  {Str = 275}         --[[ "Welcome.  I understand you've been appointed Lords of Harmondale by that idiot Markham.  You know, I WILL restore Avlee's rule over Harmondale--the only question is whether you are with me, or against me.  If you're with me, I will ensure that you retain your post.  Against me, and I will have done with you once my armies occupy your lands.  

[King Parson smiles affably] So, of course you're with me!  You just need to prove it.  Like a famous leader once said:  Trust, but verify!  Words to live by.  What I want right now is the plans to Fort Riverstride.  It's a huge fort that stands between your lands and Erathia proper.  You can't miss the thing.  Sneak in there and get me those plans.  If you can do this, I will be in your debt.  Not only that, there's a substantial gold reward as well.  If the plans are to be any use to me at all, though, I need them delivered to me within a month." ]]
  1:  SetNPCTopic  {NPC = 70, Index = 0, Event = 132}         -- "ElfKing" : "Riverstride plans"
  2:  Add  {"QBits", Value = 77}         -- "Retrieve plans from Fort Riverstride and return them to Eldrich Parson in Castle Navan in the Tularean Forest."
  3:  Add  {"QBits", Value = 89}         -- Talked to elfking
  4:  Set  {"Counter2", Value = 0}
end

event 132  -- "Riverstride plans"
  0:  Cmp  {"Counter2", Value = 672,   jump = 6}
  1:  ForPlayer  ("All")
  2:  Cmp  {"Inventory", Value = 705,   jump = 14}         -- "Riverstride Plans"
  3:  Cmp  {"Inventory", Value = 706,   jump = 29}         -- "False Riverstride Plans"
  4:  SetMessage  {Str = 277}         -- "I really do need those plans soon.  If you take too long, I'll have to prepare my attack without the plans."
  5:  Exit  {}

  6:  SetMessage  {Str = 285}         -- "The time where I could have used those plans is over.  Thanks for any efforts you may have put into finding them, but I no longer need the plans."
  7:  SetNPCTopic  {NPC = 70, Index = 0, Event = 0}         -- "ElfKing"
  8:  SetNPCTopic  {NPC = 70, Index = 1, Event = 0}         -- "ElfKing"
  9:  Subtract  {"Inventory", Value = 705}         -- "Riverstride Plans"
  10: Subtract  {"Inventory", Value = 706}         -- "False Riverstride Plans"
  11: Subtract  {"QBits", Value = 77}         -- "Retrieve plans from Fort Riverstride and return them to Eldrich Parson in Castle Navan in the Tularean Forest."
  12: Subtract  {"QBits", Value = 94}         -- "Give false Riverstride plans to Eldrich Parson in Castle Navan in the Tularean Forest."
  13: Exit  {}

  14: SetMessage  {Str = 276}         -- "[The King smiles broadly as you hand him the plans]  Thank you!  These will be VERY useful.  My factor will deposit 5,000 gold pieces in your bank account for services rendered.  When we finally win this round against Erathia, I will not forget you."
  15: Subtract  {"QBits", Value = 77}         -- "Retrieve plans from Fort Riverstride and return them to Eldrich Parson in Castle Navan in the Tularean Forest."
  16: Subtract  {"QBits", Value = 94}         -- "Give false Riverstride plans to Eldrich Parson in Castle Navan in the Tularean Forest."
  17: Add  {"QBits", Value = 80}         -- Gave plans to elfking
  18: ForPlayer  ("Current")
  19: Add  {"BankGold", Value = 5000}
  20: Subtract  {"Reputation", Value = 5}
  21: ForPlayer  ("All")
  22: Add  {"Experience", Value = 10000}
  23: Add  {"Awards", Value = 8}         -- "Retrieved Fort Riverstride Plans"
  24: SetNPCTopic  {NPC = 70, Index = 0, Event = 0}         -- "ElfKing"
  25: SetNPCTopic  {NPC = 70, Index = 1, Event = 0}         -- "ElfKing"
  26: Subtract  {"Inventory", Value = 705}         -- "Riverstride Plans"
  27: Subtract  {"Inventory", Value = 706}         -- "False Riverstride Plans"
  28: Exit  {}

  29: SetMessage  {Str = 278}         -- "[The King smiles broadly as you hand him the false plans.  Sucker! ]  Thank you!  These will be VERY useful.  When we finally win this round against Erathia, I will not forget you."
  30: Subtract  {"QBits", Value = 77}         -- "Retrieve plans from Fort Riverstride and return them to Eldrich Parson in Castle Navan in the Tularean Forest."
  31: Subtract  {"QBits", Value = 94}         -- "Give false Riverstride plans to Eldrich Parson in Castle Navan in the Tularean Forest."
  32: Add  {"QBits", Value = 82}         -- Gave false plans to elfking (betray)
  33: Add  {"Reputation", Value = 5}
  34: ForPlayer  ("All")
  35: Add  {"Awards", Value = 9}         -- "Gave false plans to Elfking"
  36: SetNPCTopic  {NPC = 70, Index = 0, Event = 0}         -- "ElfKing"
  37: SetNPCTopic  {NPC = 70, Index = 1, Event = 0}         -- "ElfKing"
  38: Subtract  {"Inventory", Value = 706}         -- "False Riverstride Plans"
  39: Subtract  {"Inventory", Value = 705}         -- "Riverstride Plans"
end

event 133  -- "Here's fake plans…"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 706,   jump = 3}         -- "False Riverstride Plans"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 279}         -- "What do you mean, these plans are false?  So you admit to plotting against me?  [The King throws up his hands in disgust] Guards!  Take these traitors to the courtyard and execute them!"
  6:  Subtract  {"Inventory", Value = 706}         -- "False Riverstride Plans"
  7:  Subtract  {"Inventory", Value = 705}         -- "Riverstride Plans"
  8:  Subtract  {"QBits", Value = 94}         -- "Give false Riverstride plans to Eldrich Parson in Castle Navan in the Tularean Forest."
  9:  Subtract  {"QBits", Value = 77}         -- "Retrieve plans from Fort Riverstride and return them to Eldrich Parson in Castle Navan in the Tularean Forest."
  10: Set  {"QBits", Value = 91}         -- Told Elfking about fake plans
  11: SetNPCTopic  {NPC = 70, Index = 0, Event = 0}         -- "ElfKing"
  12: SetNPCTopic  {NPC = 70, Index = 1, Event = 0}         -- "ElfKing"
  13: ForPlayer  (0)
  14: Set  {"Dead", Value = 1}
  15: ForPlayer  (1)
  16: Set  {"Dead", Value = 1}
  17: ForPlayer  (2)
  18: Set  {"Dead", Value = 1}
  19: ForPlayer  (3)
  20: Set  {"Dead", Value = 1}
end

event 134  -- "Prison Break"
  0:  CanShowTopic.Cmp  {"QBits", Value = 78,   jump = 3}         -- "Rescue Loren Steel from the Tularean Caves in the Tularean Forest and return him to Queen Catherine."
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Cmp  {"QBits", Value = 93,   jump = 7}         -- Tularean Caves.  Got Loren
  4:  CanShowTopic.Cmp  {"Counter1", Value = 672,   jump = 7}
  5:  CanShowTopic.Set  {Visible = true}
  6:  CanShowTopic.Exit  {}
  7:  CanShowTopic.Set  {Visible = false}
  8:  CanShowTopic.Exit  {}

  9:  SetMessage  {Str = 280}         -- "The wily queen moves against me, eh?  [The King frowns in thought, then brightens] I have an idea!  I know someone who looks just like that spy she wants you to rescue.  Bring my man with you and deliver him to the Queen.  She's never met him, and won't know the difference.  His 'inside information' will encourage her to make mistakes.  [The King takes a moment to summon the imposter]  Be careful not to tip your hand.  It wouldn't do for her to discover our little plan.  "
  10: SetNPCTopic  {NPC = 70, Index = 2, Event = 135}         -- "ElfKing" : "Prison Break"
  11: Set  {"QBits", Value = 95}         -- "Return the Loren imposter to Queen Catherine in Castle Gryphonheart in Erathia."
  12: Set  {"NPCs", Value = 72}         -- "Fake Loren"
  13: Subtract  {"QBits", Value = 78}         -- "Rescue Loren Steel from the Tularean Caves in the Tularean Forest and return him to Queen Catherine."
end

event 135  -- "Prison Break"
  0:  Cmp  {"QBits", Value = 83,   jump = 21}         -- Gave false Loren to Catherine (betray)
  1:  Cmp  {"QBits", Value = 90,   jump = 13}         -- Told Catherine about fake prisoner
  2:  Cmp  {"Counter1", Value = 672,   jump = 5}
  3:  SetMessage  {Str = 282}         -- "It's important to get the imposter to the Queen before Mr. Steel's scheduled execution.  After all, you can't rescue Mr. Steel if everyone knows I've executed him.  And she'll become suspicious if I stay the execution.  I've never stayed one before."
  4:  Exit  {}

  5:  SetMessage  {Str = 286}         -- "The execution date for Loren Steel has passed.  Don't bother bringing the imposter to the Queen--she'll be too suspicious for our ruse to succeed.  He'll be leaving you now."
  6:  Subtract  {"NPCs", Value = 72}         -- "Fake Loren"
  7:  Subtract  {"NPCs", Value = 71}         -- "Loren Steel"
  8:  SetNPCTopic  {NPC = 70, Index = 2, Event = 0}         -- "ElfKing"
  9:  SetNPCTopic  {NPC = 70, Index = 3, Event = 0}         -- "ElfKing"
  10: Subtract  {"QBits", Value = 95}         -- "Return the Loren imposter to Queen Catherine in Castle Gryphonheart in Erathia."
  11: Subtract  {"QBits", Value = 78}         -- "Rescue Loren Steel from the Tularean Caves in the Tularean Forest and return him to Queen Catherine."
  12: Exit  {}

  13: SetMessage  {Str = 283}         -- "You told Queen Catherine about the imposter?!? I can't believe my ears!  Why did you do it?  Why?  [The King stands and points at the door] Get out!"
  14: ForPlayer  ("All")
  15: Subtract  {"NPCs", Value = 72}         -- "Fake Loren"
  16: Subtract  {"NPCs", Value = 71}         -- "Loren Steel"
  17: Subtract  {"QBits", Value = 95}         -- "Return the Loren imposter to Queen Catherine in Castle Gryphonheart in Erathia."
  18: SetNPCTopic  {NPC = 70, Index = 2, Event = 0}         -- "ElfKing"
  19: SetNPCTopic  {NPC = 70, Index = 3, Event = 0}         -- "ElfKing"
  20: Exit  {}

  21: SetMessage  {Str = 281}         -- "The imposter has infiltrated her military and diplomatic advisors' ranks, and will cause plenty of damage before he's discovered, I'm sure.  Thank you for your help! My factor will deposit 5000 gold into your account at the bank."
  22: Subtract  {"QBits", Value = 95}         -- "Return the Loren imposter to Queen Catherine in Castle Gryphonheart in Erathia."
  23: Subtract  {"Reputation", Value = 5}
  24: ForPlayer  ("All")
  25: Add  {"Experience", Value = 5000}
  26: ForPlayer  ("Current")
  27: Add  {"BankGold", Value = 5000}
  28: SetNPCTopic  {NPC = 70, Index = 2, Event = 0}         -- "ElfKing"
  29: SetNPCTopic  {NPC = 70, Index = 3, Event = 0}         -- "ElfKing"
end

event 136  -- "We rescued Loren!.."
  0:  CanShowTopic.Cmp  {"NPCs", Value = 71,   jump = 3}         -- "Loren Steel"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 284}         -- "[The king is silent while you detail your crimes against Avlee, then smiles and spreads his hands once you've finished] Well!  I suppose that story speaks for itself, doesn't it?  Guards!  Take these traitors to the courtyard and execute them!"
  6:  Subtract  {"NPCs", Value = 71}         -- "Loren Steel"
  7:  Subtract  {"NPCs", Value = 72}         -- "Fake Loren"
  8:  Subtract  {"QBits", Value = 78}         -- "Rescue Loren Steel from the Tularean Caves in the Tularean Forest and return him to Queen Catherine."
  9:  Subtract  {"QBits", Value = 95}         -- "Return the Loren imposter to Queen Catherine in Castle Gryphonheart in Erathia."
  10: SetNPCTopic  {NPC = 70, Index = 2, Event = 0}         -- "ElfKing"
  11: SetNPCTopic  {NPC = 70, Index = 3, Event = 0}         -- "ElfKing"
  12: ForPlayer  (0)
  13: Set  {"Dead", Value = 1}
  14: ForPlayer  (1)
  15: Set  {"Dead", Value = 1}
  16: ForPlayer  (2)
  17: Set  {"Dead", Value = 1}
  18: ForPlayer  (3)
  19: Set  {"Dead", Value = 1}
end

event 137  -- "Artifact"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 634,   jump = 3}         -- "Gryphonheart's Trumpet"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 288}         -- "Ah, the Trumpet!  You captured it!  We weren't sure how things turned out when news of the human raid reached us.  Thank you again, my friends.  My factor will deposit 5,000 gold in your account for your services."
  6:  Add  {"BankGold", Value = 5000}
  7:  Subtract  {"Reputation", Value = 5}
  8:  ForPlayer  ("All")
  9:  Add  {"Experience", Value = 10000}
  10: Subtract  {"Inventory", Value = 634}         -- "Gryphonheart's Trumpet"
  11: Subtract  {"QBits", Value = 79}         -- "Retrieve Gryphonheart's Trumpet from the battle in the Tularean Forest and return it to whichever side you choose."
  12: Set  {"QBits", Value = 85}         -- Gave artifact to elves
  13: SetNPCTopic  {NPC = 70, Index = 4, Event = 0}         -- "ElfKing"
end

event 138  -- "Hint"
  0:  Cmp  {"QBits", Value = 98,   jump = 3}         -- Built Castle to Level 2 (rescued dwarf guy)
  1:  SetMessage  {Str = 289}         --[[ "If there is one piece of advice I could give you, it would be to fix your castle.  I don't know how you're going to find the gold and workers to do it, as only wealthy nobles and kings can afford such large scale projects.  I suppose it's the old chicken and egg question...you must appear noble to gain wealth and respect, but you must have wealth and respect in order to appear noble.  

In any event, if you expect to be lords of Harmondale for more than a few months, you need to find a way to prove you're not just lucky peasants.  You must prove that you're fit to rule." ]]
  2:  Exit  {}

  3:  SetMessage  {Str = 290}         --[[ "Once again, the Human kingdom of Erathia and the Elvish kingdom of Harmondale are fighting.  As the local Judge, it has fallen to me to patch up their differences and bring the two sides to the negotiating table.  The two sides are so evenly matched that either could prevail.  [The judge leans closer to you, lowering his voice] And I'll tell you something else--I don't much care anymore who wins.  They are like children fighting over a toy.  Neither really wants Harmondale--they just want to deny it to the other.  

So, you're on your own.  Whatever actions you take now in support of one side or another could really make a difference.  Just remember that they couldn't possibly care less what happens to you or who rules in Harmondale.  Protect yourselves and your people first.  We didn't have this conversation." ]]
  4:  Exit  {}
end

event 140  -- "Artifact"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 634,   jump = 3}         -- "Gryphonheart's Trumpet"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  ForPlayer  ("All")
  6:  Cmp  {"Inventory", Value = 634,   jump = 8}         -- "Gryphonheart's Trumpet"
  7:  Exit  {}

  8:  SetMessage  {Str = 291}         -- "You were wise to return the Trumpet to me.  Now I can use it to help shore up the weak side in this conflict and promote peace.  Thank you.  "
  9:  Set  {"QBits", Value = 147}         -- Gave artifact to arbiter
  10: Add  {"Experience", Value = 12500}
  11: Subtract  {"Inventory", Value = 634}         -- "Gryphonheart's Trumpet"
  12: Subtract  {"QBits", Value = 79}         -- "Retrieve Gryphonheart's Trumpet from the battle in the Tularean Forest and return it to whichever side you choose."
  13: SetNPCTopic  {NPC = 74, Index = 2, Event = 0}         -- "Judge Grey"
end

event 141  -- "I choose you!"
  0:  Subtract  {"NPCs", Value = 77}         -- "Judge Fairweather"
  1:  MoveNPC  {NPC = 77, HouseId = 112}         -- "Judge Fairweather" -> "Familiar Place"
  2:  SetNPCGreeting  {NPC = 77, Greeting = 104}         --[[ "Judge Fairweather" : "No decision yet?  Why do you waver in the face of what is clearly the moral choice?  Think about it:

Choosing me puts an end to the war quickly.  Many people will have you to thank for saving their lives.

You will be allying with Bracada, and rejecting Deyja.  All the Light has to offer will be yours to learn.

Most importantly, you will be CHOOSING THE PATH OF LIGHT.  This choice is permanent, and cannot be withdrawn." ]]
  3:  SetNPCGreeting  {NPC = 78, Greeting = 102}         -- "Judge Sleen" : "We need to go to Judge Grey's old house in Harmondale.  Only then can I start my new job and begin to ""sort out this mess"".  [Heh!]"
  4:  Set  {"NPCs", Value = 78}         -- "Judge Sleen"
  5:  SetMessage  {Str = 292}         -- "A wise decision.  You won't regret this--believe me.  I knew you were going to make this decision, and my bags are already packed and ready to go.  All you need to do now is get me to my new home, and I'll take care of the rest."
  6:  SetNPCTopic  {NPC = 78, Index = 0, Event = 0}         -- "Judge Sleen"
  7:  SetNPCTopic  {NPC = 77, Index = 0, Event = 143}         -- "Judge Fairweather" : "I choose you!"
end

event 142  -- "Hint"
  0:  ForPlayer  ("All")
  1:  Cmp  {"QBits", Value = 110,   jump = 4}         -- Finished Necro Proving Grounds
  2:  SetMessage  {Str = 293}         -- "Your first order of business is to talk to Lord Ironfist and complete his 'mission.'  Once your ability and loyalty are proven, you will be allowed to help in more…interesting… ways."
  3:  Exit  {}

  4:  Cmp  {"QBits", Value = 111,   jump = 7}         -- Finished Necro Task 2 - Temple of Light
  5:  SetMessage  {Str = 294}         -- "Each of the advisors to Lord Ironfist has a task for you, complete each one.  Talk to Kastore, Dark Shade, and Maaximus for more information.  The completion of these tasks is vital for our future."
  6:  Exit  {}

  7:  Cmp  {"QBits", Value = 112,   jump = 10}         -- Finished Necro Task 3 - Soul Jars
  8:  SetMessage  {Str = 294}         -- "Each of the advisors to Lord Ironfist has a task for you, complete each one.  Talk to Kastore, Dark Shade, and Maaximus for more information.  The completion of these tasks is vital for our future."
  9:  Exit  {}

  10: Cmp  {"QBits", Value = 113,   jump = 13}         -- Finished Necro Task 4 - Clanker's Lab
  11: SetMessage  {Str = 294}         -- "Each of the advisors to Lord Ironfist has a task for you, complete each one.  Talk to Kastore, Dark Shade, and Maaximus for more information.  The completion of these tasks is vital for our future."
  12: Exit  {}

  13: Cmp  {"QBits", Value = 118,   jump = 16}         -- Killed Good MM3 Person
  14: SetMessage  {Str = 295}         -- "Tolberti has a mission of great importance.  Everything we've staked so far rests on its completion.  Prepare well for his task or you will certainly fail."
  15: Exit  {}

  16: Cmp  {"QBits", Value = 120,   jump = 19}         -- Got Hive part
  17: SetMessage  {Str = 296}         -- "Xenofex and the rest of the Kreegan must be put down; go to their 'hive' in the Land of the Giants and put a stop to Xenofex and his minions once and for all."
  18: Exit  {}

  19: Cmp  {"QBits", Value = 121,   jump = 22}         -- Got the sci-fi part
  20: SetMessage  {Str = 297}         -- "You will need to visit the craft that brought Kastore and his men to Erathia to continue.  Go west of Avlee, and make sure to be properly outfitted."
  21: Exit  {}

  22: SetMessage  {Str = 298}         -- "Bring the Oscillation Overthruster back to Kastore with all possible speed!  Every moment you dally allows a chance for failure!"
  23: Exit  {}
end

event 143  -- "I choose you!"
  0:  Subtract  {"NPCs", Value = 78}         -- "Judge Sleen"
  1:  MoveNPC  {NPC = 78, HouseId = 111}         -- "Judge Sleen" -> "The Snobbish Goblin"
  2:  SetNPCGreeting  {NPC = 78, Greeting = 101}         --[[ "Judge Sleen" : "Still considering your choice, I see.  Let me remind you of what's at stake:  [The Ambassador holds up a finger]

The length of the war--The longer it lasts, the better off we'll all be.  Erathia and Avlee will be weaker, and unable to interfere in our affairs.

You will be allying with us.  There are things we can teach you...

Most importantly, YOU WILL CHOOSE THE PATH OF DARKNESS.  This choice cannot be withdrawn." ]]
  3:  SetNPCGreeting  {NPC = 77, Greeting = 105}         -- "Judge Fairweather" : "We need to go to Judge Grey's old house in Harmondale.  Only then can I start my new job and put this horrible war to an end."
  4:  Set  {"NPCs", Value = 77}         -- "Judge Fairweather"
  5:  SetMessage  {Str = 292}         -- "A wise decision.  You won't regret this--believe me.  I knew you were going to make this decision, and my bags are already packed and ready to go.  All you need to do now is get me to my new home, and I'll take care of the rest."
  6:  SetNPCTopic  {NPC = 77, Index = 0, Event = 0}         -- "Judge Fairweather"
  7:  SetNPCTopic  {NPC = 78, Index = 0, Event = 141}         -- "Judge Sleen" : "I choose you!"
end

event 144  -- "Hint"
  0:  ForPlayer  ("All")
  1:  Cmp  {"QBits", Value = 114,   jump = 4}         -- Finished Wizard Proving Grounds
  2:  SetMessage  {Str = 300}         -- "First, you need to speak to Gavin Magnus in Celeste and complete his training.  After you have proven your ability and loyalty you will learn more about your role in the future of Erathia."
  3:  Exit  {}

  4:  Cmp  {"QBits", Value = 115,   jump = 7}         -- Finished Wizard Task 2 - Temple of Dark
  5:  SetMessage  {Str = 301}         -- "Each of Gavin's advisors has a task for you.  Talk to Resurectra, Sir Caneghem, and Crag Hack for more information.  Do not fail in these missions- in them rests the balance of the future."
  6:  Exit  {}

  7:  Cmp  {"QBits", Value = 116,   jump = 10}         -- Finished Wizard Task 3 - Wine Cellar
  8:  SetMessage  {Str = 301}         -- "Each of Gavin's advisors has a task for you.  Talk to Resurectra, Sir Caneghem, and Crag Hack for more information.  Do not fail in these missions- in them rests the balance of the future."
  9:  Exit  {}

  10: Cmp  {"QBits", Value = 117,   jump = 13}         -- Finished Wizard Task 4 - Soul Jars
  11: SetMessage  {Str = 301}         -- "Each of Gavin's advisors has a task for you.  Talk to Resurectra, Sir Caneghem, and Crag Hack for more information.  Do not fail in these missions- in them rests the balance of the future."
  12: Exit  {}

  13: Cmp  {"QBits", Value = 119,   jump = 16}         -- Killed Evil MM3 Person
  14: SetMessage  {Str = 302}         -- "Robert the Wise has a regrettable, but necessary, mission for you to complete.  For any of our plans to continue, this mission must succeed.  Prepare most carefully for the task, or you invite certain failure."
  15: Exit  {}

  16: Cmp  {"QBits", Value = 120,   jump = 19}         -- Got Hive part
  17: SetMessage  {Str = 303}         -- "The Kreegan, the Devils, and their leader Xenofex must be destroyed completely for the plan to have any long-term benefit.  You will find their 'hive' in the Land of the Giants."
  18: Exit  {}

  19: Cmp  {"QBits", Value = 121,   jump = 22}         -- Got the sci-fi part
  20: SetMessage  {Str = 304}         -- "To the west of Avlee lies the craft that Resurectra and her associates used to come to Erathia.  Visit the ship and retrieve the Oscillation Overthruster to insure our victory.  Make sure to be properly outfitted for the journey."
  21: Exit  {}

  22: SetMessage  {Str = 305}         -- "Bring the Oscillation Overthruster back to Resurectra immediately!  Every moment wastes valuable time!"
  23: Exit  {}
end

event 145  -- "Proving Grounds"
  0:  SetMessage  {Str = 306}         -- "The Test involves entering the 'front door' of the Walls of Mist, and exiting through the 'back door'.  I use the word 'door' loosely--you'll see when you get there.  You will not need your weapons.  You will fail the test if you kill any creature in the Walls of Mist.  If you can complete this task, you will be given membership in the Guild of Light. Good luck."
  1:  Set  {"QBits", Value = 101}         -- "Complete the Walls of Mist without killing a single opponent and return to Gavin Magnus in Castle Lambent in Celeste."
  2:  Subtract  {"QBits", Value = 152}         -- "Enter Celeste from the grand teleporter in the Bracada Desert, then talk to Gavin Magnus in Castle Lambent in Celeste."
  3:  SetNPCTopic  {NPC = 79, Index = 0, Event = 146}         -- "Gavin Magnus" : "Proving Grounds"
end

event 146  -- "Proving Grounds"
  0:  Cmp  {"QBits", Value = 102,   jump = 3}         -- Completed Proving Grounds without killing a single creature
  1:  SetMessage  {Str = 308}         -- "Remember, you must enter through the front door of the Walls of Mist, and exit through the back door.  You must not kill any creatures in the Walls of Mist.  When you have done this, return to me."
  2:  Exit  {}

  3:  SetMessage  {Str = 307}         -- "You passed the Test!  That's quite an achievement--few succeed as quickly as you did.  My advisors are now eager to speak to  you; they can be found in the four houses on the eastern side of Celeste.  Once again, congratulations!"
  4:  Subtract  {"QBits", Value = 101}         -- "Complete the Walls of Mist without killing a single opponent and return to Gavin Magnus in Castle Lambent in Celeste."
  5:  SetNPCTopic  {NPC = 79, Index = 0, Event = 0}         -- "Gavin Magnus"
  6:  Add  {"History10", Value = 0}
  7:  ForPlayer  ("All")
  8:  Add  {"Experience", Value = 50000}
  9:  Add  {"QBits", Value = 114}         -- Finished Wizard Proving Grounds
  10: Add  {"Awards", Value = 46}         -- "Completed Wizard Proving Grounds"
  11: SetNPCGreeting  {NPC = 79, Greeting = 108}         -- "Gavin Magnus" : "Welcome back, my friends.  My advisors are anxious to speak with you.  "
  12: MoveNPC  {NPC = 80, HouseId = 425}         -- "Resurectra" -> "Hostel"
  13: MoveNPC  {NPC = 81, HouseId = 426}         -- "Crag Hack" -> "Hostel"
  14: MoveNPC  {NPC = 82, HouseId = 427}         -- "Sir Caneghem" -> "Hostel"
  15: MoveNPC  {NPC = 83, HouseId = 428}         -- "Robert the Wise" -> "Hostel"
  16: SetNPCGreeting  {NPC = 80, Greeting = 111}         -- "Resurectra" : "Always a pleasure to see you, Lords."
  17: SetNPCGreeting  {NPC = 81, Greeting = 114}         -- "Crag Hack" : "It's good to see you again, lords.  I hope all is well with you and your realm."
  18: SetNPCGreeting  {NPC = 82, Greeting = 117}         -- "Sir Caneghem" : "Ah, welcome back my lords.  I hope all is well."
  19: SetNPCGreeting  {NPC = 83, Greeting = 120}         -- "Robert the Wise" : "I'm happy you're still alive and working for the Light.  Come and see me when you've finished my friend's tasks."
  20: Add  {"Awards", Value = 59}         -- "Joined the Light Guild"
end

event 147  -- "Temple of the Dark"
  0:  CanShowTopic.Cmp  {"QBits", Value = 114,   jump = 3}         -- Finished Wizard Proving Grounds
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 309}         -- "We need your help retrieving half of a key to a very important place from our enemies, the Necromancers.  Like us, they have enshrined their half of the key in their highest temple--The Temple of the Dark.  I'm under no illusions this will be easy.  Take your time and act when you're prepared.  Also, bring our half of the key to us, as well.  It is enshrined in the Temple of the Light.  Since you're our ally, no one should trouble you when you go there to fetch the key.  By the same token, please don't harm any of them, either."
  6:  Set  {"QBits", Value = 103}         -- "Retrieve the altar piece from the Temple of Light in Celeste and the Temple of Dark in the Pit and return them to Resurectra in Castle Lambent in Celeste."
  7:  SetNPCTopic  {NPC = 80, Index = 0, Event = 148}         -- "Resurectra" : "Temple of the Dark"
end

event 148  -- "Temple of the Dark"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 676,   jump = 7}         -- "Altar Piece"
  2:  Cmp  {"Inventory", Value = 677,   jump = 5}         -- "Altar Piece"
  3:  SetMessage  {Str = 310}         -- "No key halves yet, I see.  Well, take your time.  It must be done eventually, and sooner is better than later, but later is better than being chained to an altar and sacrificed by the High Priest of the Dark in one of their bloody rituals.  Just bring back both halves of the key from the temples of Dark and Light, and try not to get yourselves killed doing it."
  4:  Exit  {}

  5:  SetMessage  {Str = 312}         -- "Good work on retrieving their half of the key, but you still need ours.  It is located in the Temple of the Light here in Celeste."
  6:  Exit  {}

  7:  Cmp  {"Inventory", Value = 677,   jump = 10}         -- "Altar Piece"
  8:  SetMessage  {Str = 311}         -- "Well, I'm glad you found our half of the key, but you still need their half.  Hold onto it until you get the other half.  When you have both halves, return to me.  I will make them whole."
  9:  Exit  {}

  10: SetMessage  {Str = 313}         -- "I knew you could do it!  Never doubted you for a second!  [You hand her the key halves, and she joins them by running a finger along the crack between them.  It mends before your eyes, good as new] Finally!  One piece of the plan is in place.  Your assistance has been invaluable.  We are already in your debt, and I expect we'll be even deeper in debt before our plan comes to fruition.  So have faith in us awhile longer--the future we're planning will astound you!"
  11: Subtract  {"Inventory", Value = 676}         -- "Altar Piece"
  12: Subtract  {"Inventory", Value = 677}         -- "Altar Piece"
  13: Subtract  {"QBits", Value = 232}         -- Altar Piece (Good) - I lost it
  14: Subtract  {"QBits", Value = 233}         -- Altar Piece (Evil) - I lost it
  15: Add  {"History12", Value = 0}
  16: Add  {"Experience", Value = 50000}
  17: SetNPCTopic  {NPC = 80, Index = 0, Event = 0}         -- "Resurectra"
  18: Subtract  {"QBits", Value = 103}         -- "Retrieve the altar piece from the Temple of Light in Celeste and the Temple of Dark in the Pit and return them to Resurectra in Castle Lambent in Celeste."
  19: Set  {"QBits", Value = 115}         -- Finished Wizard Task 2 - Temple of Dark
  20: Set  {"Awards", Value = 47}         -- "Retrieved Both Temple Pieces"
  21: SetNPCGreeting  {NPC = 80, Greeting = 112}         -- "Resurectra" : "Always a pleasure to see you, Lords."
  22: ForPlayer  ("Current")
  23: Subtract  {"Reputation", Value = 5}
end

event 149  -- "Strike the Devils"
  0:  CanShowTopic.Cmp  {"QBits", Value = 119,   jump = 3}         -- Killed Evil MM3 Person
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 314}         --[[ "Our plans rapidly approach their conclusion, but there is a hitch.  The Kreegan--also known as the Devils, or the Demons, must be destroyed before we finish our plans.  They represent a terrible threat, and though they do little but lick their wounds today, will one day regain their strength and devastate the world.  If anything we do is to have lasting effect, we must first destroy these monsters for once and for all.

You are strong, but not strong enough to defeat the devils on your own.  They are vulnerable to the brand of magic most commonly wielded by the Necromancers, and less so by our own Wizards.  It is imperative that you infiltrate the Devil's base and kill their leader Xenofex.  That should end their threat to this world for some time.  The Warlocks have dug a tunnel from their volcano to the Land of the Giants-- the land the Devils claim as their own.  Perhaps you can use that." ]]
  6:  Set  {"QBits", Value = 104}         -- "Go to Colony Zod in the Land of the Giants and slay Xenofex then return to Resurectra in Castle Lambent in Celeste."
  7:  SetNPCTopic  {NPC = 80, Index = 1, Event = 150}         -- "Resurectra" : "Strike the Devils"
end

event 150  -- "Strike the Devils"
  0:  Cmp  {"QBits", Value = 105,   jump = 3}         -- Slayed Xenofex
  1:  SetMessage  {Str = 316}         -- "I guess there's no hurry getting this job done, but we don't want the Necromancers to grow bored waiting for us to do our part and destroy the blocker.  So, please, as soon as you feel ready you must attack the Devils.  Remember that the Warlocks have dug a tunnel from their volcano to the land of the Devils.  You should be able to use that to get yourselves there."
  2:  Exit  {}

  3:  ShowMovie  {DoubleSize = 1, Name = "\"mm3 people good\" "}
  4:  SetMessage  {Str = 315}         -- "YOU ARE HEROES!!!  Your work against the devils was masterful!  And the rescue of King Roland was as delightful as it was unexpected.  History will never forget your names for doing what you just did!  I, for one, am very proud to know you.  "
  5:  Add  {"Gold", Value = 50000}
  6:  Subtract  {"Reputation", Value = 10}
  7:  ForPlayer  ("All")
  8:  Add  {"Experience", Value = 500000}
  9:  Subtract  {"QBits", Value = 104}         -- "Go to Colony Zod in the Land of the Giants and slay Xenofex then return to Resurectra in Castle Lambent in Celeste."
  10: Set  {"QBits", Value = 120}         -- Got Hive part
  11: SetNPCTopic  {NPC = 80, Index = 1, Event = 169}         -- "Resurectra" : "Final Task"
  12: Add  {"Awards", Value = 48}         -- "Slayed Xenofex"
end

event 151  -- "Vampires"
  0:  CanShowTopic.Cmp  {"QBits", Value = 114,   jump = 3}         -- Finished Wizard Proving Grounds
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 317}         -- "Our allies in Tatalia have been complaining for some time of a mysterious presence.  There have been numerous deaths and disappearances for the last few months, and they've asked us if we knew anything about it.  I think I do.  I suspect a vampire is preying on Tatalia.  I don't have time to pursue the question myself, but to keep our allies happy, I'm asking you to please look into it.  It's possible the monster's presence has deeper implications than just bad luck for Tatalia."
  6:  Set  {"QBits", Value = 106}         -- "Investigate the Wine Cellar in Tatalia and return to Crag Hack in Castle Lambent in Celeste."
  7:  SetNPCTopic  {NPC = 81, Index = 0, Event = 152}         -- "Crag Hack" : "Vampires"
end

event 152  -- "Vampires"
  0:  Cmp  {"QBits", Value = 107,   jump = 3}         -- Slayed the vampire
  1:  SetMessage  {Str = 319}         -- "Keep looking for that Vampire.  I'm sure that's our problem, and he must be somewhere in or near Tatalia.  "
  2:  Exit  {}

  3:  SetMessage  {Str = 318}         -- "Just as I suspected!  Good work.  With the death of the Vampire, Tatalia can sleep a bit easier now.  Queen Catherine is grateful as well, and has been making moves to further strengthen the ties between Bracada and Erathia."
  4:  Add  {"Gold", Value = 20000}
  5:  Add  {"History13", Value = 0}
  6:  Subtract  {"Reputation", Value = 5}
  7:  ForPlayer  ("All")
  8:  Add  {"Experience", Value = 50000}
  9:  Add  {"Awards", Value = 49}         -- "Solved the Mystery of the Wine Cellar"
  10: SetNPCTopic  {NPC = 81, Index = 0, Event = 0}         -- "Crag Hack"
  11: SetNPCGreeting  {NPC = 81, Greeting = 115}         -- "Crag Hack" : "It's good to see you again, lords.  I hope all is well with you and your realm."
  12: Subtract  {"QBits", Value = 106}         -- "Investigate the Wine Cellar in Tatalia and return to Crag Hack in Castle Lambent in Celeste."
  13: Add  {"QBits", Value = 116}         -- Finished Wizard Task 3 - Wine Cellar
end

event 153  -- "Soul Jars"
  0:  CanShowTopic.Cmp  {"QBits", Value = 114,   jump = 3}         -- Finished Wizard Proving Grounds
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 320}         -- "The plan involves stealing the soul jars the Necromancers rely on to prolong their miserable lives.  They have them hidden somewhere in their Guild Castle, and are probably not prepared for the kind of small scale assault you people are so good at.  A quick strike--in and out--should do the trick.  Don't hang around the castle too long, or reinforcements will arrive, and try to get it right the first time, or they will permanently double their patrols.  Once you have the soul jars, bring them back here so we can dispose of them properly."
  6:  Set  {"QBits", Value = 108}         -- "Retrieve the Case of Soul Jars from Castle Gloaming in the Pit and return to Sir Caneghem in Celeste."
  7:  SetNPCTopic  {NPC = 82, Index = 0, Event = 154}         -- "Sir Caneghem" : "Soul Jars"
end

event 154  -- "Soul Jars"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 602,   jump = 4}         -- "Case of Soul Jars"
  2:  SetMessage  {Str = 322}         -- "Be well prepared when you go for the jars.  Their security won't be so lax if you have to retreat and return.  "
  3:  Exit  {}

  4:  SetMessage  {Str = 321}         -- "[Sir Caneghem looks at the jars curiously, as though observing a poisonous snake behind glass] So these are soul jars.  I expected something more…impressive, I suppose.  Good job!  [he takes the case of jars] I will make sure these jars are never seen again."
  5:  Subtract  {"Inventory", Value = 602}         -- "Case of Soul Jars"
  6:  Subtract  {"QBits", Value = 231}         -- Lich Jar Case - I lost it
  7:  Add  {"History11", Value = 0}
  8:  Add  {"Experience", Value = 50000}
  9:  Subtract  {"QBits", Value = 108}         -- "Retrieve the Case of Soul Jars from Castle Gloaming in the Pit and return to Sir Caneghem in Celeste."
  10: Add  {"QBits", Value = 117}         -- Finished Wizard Task 4 - Soul Jars
  11: SetNPCTopic  {NPC = 82, Index = 0, Event = 0}         -- "Sir Caneghem"
  12: SetNPCGreeting  {NPC = 82, Greeting = 118}         -- "Sir Caneghem" : "Ah, welcome back my lords.  I hope all is well."
  13: Add  {"Awards", Value = 80}         -- "Retrieved Soul Jars"
  14: ForPlayer  ("Current")
  15: Subtract  {"Reputation", Value = 5}
  16: SetNPCGreeting  {NPC = 88, Greeting = 136}         -- "Archibald Ironfist" : "Back for more target practice?  You know, if you wait long enough, my people will regenerate.  Bigger challenge then."
  17: MoveNPC  {NPC = 88, HouseId = 0}         -- "Archibald Ironfist"
  18: SetNPCTopic  {NPC = 88, Index = 1, Event = 0}         -- "Archibald Ironfist"
end

event 155  -- "Tolberti"
  0:  CanShowTopic.Cmp  {"QBits", Value = 114,   jump = 3}         -- Finished Wizard Proving Grounds
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Cmp  {"QBits", Value = 115,   jump = 6}         -- Finished Wizard Task 2 - Temple of Dark
  4:  CanShowTopic.Set  {Visible = false}
  5:  CanShowTopic.Exit  {}
  6:  CanShowTopic.Cmp  {"QBits", Value = 116,   jump = 9}         -- Finished Wizard Task 3 - Wine Cellar
  7:  CanShowTopic.Set  {Visible = false}
  8:  CanShowTopic.Exit  {}
  9:  CanShowTopic.Cmp  {"QBits", Value = 117,   jump = 12}         -- Finished Wizard Task 4 - Soul Jars
  10: CanShowTopic.Set  {Visible = false}
  11: CanShowTopic.Exit  {}
  12: CanShowTopic.Set  {Visible = true}
  13: CanShowTopic.Exit  {}

  14: SetMessage  {Str = 323}         -- "Our counterparts, the former advisors to Archibald, each carry a token called a command cube on their person that we absolutely must acquire to complete the Goal.  There is no way any of them will part with their cube willingly, which means that we must get it some other way.  You will have to take it from one of them, and we think the easiest would be Tolberti.  Unlike the rest of them, he disdains proper security and has taken up residence in one of the apartments in the Pit.  I need you to infiltrate the pit again and get the cube from him.  Be careful--he is well armed and much tougher than he appears.  When you have the Cube, return to me.  We have but a short distance to the Goal, and all will be revealed very soon."
  15: Set  {"QBits", Value = 109}         -- "Assassinate Tolberti in his house in the Pit and return his control cube to Robert the Wise in Celeste."
  16: SetNPCTopic  {NPC = 83, Index = 0, Event = 156}         -- "Robert the Wise" : "Tolberti"
end

event 156  -- "Tolberti"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 675,   jump = 4}         -- "Control Cube"
  2:  SetMessage  {Str = 325}         -- "Keep trying to find his apartment.  Tolberti has never really believed anything bad could happen to him, and so far he's been right.  We need to prove him wrong.  Take the cube any way you can.  If you can do it without violence, fine.  If you must kill him, well, that's O.K. too.  Just get the cube."
  3:  Exit  {}

  4:  SetMessage  {Str = 324}         -- "[Robert takes the cube] Once again, you succeed!  The Goal is so close!  I know you have many questions, and I'm sure Resurectra will answer them all, after you do just one more mission for her.  You will find her with Gavin Magnus in the throne room of Castle Lambent."
  5:  Subtract  {"Inventory", Value = 675}         -- "Control Cube"
  6:  Add  {"History22", Value = 0}
  7:  Add  {"Experience", Value = 250000}
  8:  Subtract  {"QBits", Value = 109}         -- "Assassinate Tolberti in his house in the Pit and return his control cube to Robert the Wise in Celeste."
  9:  Add  {"QBits", Value = 119}         -- Killed Evil MM3 Person
  10: Add  {"Awards", Value = 81}         -- "Assassinated Tolberti"
  11: ForPlayer  (0)
  12: Cmp  {"BlasterSkill", Value = 1,   jump = 14}
  13: Set  {"BlasterSkill", Value = 1}
  14: ForPlayer  (1)
  15: Cmp  {"BlasterSkill", Value = 1,   jump = 17}
  16: Set  {"BlasterSkill", Value = 1}
  17: ForPlayer  (2)
  18: Cmp  {"BlasterSkill", Value = 1,   jump = 20}
  19: Set  {"BlasterSkill", Value = 1}
  20: ForPlayer  (3)
  21: Cmp  {"BlasterSkill", Value = 1,   jump = 23}
  22: Set  {"BlasterSkill", Value = 1}
  23: SetNPCTopic  {NPC = 80, Index = 3, Event = 223}         -- "Resurectra" : "Ancient Weapon Grandmaster"
  24: SetNPCTopic  {NPC = 81, Index = 1, Event = 222}         -- "Crag Hack" : "Ancient Weapon Master"
  25: SetNPCTopic  {NPC = 82, Index = 1, Event = 221}         -- "Sir Caneghem" : "Ancient Weapon Expert"
  26: SetNPCGreeting  {NPC = 83, Greeting = 0}         -- "Robert the Wise" : ""
  27: Subtract  {"Reputation", Value = 5}
  28: MoveNPC  {NPC = 80, HouseId = 182}         -- "Resurectra" -> "Throne Room"
  29: SetNPCTopic  {NPC = 83, Index = 0, Event = 0}         -- "Robert the Wise"
end

event 157  -- "Temple of the Light"
  0:  CanShowTopic.Cmp  {"QBits", Value = 110,   jump = 3}         -- Finished Necro Proving Grounds
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 326}         --[[ "We need your help retrieving half of a key to a very important place from our enemies, the Wizards.  Like us, they have enshrined their half of the key in their highest temple--The Temple of the Light.  It'll be a snap.  Most so called good people spend more time defending and healing themselves than delivering damage.  How can you win if you don't fight?  Anyway, take your time and act when you're prepared.  

Also, bring our half of the key to us, as well.  It is enshrined in the Temple of the Darkness.  Since you're our ally, no one should trouble you when you go there to fetch the key.  But if you feel like you need the practice, go ahead a take a whack at some of them.  They're not very important, and most of them can regenerate from even the most severe injuries.  Try it--it's alot of fun!" ]]
  6:  Set  {"QBits", Value = 122}         -- "Retrieve the altar piece from the Temple of Light in Celeste and the Temple of Dark in the Pit and return them to Kastore in the Pit."
  7:  SetNPCTopic  {NPC = 84, Index = 0, Event = 158}         -- "Kastore" : "Temple of the Light"
end

event 158  -- "Temple of the Light"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 676,   jump = 7}         -- "Altar Piece"
  2:  Cmp  {"Inventory", Value = 677,   jump = 5}         -- "Altar Piece"
  3:  SetMessage  {Str = 327}         -- "No key halves yet?  Bah!  I hope you're more competent than you seem right now!  How hard can this be?  All you have to do is burst in the front door and start shooting.  When there's no one left, you can clean their place out at your leisure.  Just hurry up and bring us both key halves."
  4:  Exit  {}

  5:  SetMessage  {Str = 328}         -- "Well, I'm glad you found our half of the key, but you still need their half.  Hold onto it until you get the other half.  When you have both halves, get back over here and I'll fix them."
  6:  Exit  {}

  7:  Cmp  {"Inventory", Value = 677,   jump = 10}         -- "Altar Piece"
  8:  SetMessage  {Str = 329}         -- "Finally!  I was beginning to wonder if you might have got yourselves killed already.  Well, no matter.  You forgot to get the key from the Temple of the Dark, so be on your way.  When you have it, return to me so I can make the two halves whole again."
  9:  Exit  {}

  10: SetMessage  {Str = 330}         -- "Excellent!  [Kastore takes the two halves of the key and bangs them together.  With a bright white flash, they join together seamlessly]  The first part of the Plan is complete.  I knew we, uh, Archibald made the right decision in trusting you!  "
  11: Subtract  {"Inventory", Value = 676}         -- "Altar Piece"
  12: Subtract  {"Inventory", Value = 677}         -- "Altar Piece"
  13: Subtract  {"QBits", Value = 232}         -- Altar Piece (Good) - I lost it
  14: Subtract  {"QBits", Value = 233}         -- Altar Piece (Evil) - I lost it
  15: Add  {"History20", Value = 0}
  16: Add  {"Experience", Value = 50000}
  17: SetNPCTopic  {NPC = 84, Index = 0, Event = 0}         -- "Kastore"
  18: Subtract  {"QBits", Value = 122}         -- "Retrieve the altar piece from the Temple of Light in Celeste and the Temple of Dark in the Pit and return them to Kastore in the Pit."
  19: Set  {"QBits", Value = 111}         -- Finished Necro Task 2 - Temple of Light
  20: Set  {"Awards", Value = 47}         -- "Retrieved Both Temple Pieces"
  21: SetNPCGreeting  {NPC = 84, Greeting = 112}         -- "Kastore" : "Always a pleasure to see you, Lords."
end

event 159  -- "Strike the Devils"
  0:  CanShowTopic.Cmp  {"QBits", Value = 118,   jump = 3}         -- Killed Good MM3 Person
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 331}         --[[ "Soon our plans will bear fruit, but there are a few details that must be handled before we are ready.  The Kreegan, also known as the Devils, share this world with us.  The only reason we're sharing is because they are weak right now.  If they ever get strong, they will try to kill every person in the world.

Anyway, it's no fun to rule a world full of dead people, so we have to kill the Devils before they kill us.  Our plan is for you to infiltrate the Devils lair and destroy their leader, Xenofex.  The warlocks of Nighon have dug a tunnel from their volcano to the Land of the Giants-- the land of the Devils.  You can probably use that tunnel to get there." ]]
  6:  Set  {"QBits", Value = 123}         -- "Go to Colony Zod in the Land of the Giants and slay Xenofex then return to Kastore in the Pit."
  7:  SetNPCTopic  {NPC = 84, Index = 1, Event = 160}         -- "Kastore" : "Strike the Devils"
end

event 160  -- "Strike the Devils"
  0:  Cmp  {"QBits", Value = 105,   jump = 3}         -- Slayed Xenofex
  1:  SetMessage  {Str = 333}         -- "Could you please hurry up with this raid against the Devils?  Archibald has promised forces, but they won't be available forever.  What's worse, the devils breed faster than rabbits.  The longer you wait, the more you'll have to fight."
  2:  Exit  {}

  3:  ShowMovie  {DoubleSize = 1, Name = "\"mm3 people evil\" "}
  4:  SetMessage  {Str = 332}         -- "THAT WAS AWESOME!  You did it!  And now the single greatest threat to our plans is gone!  We will be Kings of the World!  [Kastore throws his head back and laughs wildly] AHAHAHAHAHA!!!!! Ah ha ha. Yes.  Well, good job.  I'll even forgive you for letting that King Roland character go free--we could have used him as a bargaining chip, you know.  [he shrugs] you probably didn't have a choice, I suppose.  In any event, this is a happy day!  "
  5:  Add  {"Gold", Value = 50000}
  6:  Subtract  {"Reputation", Value = 10}
  7:  ForPlayer  ("All")
  8:  Add  {"Experience", Value = 500000}
  9:  Subtract  {"QBits", Value = 123}         -- "Go to Colony Zod in the Land of the Giants and slay Xenofex then return to Kastore in the Pit."
  10: Set  {"QBits", Value = 120}         -- Got Hive part
  11: SetNPCTopic  {NPC = 84, Index = 1, Event = 171}         -- "Kastore" : "Final Task"
  12: Add  {"Awards", Value = 48}         -- "Slayed Xenofex"
end

event 161  -- "Soul Jars"
  0:  CanShowTopic.Cmp  {"QBits", Value = 110,   jump = 3}         -- Finished Necro Proving Grounds
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 334}         -- "Archibald has asked us to find a source of soul jars for his necromancers.  These are the jars that are needed to complete the Ritual that gives them eternal life, and we're almost out.  There are far more candidates for Lichdom than we have jars, so some of our necromancers are facing the grim possibility of real death.  The makers of the jars are the Warlocks.  Go to them and convince them to give us the jars.  If they won't hand them over, take the jars by force-- I'm done negotiating prices with them."
  6:  Set  {"QBits", Value = 124}         -- "Retrieve the Case of Soul Jars from the Warlocks in Thunderfist Mountain and bring them to Maximus in the Pit."
  7:  SetNPCTopic  {NPC = 85, Index = 0, Event = 162}         -- "Maximus" : "Soul Jars"
end

event 162  -- "Soul Jars"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 602,   jump = 4}         -- "Case of Soul Jars"
  2:  SetMessage  {Str = 336}         -- "You don't have to be nice about getting the jars from them--just get the jars any way you can.  We can renegotiate peace with them if we must, just like we renegotiate the price for each purchase of soul jars."
  3:  Exit  {}

  4:  SetMessage  {Str = 335}         -- "[Maximus takes the case of jars with obvious delight] Nice work.  I won't even ask what you had to do to get them.  Success speaks for itself.  "
  5:  Subtract  {"Inventory", Value = 602}         -- "Case of Soul Jars"
  6:  Subtract  {"QBits", Value = 231}         -- Lich Jar Case - I lost it
  7:  Add  {"History18", Value = 0}
  8:  Add  {"Experience", Value = 50000}
  9:  Subtract  {"QBits", Value = 124}         -- "Retrieve the Case of Soul Jars from the Warlocks in Thunderfist Mountain and bring them to Maximus in the Pit."
  10: Add  {"QBits", Value = 112}         -- Finished Necro Task 3 - Soul Jars
  11: Add  {"Awards", Value = 80}         -- "Retrieved Soul Jars"
  12: SetNPCTopic  {NPC = 85, Index = 0, Event = 0}         -- "Maximus"
  13: SetNPCGreeting  {NPC = 85, Greeting = 127}         -- "Maximus" : "Glad to have you back, allies."
  14: ForPlayer  ("Current")
  15: Subtract  {"Reputation", Value = 5}
end

event 163  -- "Clanker's Laboratory"
  0:  CanShowTopic.Cmp  {"QBits", Value = 110,   jump = 3}         -- Finished Necro Proving Grounds
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 337}         -- "Lord Archibald has another request--the creatures that have inhabited Clanker's laboratory must be evicted--and the teleport shield brought down.  The laboratory is on an island east of Pierpont in the Tularean Forest.  Be careful--the monsters in that lab were created by Clanker himself, and some of them are much more powerful than their more common fellows elsewhere in the world.  Take whatever you like from the place.  Lord Archibald is only interested in the real estate and the laboratory equipment.  Once the shield is down, Lord Archibald will be able to begin moving necromancers and equipment inside via Lloyd's Beacon. "
  6:  Set  {"QBits", Value = 125}         -- "Destroy the magical defenses inside Clanker's Laboratory and return to Dark Shade in the Pit."
  7:  SetNPCTopic  {NPC = 86, Index = 0, Event = 164}         -- "Dark Shade" : "Clanker's Laboratory"
end

event 164  -- "Clanker's Laboratory"
  0:  Cmp  {"QBits", Value = 198,   jump = 15}         -- Archibald in Clankers Lab now
  1:  Cmp  {"QBits", Value = 126,   jump = 4}         -- Destroyed the magical defenses in Clanker's Lab
  2:  SetMessage  {Str = 339}         -- "This is a simple task--get a move on!  Once again, the laboratory on an island east of Pierpont in the Tularean Forest.  Get the shield lowered, and your part of the job is done."
  3:  Exit  {}

  4:  SetMessage  {Str = 338}         -- "It's good to see we can count on you.  So few of our allies are as reliable and capable as yourselves.  Thank you very much for your aid."
  5:  Add  {"History21", Value = 0}
  6:  Subtract  {"Reputation", Value = 5}
  7:  ForPlayer  ("All")
  8:  Add  {"Experience", Value = 50000}
  9:  Subtract  {"QBits", Value = 125}         -- "Destroy the magical defenses inside Clanker's Laboratory and return to Dark Shade in the Pit."
  10: Add  {"QBits", Value = 113}         -- Finished Necro Task 4 - Clanker's Lab
  11: SetNPCTopic  {NPC = 86, Index = 0, Event = 0}         -- "Dark Shade"
  12: SetNPCGreeting  {NPC = 86, Greeting = 130}         -- "Dark Shade" : "Welcome, allies.  Always good to have you back."
  13: Add  {"Awards", Value = 82}         -- "Cleaned out Clanker's Laboratory"
  14: Exit  {}

  15: MoveToMap  {X = 0, Y = -709, Z = 1, Direction = 512, LookAngle = 0, SpeedZ = 0, HouseId = 198, Icon = 9, Name = "D12.blv"}         -- "Clanker's Laboratory"
  16: Exit  {}
end

event 165  -- "Robert the Wise"
  0:  CanShowTopic.Cmp  {"QBits", Value = 110,   jump = 3}         -- Finished Necro Proving Grounds
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Cmp  {"QBits", Value = 111,   jump = 6}         -- Finished Necro Task 2 - Temple of Light
  4:  CanShowTopic.Set  {Visible = false}
  5:  CanShowTopic.Exit  {}
  6:  CanShowTopic.Cmp  {"QBits", Value = 112,   jump = 9}         -- Finished Necro Task 3 - Soul Jars
  7:  CanShowTopic.Set  {Visible = false}
  8:  CanShowTopic.Exit  {}
  9:  CanShowTopic.Cmp  {"QBits", Value = 113,   jump = 12}         -- Finished Necro Task 4 - Clanker's Lab
  10: CanShowTopic.Set  {Visible = false}
  11: CanShowTopic.Exit  {}
  12: CanShowTopic.Set  {Visible = true}
  13: CanShowTopic.Exit  {}

  14: SetMessage  {Str = 340}         -- "Just as Archibald has us, King Magnus of Bracada has his advisors.  And, just like us, each of them wears a small token called a command cube.  We need one of their cubes, and they're not going to just hand one over to us.  We must take one of their cubes, and we have decided it should be Robert the Wise who suffers.  One of our spies in their castle has damaged the lock to his room.  They have been lax about replacing it, so you should have no trouble going through the door.  I don't care if you kill him or not--just get the cube and return to me at once."
  15: Set  {"QBits", Value = 127}         -- "Assassinate Robert the Wise in his house in Celeste and return to Tolberti in the Pit."
  16: SetNPCTopic  {NPC = 87, Index = 0, Event = 166}         -- "Tolberti" : "Robert the Wise"
end

event 166  -- "Robert the Wise"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 675,   jump = 4}         -- "Control Cube"
  2:  SetMessage  {Str = 342}         -- "What's wrong?  Don't tell me you're losing your nerve?  He's tough, but not immortal.  You can take him!  I wouldn't have sent you on this mission if I didn't think you could handle it."
  3:  Exit  {}

  4:  SetMessage  {Str = 341}         -- "[Tolberti takes the cube] This brings us very close to completing our Plan.  I know Kastore hasn't told you exactly what the Plan is, but you'll like it, I'm sure!  I am not allowed to say much, but I can tell you your position will be much higher than simply Lords of Harmondale, you can count on that!  You will find Kastore in his place on the throne of Castle Gloaming."
  5:  Subtract  {"Inventory", Value = 675}         -- "Control Cube"
  6:  Add  {"History23", Value = 0}
  7:  Add  {"Experience", Value = 250000}
  8:  Subtract  {"QBits", Value = 127}         -- "Assassinate Robert the Wise in his house in Celeste and return to Tolberti in the Pit."
  9:  Add  {"QBits", Value = 118}         -- Killed Good MM3 Person
  10: Add  {"Awards", Value = 83}         -- "Assassinated Robert the Wise"
  11: ForPlayer  (0)
  12: Cmp  {"BlasterSkill", Value = 1,   jump = 14}
  13: Set  {"BlasterSkill", Value = 1}
  14: ForPlayer  (1)
  15: Cmp  {"BlasterSkill", Value = 1,   jump = 17}
  16: Set  {"BlasterSkill", Value = 1}
  17: ForPlayer  (2)
  18: Cmp  {"BlasterSkill", Value = 1,   jump = 20}
  19: Set  {"BlasterSkill", Value = 1}
  20: ForPlayer  (3)
  21: Cmp  {"BlasterSkill", Value = 1,   jump = 23}
  22: Set  {"BlasterSkill", Value = 1}
  23: SetNPCTopic  {NPC = 84, Index = 3, Event = 223}         -- "Kastore" : "Ancient Weapon Grandmaster"
  24: SetNPCTopic  {NPC = 85, Index = 1, Event = 222}         -- "Maximus" : "Ancient Weapon Master"
  25: SetNPCTopic  {NPC = 86, Index = 1, Event = 221}         -- "Dark Shade" : "Ancient Weapon Expert"
  26: SetNPCGreeting  {NPC = 87, Greeting = 0}         -- "Tolberti" : ""
  27: Subtract  {"Reputation", Value = 5}
  28: SetNPCTopic  {NPC = 87, Index = 0, Event = 0}         -- "Tolberti"
end

event 167  -- "Breeding Pit"
  0:  CanShowTopic.Cmp  {"QBits", Value = 99,   jump = 3}         -- Chose the path of Light
  1:  CanShowTopic.Set  {Visible = true}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 343}         -- "Yes, the test.  It's simple.  Near the center of the city is a place we call the Breeding Zone.  There's a lot of foul monsters in the pit, and they regenerate constantly.  It makes for a good source of slaves, spare parts, and target practice.  All of our necromancers are tested there when they want to rise above the level of initiate.  I'm sure you'll pass the test.  Just jump in the pit and find a way out.  Kill anything you want down there.  Show no mercy.  When you escape, crawl out of the pit and come see me again.  If you complete this, I will give you membership in the Guild of Dark. *If* you complete this..."
  6:  Set  {"QBits", Value = 128}         -- "Complete the Breeding Zone and return to Archibald in the Pit."
  7:  Subtract  {"QBits", Value = 151}         -- "Enter the Pit from the Hall of the Pit in the Deyja Moors, then talk to Archibald in Castle Gloaming in the Pit."
  8:  SetNPCTopic  {NPC = 88, Index = 0, Event = 168}         -- "Archibald Ironfist" : "Breeding Pit"
end

event 168  -- "Breeding Pit"
  0:  Cmp  {"QBits", Value = 129,   jump = 3}         -- Completed Breeding Pit.
  1:  SetMessage  {Str = 345}         -- "I am beginning to suspect my allies were right about you.  Can't you pass this simple test?  Are you too afraid, or too feeble to succeed?  Perhaps we need new allies?"
  2:  Exit  {}

  3:  SetMessage  {Str = 344}         -- "You show promise, my friends.  A fine performance.  I think it will be sufficient proof of your skill for my advisors.  They are quite eager to assign tasks to you now; they can be found in the four houses in the western side of the Pit.  And don't worry.  Rewards will follow, of course."
  4:  Add  {"History17", Value = 0}
  5:  ForPlayer  ("All")
  6:  Add  {"Experience", Value = 50000}
  7:  Add  {"Awards", Value = 84}         -- "Completed Necromancer Breeding Pit"
  8:  Subtract  {"QBits", Value = 128}         -- "Complete the Breeding Zone and return to Archibald in the Pit."
  9:  Add  {"QBits", Value = 110}         -- Finished Necro Proving Grounds
  10: SetNPCTopic  {NPC = 88, Index = 0, Event = 0}         -- "Archibald Ironfist"
  11: SetNPCGreeting  {NPC = 88, Greeting = 137}         -- "Archibald Ironfist" : "Welcome back, allies.  My advisors are eager to speak with you."
  12: MoveNPC  {NPC = 84, HouseId = 442}         -- "Kastore" -> "Hostel"
  13: MoveNPC  {NPC = 85, HouseId = 434}         -- "Maximus" -> "Hostel"
  14: MoveNPC  {NPC = 86, HouseId = 441}         -- "Dark Shade" -> "Hostel"
  15: MoveNPC  {NPC = 87, HouseId = 433}         -- "Tolberti" -> "Hostel"
  16: SetNPCGreeting  {NPC = 84, Greeting = 123}         -- "Kastore" : "[Kastore smiles] Welcome back, allies.  I trust you are well?"
  17: SetNPCGreeting  {NPC = 85, Greeting = 126}         -- "Maximus" : "Glad to have you back, allies."
  18: SetNPCGreeting  {NPC = 86, Greeting = 129}         -- "Dark Shade" : "Welcome, allies.  Always good to have you back."
  19: SetNPCGreeting  {NPC = 87, Greeting = 132}         -- "Tolberti" : "Glad you're still on our side!  Come and see me when you're done with my associates' missions."
  20: Add  {"Awards", Value = 60}         -- "Joined the Dark Guild"
end

event 169  -- "Final Task"
  0:  SetMessage  {Str = 346}         --[[ "The time has come to achieve our Goal.  The reason we have sent you on all these missions is simple:  we have been busy gathering the parts needed to open a gate to the Ancients--the ones who colonized this world ages ago.  Unfortunately, our former compatriots also seek those parts for their own dark dreams.  They wish to rebuild the Heavenly Forge from the times before the Silence, and use it to duplicate the weapons we brought with us to your world.  We have been competing with them for these parts, but at last we have what we need.  

Except for one thing.  We have been unable to find the Oscillation Overthruster on your world.  All would be lost, but there is one such device aboard the Lincoln--the vehicle that brought us to your world.  It is in the sea west of Avlee and secured against entry, even from ourselves.  Now you must wear our environment suits, enter the ship, and return with the Overthruster; you will find these suits in the chest outside this throne room.  For the suit to function properly you must not be wearing any equipment.  As for us, we must stand watch at the gate, and battle our former comrades.  " ]]
  1:  Add  {"History26", Value = 0}
  2:  Set  {"QBits", Value = 130}         -- "Go to the Lincoln in the sea west of Avlee and retrieve the Oscillation Overthruster and return it to Resurectra in Celeste."
  3:  SetNPCTopic  {NPC = 80, Index = 1, Event = 170}         -- "Resurectra" : "Final Task"
end

event 170  -- "Final Task"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 605,   jump = 4}         -- "Oscillation Overthruster"
  2:  SetMessage  {Str = 348}         -- "Don't forget you'll need the wetsuits to get to the Lincoln.  These suits are in the chest outside this throne room and the Lincoln is in the sea west of Avlee.  Return here with the Overthruster as soon as possible."
  3:  Exit  {}

  4:  Subtract  {"Inventory", Value = 605}         -- "Oscillation Overthruster"
  5:  Subtract  {"QBits", Value = 235}         -- Wetsuit - I lost it
  6:  Subtract  {"QBits", Value = 236}         -- Final Part - I lost it
  7:  Subtract  {"QBits", Value = 130}         -- "Go to the Lincoln in the sea west of Avlee and retrieve the Oscillation Overthruster and return it to Resurectra in Celeste."
  8:  SetNPCTopic  {NPC = 80, Index = 1, Event = 0}         -- "Resurectra"
  9:  ShowMovie  {DoubleSize = 1, ExitCurrentScreen = true, Name = "\"Endgame 1 Good\" "}
  10: SetNPCGroupNews  {NPCGroup = 10, NPCNews = 33}         -- "Southern Village Group in Harmondy" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  11: SetNPCGroupNews  {NPCGroup = 11, NPCNews = 33}         -- "Main village in Harmondy" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  12: SetNPCGroupNews  {NPCGroup = 12, NPCNews = 33}         -- "Tent camp in Erathia" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  13: SetNPCGroupNews  {NPCGroup = 13, NPCNews = 33}         -- "Stedwick Group" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  14: SetNPCGroupNews  {NPCGroup = 14, NPCNews = 33}         -- "Stilt city dwellers in the Tularean Forest" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  15: SetNPCGroupNews  {NPCGroup = 15, NPCNews = 33}         -- "Group walkers in the Tularean forest" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  16: SetNPCGroupNews  {NPCGroup = 16, NPCNews = 33}         -- "Northern town on Deyja" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  17: SetNPCGroupNews  {NPCGroup = 17, NPCNews = 33}         -- "Southern town in Deyja" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  18: SetNPCGroupNews  {NPCGroup = 18, NPCNews = 35}         -- "Stable and Tele dwellers in Bracada" : "Congratulations on completing the gate!  Erathia is in your debt!"
  19: SetNPCGroupNews  {NPCGroup = 19, NPCNews = 35}         -- "Eastern village and boat dwellers in Bracada" : "Congratulations on completing the gate!  Erathia is in your debt!"
  20: SetNPCGroupNews  {NPCGroup = 20, NPCNews = 35}         -- "Ridge walkers in Bracada" : "Congratulations on completing the gate!  Erathia is in your debt!"
  21: SetNPCGroupNews  {NPCGroup = 21, NPCNews = 35}         -- "Peasents up till town fountain in Celeste" : "Congratulations on completing the gate!  Erathia is in your debt!"
  22: SetNPCGroupNews  {NPCGroup = 22, NPCNews = 35}         -- "Peasents after town fountain in Celeste" : "Congratulations on completing the gate!  Erathia is in your debt!"
  23: SetNPCGroupNews  {NPCGroup = 23, NPCNews = 33}         -- "Peasents in first area of the pit" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  24: SetNPCGroupNews  {NPCGroup = 24, NPCNews = 33}         -- "Peasents in the second area of the pit" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  25: SetNPCGroupNews  {NPCGroup = 25, NPCNews = 33}         -- "Peasents in the third area of the pit" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  26: SetNPCGroupNews  {NPCGroup = 26, NPCNews = 33}         -- "Peasents in main town of nighon" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  27: SetNPCGroupNews  {NPCGroup = 27, NPCNews = 33}         -- "Peasents in western town of Nighon" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  28: SetNPCGroupNews  {NPCGroup = 28, NPCNews = 33}         -- "Peasents in Eastern village of Nighon" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  29: SetNPCGroupNews  {NPCGroup = 29, NPCNews = 33}         -- "Peasents in the Mercenary guild village" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  30: SetNPCGroupNews  {NPCGroup = 30, NPCNews = 33}         -- "Peasents in the wharf town" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  31: SetNPCGroupNews  {NPCGroup = 31, NPCNews = 33}         -- "Peasents in the village area" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  32: SetNPCGroupNews  {NPCGroup = 32, NPCNews = 33}         -- "Peasents in the Dock area" : "I heard there was a gate built to the Ancients!  I wonder what they look like."
  33: EnterHouse  {Id = 600}         -- Win Good
end

event 171  -- "Final Task"
  0:  SetMessage  {Str = 349}         --[[ "Our finest hour is upon us.  While you have been taking care of all those important tasks, my compatriots and I have been struggling with our former friends for the parts we need to rebuild the Heavenly Forge of legend.  By former friends, I mean the four chief advisors to King Magnus of the Wizards.  They have a plan to build a gate to the Ancients.  They could have stood with us, but threw it all away on some vague hope of a 'better future'.  But you!  You have stood with us all this time.

Only one task remains--we need the Oscillation Overthruster from our old vehicle, the Lincoln.  We have been unable to find one on your world.  The ship is in the sea west of Avlee and secured against entry, even from ourselves.  Now you must wear our environment suits, enter the ship, and return with the Overthruster.  Our old environments suits have been prepared for you in the chest outside this throne room.  For the suit to function properly you must not be wearing any equipment.We will stand watch over the Forge, and defend it against our enemies.  Bring us the Overthruster, my friends, and together, we shall rule the world!" ]]
  1:  Add  {"History27", Value = 0}
  2:  Set  {"QBits", Value = 131}         -- "Go to the Lincoln in the sea west of Avlee and retrieve the Oscillation Overthruster and return it to Kastore in the Pit."
  3:  SetNPCTopic  {NPC = 84, Index = 1, Event = 172}         -- "Kastore" : "Final Task"
end

event 172  -- "Final Task"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 605,   jump = 4}         -- "Oscillation Overthruster"
  2:  SetMessage  {Str = 351}         -- "Don't forget you'll need the environmental suits to get to the Lincoln.  These suits are in the chest outside the throne room, and the Lincoln is in the sea west of Avlee.  What else do you need to know?"
  3:  Exit  {}

  4:  Subtract  {"Inventory", Value = 605}         -- "Oscillation Overthruster"
  5:  Subtract  {"QBits", Value = 235}         -- Wetsuit - I lost it
  6:  Subtract  {"QBits", Value = 236}         -- Final Part - I lost it
  7:  Subtract  {"QBits", Value = 131}         -- "Go to the Lincoln in the sea west of Avlee and retrieve the Oscillation Overthruster and return it to Kastore in the Pit."
  8:  SetNPCTopic  {NPC = 84, Index = 1, Event = 0}         -- "Kastore"
  9:  ShowMovie  {DoubleSize = 1, ExitCurrentScreen = true, Name = "\"Endgame 2 Evil\" "}
  10: SetNPCGroupNews  {NPCGroup = 10, NPCNews = 34}         -- "Southern Village Group in Harmondy" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  11: SetNPCGroupNews  {NPCGroup = 11, NPCNews = 34}         -- "Main village in Harmondy" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  12: SetNPCGroupNews  {NPCGroup = 12, NPCNews = 34}         -- "Tent camp in Erathia" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  13: SetNPCGroupNews  {NPCGroup = 13, NPCNews = 34}         -- "Stedwick Group" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  14: SetNPCGroupNews  {NPCGroup = 14, NPCNews = 34}         -- "Stilt city dwellers in the Tularean Forest" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  15: SetNPCGroupNews  {NPCGroup = 15, NPCNews = 34}         -- "Group walkers in the Tularean forest" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  16: SetNPCGroupNews  {NPCGroup = 16, NPCNews = 36}         -- "Northern town on Deyja" : "Congratulations on completing the forge!  Victory will surely be ours!"
  17: SetNPCGroupNews  {NPCGroup = 17, NPCNews = 36}         -- "Southern town in Deyja" : "Congratulations on completing the forge!  Victory will surely be ours!"
  18: SetNPCGroupNews  {NPCGroup = 18, NPCNews = 34}         -- "Stable and Tele dwellers in Bracada" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  19: SetNPCGroupNews  {NPCGroup = 19, NPCNews = 34}         -- "Eastern village and boat dwellers in Bracada" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  20: SetNPCGroupNews  {NPCGroup = 20, NPCNews = 34}         -- "Ridge walkers in Bracada" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  21: SetNPCGroupNews  {NPCGroup = 21, NPCNews = 34}         -- "Peasents up till town fountain in Celeste" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  22: SetNPCGroupNews  {NPCGroup = 22, NPCNews = 34}         -- "Peasents after town fountain in Celeste" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  23: SetNPCGroupNews  {NPCGroup = 23, NPCNews = 36}         -- "Peasents in first area of the pit" : "Congratulations on completing the forge!  Victory will surely be ours!"
  24: SetNPCGroupNews  {NPCGroup = 24, NPCNews = 36}         -- "Peasents in the second area of the pit" : "Congratulations on completing the forge!  Victory will surely be ours!"
  25: SetNPCGroupNews  {NPCGroup = 25, NPCNews = 36}         -- "Peasents in the third area of the pit" : "Congratulations on completing the forge!  Victory will surely be ours!"
  26: SetNPCGroupNews  {NPCGroup = 26, NPCNews = 34}         -- "Peasents in main town of nighon" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  27: SetNPCGroupNews  {NPCGroup = 27, NPCNews = 34}         -- "Peasents in western town of Nighon" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  28: SetNPCGroupNews  {NPCGroup = 28, NPCNews = 34}         -- "Peasents in Eastern village of Nighon" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  29: SetNPCGroupNews  {NPCGroup = 29, NPCNews = 34}         -- "Peasents in the Mercenary guild village" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  30: SetNPCGroupNews  {NPCGroup = 30, NPCNews = 34}         -- "Peasents in the wharf town" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  31: SetNPCGroupNews  {NPCGroup = 31, NPCNews = 34}         -- "Peasents in the village area" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  32: SetNPCGroupNews  {NPCGroup = 32, NPCNews = 34}         -- "Peasents in the Dock area" : "I've heard rumors of goblins and undead armed with ancient weapons threatening to conquer Erathia!  How dreadful!"
  33: EnterHouse  {Id = 601}         -- Win Evil
end

event 173  -- "Enter Temple of Light"
  0:  MoveToMap  {X = -6784, Y = -2832, Z = 1649, Direction = 512, LookAngle = 0, SpeedZ = 0, HouseId = 0, Icon = 0, Name = "T01.blv"}
end

event 174  -- "Enter Temple of Dark"
  0:  MoveToMap  {X = 0, Y = -4059, Z = 513, Direction = 512, LookAngle = 0, SpeedZ = 0, HouseId = 0, Icon = 0, Name = "T02.blv"}
end

event 175  -- "Thomas Grey"
  0:  SetMessage  {Str = 480}         -- "Thomas Grey runs the School of Sorcery.  If you're looking for promotion to Wizard or Honorary Wizard, he's your man.  His room is right through the door behind me."
end

event 176  -- "Book Shop"
  0:  CanShowTopic.Cmp  {"QBits", Value = 145,   jump = 3}         -- Membership to the School of Sorcery Scroll Shop
  1:  CanShowTopic.Set  {Visible = true}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 481}         -- "Would you like a membership to the School of Sorcery Scroll Shop?  A membership allows you free access to the scrolls available in our library.  It costs 5000 gold for a six month membership, but the shop stocks once per week."
  6:  SetNPCTopic  {NPC = 281, Index = 1, Event = 177}         -- "Eric Swarrel" : "Book Shop"
end

event 177  -- "Book Shop"
  0:  Cmp  {"Gold", Value = 5000,   jump = 3}
  1:  SetMessage  {Str = 483}         -- "You don't have enough gold-- it's no use trying to fool a Wizard."
  2:  Exit  {}

  3:  SetMessage  {Str = 482}         -- "Here's the membership, remember it only lasts for six months.  Check the shelves in the front rooms here to see what is available."
  4:  Set  {"QBits", Value = 145}         -- Membership to the School of Sorcery Scroll Shop
  5:  Subtract  {"Gold", Value = 5000}
  6:  SetNPCTopic  {NPC = 281, Index = 1, Event = 0}         -- "Eric Swarrel"
end

event 178  -- "Zokarr's Bones"
  0:  CanShowTopic.Cmp  {"QBits", Value = 54,   jump = 3}         -- "Retrieve the bones of the Dwarf King from the tunnels between Stone City and Nighon and place them in their proper resting place in the Barrow Downs, then return to Anthony Green in the Tularean Forest."
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 484}         -- "You want to bury the bones of Zokarr IV in our old barrows?  No dwarf here will brave the dangers, but Zokarr deserves to be laid to rest in the right place.  Look for the secret barrow, the one with only one entrance.  In there is a coffin waiting for Zokarr's bones."
  6:  Add  {"Inventory", Value = 626}         -- "Zokarr IV's Skull"
  7:  Add  {"QBits", Value = 228}         -- Dwarf Bones - I lost it
  8:  SetNPCTopic  {NPC = 59, Index = 1, Event = 0}         -- "Hothfarr IX"
end

event 179  -- "Quest"
  0:  SetMessage  {Str = 485}         -- "We have no one to turn to but you, the new Lords of Harmondale. The Lantern of Light is a treasured holy relic, used by the temples of Erathia.  Its value is more symbolic than of power-- without it the temples servants lose faith.  This Lantern disappeared while being brought to this temple from the temple in Stone City.  We believe it was lost somewhere in the maze-like Barrows.  Please find it and return it to us."
  1:  SetNPCTopic  {NPC = 93, Index = 0, Event = 180}         -- "Tarin Withern" : "Quest"
  2:  Set  {"QBits", Value = 155}         -- "Retrieve the Lantern of Light from the Barrow Downs and return it to Tarin Withern in Harmondale."
end

event 180  -- "Quest"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 648,   jump = 4}         -- "Lantern of Light"
  2:  SetMessage  {Str = 486}         -- "Have you found the Lantern of Light?  We're certain it was lost in the maze of Barrows in the Barrow Downs."
  3:  Exit  {}

  4:  SetMessage  {Str = 487}         -- "Thank you, Lords of Harmondale.  The Lantern's return will bolster our faith and allows us to continue our services.  Please take this small reward as a token of our gratitude."
  5:  Subtract  {"Inventory", Value = 648}         -- "Lantern of Light"
  6:  Add  {"Awards", Value = 92}         -- "Returned Withern's Lantern"
  7:  Add  {"Experience", Value = 5000}
  8:  ForPlayer  ("Current")
  9:  Add  {"Gold", Value = 1000}
  10: Subtract  {"QBits", Value = 155}         -- "Retrieve the Lantern of Light from the Barrow Downs and return it to Tarin Withern in Harmondale."
  11: SetNPCTopic  {NPC = 93, Index = 0, Event = 0}         -- "Tarin Withern"
  12: SetNPCGreeting  {NPC = 93, Greeting = 152}         -- "Tarin Withern" : "Thanks for returning the Lantern of Light.  Ceremonies can continue normally at the temple!"
  13: Subtract  {"Reputation", Value = 5}
end

event 181  -- "Quest"
  0:  SetMessage  {Str = 488}         -- "My, brother, Haldar passed away last month.  The family was sending his remains to me to be put to final rest.  Something happened to those delivering these remains to me; they disappeared in Nighon and not been heard from since. I fear my brothers soul will never rest unless they are found!  Please return Haldar to me if you find him? I will reward you well for this!"
  1:  SetNPCTopic  {NPC = 94, Index = 0, Event = 182}         -- "Mazim Dusk" : "Quest"
  2:  Set  {"QBits", Value = 156}         -- "Retrieve Haldar's Remains from the Maze in Nighon and return them to Mazim Dusk in Nighon."
end

event 182  -- "Quest"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 628,   jump = 4}         -- "Haldar's Remains"
  2:  SetMessage  {Str = 489}         -- "Did you find Haldar's Remains?  His soul must be in sheer agony!  Please find the jar with his remains!"
  3:  Exit  {}

  4:  SetMessage  {Str = 490}         -- "Thank you for returning my ""brother's"" remains!  He was a promising Warlock and his life was ended to soon.  Now that I have his remains, I will attempt to bring him back as a Lich, and together we will seek greater power and glory!"
  5:  Subtract  {"Inventory", Value = 628}         -- "Haldar's Remains"
  6:  Add  {"Awards", Value = 93}         -- "Returned Haldar's Remains"
  7:  Add  {"Experience", Value = 50000}
  8:  ForPlayer  ("Current")
  9:  Add  {"Gold", Value = 35000}
  10: Subtract  {"QBits", Value = 156}         -- "Retrieve Haldar's Remains from the Maze in Nighon and return them to Mazim Dusk in Nighon."
  11: SetNPCTopic  {NPC = 94, Index = 0, Event = 0}         -- "Mazim Dusk"
  12: SetNPCGreeting  {NPC = 94, Greeting = 154}         -- "Mazim Dusk" : "My thanks for returning Haldar's remains!"
  13: Subtract  {"Reputation", Value = 5}
end

event 183  -- "Quest"
  0:  SetMessage  {Str = 491}         -- "My lords, I was beset by foul bandits when I returned from Avlee and they took everything I had brought with me from the Elves.  They even took my signet ring!  Without it I cannot continue my business because I cannot seal contracts between myself and other merchants.  I've heard the bandits base themselves out of a camp in Erathia, but I'm no warrior-- I'd not last a minute against them.  Please go to Erathia and see this justice done!"
  1:  SetNPCTopic  {NPC = 95, Index = 0, Event = 184}         -- "Davrik Peladium" : "Quest"
  2:  Set  {"QBits", Value = 157}         -- "Retrieve Davrik's Signet ring from the Bandit Caves in the northeast of Erathia and return it to Davrik Peladium in Harmondale."
end

event 184  -- "Quest"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 606,   jump = 4}         -- "Signet Ring"
  2:  SetMessage  {Str = 492}         -- "You don't have my ring yet?  The bandits are south of Castle Gryphonheart in Erathia.  Please help me, I don't have anyone else to turn to."
  3:  Exit  {}

  4:  SetMessage  {Str = 493}         -- "My ring!  Thank you lords.  I can now continue my business and recover my losses, and you have made the trading routes safer for all the merchants!"
  5:  Subtract  {"Inventory", Value = 606}         -- "Signet Ring"
  6:  Add  {"Awards", Value = 94}         -- "Returned Lord Davrik's signet Ring"
  7:  Add  {"Experience", Value = 5000}
  8:  ForPlayer  ("Current")
  9:  Add  {"Gold", Value = 5000}
  10: Subtract  {"QBits", Value = 157}         -- "Retrieve Davrik's Signet ring from the Bandit Caves in the northeast of Erathia and return it to Davrik Peladium in Harmondale."
  11: SetNPCTopic  {NPC = 95, Index = 0, Event = 0}         -- "Davrik Peladium"
  12: MoveNPC  {NPC = 95, HouseId = 0}         -- "Davrik Peladium"
  13: Subtract  {"Reputation", Value = 5}
end

event 185  -- "Quest"
  0:  SetMessage  {Str = 494}         -- "So you are the Lords of Harmondale, eh?  You don’t look like much; we shall see how history judges you!  I myself am a historian and collector of rare historical items.  Lord Markham also collects such items of interest and there is one item in particular that would complete my collection, Parson's Quill-- the Quill used to sign the Treaty of Pierpont ending the first Timber War.  I know you have dealt with Lord Markham before, it's how you became Lords of this land after all, and if you would take this letter to Lord Markham in Tatalia, I'm sure he would respond favorably.  I would be even more in your debt if Lord Markham sends this item back with you!  I would be sure to favorably record your heroic acts and deeds!"
  1:  SetNPCTopic  {NPC = 96, Index = 0, Event = 186}         -- "Norbert Thrush" : "Thrush's Letter"
  2:  Set  {"QBits", Value = 158}         -- "Take Sealed Letter to Lord Markham in Lord Markham's Manor in Tatalia for collector Norbert Thrush."
  3:  Add  {"Inventory", Value = 614}         -- "Letter from Norbert Thrush to Lord Markham"
end

event 186  -- "Thrush's Letter"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 603,   jump = 4}         -- "Parson's Quill"
  2:  SetMessage  {Str = 495}         -- "Did Lord Markham refuse to give you the Quill, or have you not even visited him yet?  His Manor is in Tatalia, please don't forget to help me."
  3:  Exit  {}

  4:  SetMessage  {Str = 496}         -- "The actual Peacock feather that was used to sign the Treaty of Pierpont.  My collection is complete!  I will be sure to record your activities and deeds correctly and justly so that all will know you as the true Lords of Harmondale!"
  5:  Subtract  {"Inventory", Value = 603}         -- "Parson's Quill"
  6:  Add  {"Awards", Value = 95}         -- "Returned Parson's Quill to Norbert Thrush"
  7:  Add  {"Experience", Value = 5000}
  8:  ForPlayer  ("Current")
  9:  Add  {"Gold", Value = 2000}
  10: Subtract  {"QBits", Value = 159}         -- "Return Parson's Quill to Norbert Thrush in Erathia."
  11: SetNPCTopic  {NPC = 96, Index = 0, Event = 0}         -- "Norbert Thrush"
  12: SetNPCGreeting  {NPC = 96, Greeting = 158}         -- "Norbert Thrush" : "Thank you for returning the Parson's Quill sent by Lord Markham.  You help has made my collection complete!"
  13: Subtract  {"Reputation", Value = 5}
end

event 187  -- "Quest"
  0:  ForPlayer  ("All")

  1:  CanShowTopic.Cmp  {"Inventory", Value = 614,   jump = 4}         -- "Letter from Norbert Thrush to Lord Markham"
  2:  CanShowTopic.Set  {Visible = false}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = true}
  5:  CanShowTopic.Exit  {}

  6:  SetMessage  {Str = 497}         -- "A letter from Norbert Thrush the Historian? Let me see it.  [Lord Markham scans the letter briefly] Hmmmmm…he wants the Peacock feather that was used to sign the Treaty of Pierpont, does he.  Well, seeing as though he has a supposed original of the Treaty, I guess the feather should go to him.  He has promised me anything else in his collection.  Take this to him and tell him that I will come collect from him shortly!"
  7:  Subtract  {"Inventory", Value = 614}         -- "Letter from Norbert Thrush to Lord Markham"
  8:  ForPlayer  ("Current")
  9:  Add  {"Inventory", Value = 603}         -- "Parson's Quill"
  10: Subtract  {"QBits", Value = 158}         -- "Take Sealed Letter to Lord Markham in Lord Markham's Manor in Tatalia for collector Norbert Thrush."
  11: Set  {"QBits", Value = 159}         -- "Return Parson's Quill to Norbert Thrush in Erathia."
  12: SetNPCTopic  {NPC = 1, Index = 4, Event = 0}         -- "Lord Markham"
end

event 188  -- "Quest"
  0:  SetMessage  {Str = 498}         -- "I hear you folk are the new Lords of Harmondale, eh?  Perhaps you could do me a large favor, and help yourselves in the process.  To the north, in Avlee, lies the Hall under the Hill, the domain of the Faerie King.  He owes me a debt from a previous service of mine, and I would like to collect it.  Unfortunately, the faeries in the Hall and the tricks they play frighten me to death.  If you would deliver this letter to the Faerie King, and return what he gives you to me, I'd be very grateful.  You would also have the chance to meet the Faerie King for yourselves."
  1:  Add  {"QBits", Value = 179}         -- "Take the sealed letter to the Faerie King in the Hall under the Hill in Avlee."
  2:  Add  {"Inventory", Value = 607}         -- "Letter from Johann Kerrid to the Faerie King"
  3:  SetNPCTopic  {NPC = 97, Index = 0, Event = 190}         -- "Johann Kerrid" : "Quest"
end

event 189  -- "Pipes"
  0:  ForPlayer  ("All")

  1:  CanShowTopic.Cmp  {"Inventory", Value = 607,   jump = 4}         -- "Letter from Johann Kerrid to the Faerie King"
  2:  CanShowTopic.Set  {Visible = false}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = true}
  5:  CanShowTopic.Exit  {}

  6:  SetMessage  {Str = 65}         -- "So, Johann be wanting the Faerie Pipes, eh?  I can't say I'm surprised--he wouldn't come here himself, the coward.  The Pipes will cost you, though… all your food.  Of course, I've got some delightful food down below, should thee be wanting to restock your packs."
  7:  Subtract  {"Inventory", Value = 607}         -- "Letter from Johann Kerrid to the Faerie King"
  8:  Add  {"Experience", Value = 2000}
  9:  ForPlayer  ("Current")
  10: Add  {"Inventory", Value = 633}         -- "Faerie Pipes"
  11: SetNPCTopic  {NPC = 52, Index = 1, Event = 0}         -- "Faerie King"
  12: Subtract  {"QBits", Value = 179}         -- "Take the sealed letter to the Faerie King in the Hall under the Hill in Avlee."
  13: Add  {"QBits", Value = 180}         -- "Take the Faerie Pipes to Johann Kerrid in the Tularean Forest."
  14: Set  {"Food", Value = 0}
end

event 190  -- "Quest"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 633,   jump = 4}         -- "Faerie Pipes"
  2:  SetMessage  {Str = 500}         -- "Don't forget to give the letter to the Faerie King.  Without it, he probably won't even want to talk to you."
  3:  Exit  {}

  4:  SetMessage  {Str = 499}         -- "Excellent!  The Pipes!  You don't know what this means to me.  Here, take this as a reward and thank you again for your help in this!"
  5:  Subtract  {"Inventory", Value = 633}         -- "Faerie Pipes"
  6:  Add  {"Experience", Value = 5000}
  7:  ForPlayer  ("Current")
  8:  Add  {"Awards", Value = 96}         -- "Returned Faerie Pipes to Johann Kerrid"
  9:  Add  {"Gold", Value = 1000}
  10: Subtract  {"QBits", Value = 180}         -- "Take the Faerie Pipes to Johann Kerrid in the Tularean Forest."
  11: SetNPCTopic  {NPC = 97, Index = 0, Event = 0}         -- "Johann Kerrid"
  12: SetNPCGreeting  {NPC = 97, Greeting = 160}         -- "Johann Kerrid" : "Thank you so much for returning the Faerie Pipes to me!  I would have never been able to brave the Hall under the Hill myself."
  13: Subtract  {"Reputation", Value = 5}
end

event 191  -- "Quest"
  0:  CanShowTopic.Cmp  {"QBits", Value = 183,   jump = 2}         -- Failed either goto or do guild quest
  1:  CanShowTopic.Cmp  {"QBits", Value = 99,   jump = 4}         -- Chose the path of Light
  2:  CanShowTopic.Set  {Visible = false}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = true}
  5:  CanShowTopic.Exit  {}

  6:  SetMessage  {Str = 501}         -- "We request your services for only one small task.  In Castle Lambent rests a valuable tapestry taken from an attack on Watchtower 3 years ago.  I would like you to get the tapestry for me, as you must have *some* access to the Castle-- my normal associates can't even come near the place.  I hear a large band of goblins and renegade swordsmen are about... it would be a shame if they happened to find a way to Harmondale.  You have one month to get the tapestry.  Don't be late."
  7:  Set  {"QBits", Value = 182}         -- "Steal the Tapestry from your associate's Castle and return it to Niles Stantley in the Mercenary Guild in Tatalia."
  8:  Set  {"Counter5", Value = 0}
  9:  SetNPCTopic  {NPC = 99, Index = 0, Event = 193}         -- "Niles Stantley" : "Quest"
end

event 192  -- "Quest"
  0:  CanShowTopic.Cmp  {"QBits", Value = 183,   jump = 2}         -- Failed either goto or do guild quest
  1:  CanShowTopic.Cmp  {"QBits", Value = 100,   jump = 4}         -- Chose the path of Dark
  2:  CanShowTopic.Set  {Visible = false}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = true}
  5:  CanShowTopic.Exit  {}

  6:  SetMessage  {Str = 502}         -- "We request your services for one task.  A rare and valuable tapestry rests in Castle Gloaming, an antique from near the Silence stolen from the wizards some time ago.  I would like you to get the tapestry for me, as my normal associates don't have access to Castle Gloaming.  In return, I'll make sure that the large band of renegade swordsmen and goblins near Harmondale don't accidentally stumble upon your quiet, little village.  You have one month; don't be late."
  7:  Set  {"QBits", Value = 182}         -- "Steal the Tapestry from your associate's Castle and return it to Niles Stantley in the Mercenary Guild in Tatalia."
  8:  Set  {"Counter5", Value = 0}
  9:  SetNPCTopic  {NPC = 99, Index = 1, Event = 193}         -- "Niles Stantley" : "Quest"
end

event 193  -- "Quest"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Counter5", Value = 672,   jump = 5}
  2:  Cmp  {"Inventory", Value = 620,   jump = 8}         -- "Big Tapestry"
  3:  SetMessage  {Str = 73}         -- "You don't have the tapestry yet, and the clock is ticking.  It would be prudent to keep to the task at hand rather than bothering me with your babble."
  4:  Exit  {}

  5:  SetMessage  {Str = 504}         -- "I see.  Well, it would appear that the band of renegades has indeed discovered your little town, and has begun looting.  You may find your bank account a little, well, pinched.  Consider this a lesson in punctuality.  Go now and have a pleasant, pleasant day."
  6:  Add  {"QBits", Value = 183}         -- Failed either goto or do guild quest
  7:  Exit  {}

  8:  SetMessage  {Str = 503}         -- "Excellent!  I see that you can be trusted to perform well when called upon.  I'll keep that in mind the next time I need a job done.  Your reward is nothing more than status quo-- things could be much worse than they already are.  Go now, I have no more time for you."
  9:  Subtract  {"Inventory", Value = 620}         -- "Big Tapestry"
  10: Add  {"Reputation", Value = 5}
  11: Add  {"QBits", Value = 190}         -- Finished with Malwick & Assc.
  12: Subtract  {"QBits", Value = 182}         -- "Steal the Tapestry from your associate's Castle and return it to Niles Stantley in the Mercenary Guild in Tatalia."
  13: SetNPCTopic  {NPC = 99, Index = 0, Event = 0}         -- "Niles Stantley"
  14: SetNPCTopic  {NPC = 99, Index = 1, Event = 0}         -- "Niles Stantley"
  15: SetNPCTopic  {NPC = 99, Index = 2, Event = 0}         -- "Niles Stantley"
end

event 194  -- "Quest"
  0:  SetMessage  {Str = 505}         -- "A few years back, while mining underneath Stone City, we came upon quite a shock.  It seems that the Warlocks from Nighon had burrowed under the sea to make a sneak attack upon the shores of Erathia.  Their careless tunneling has sunken the earth around here until now the areas around the old dwarven barrows and, of course, Stone City, rest far above the terrain.  We discovered a force of troglodytes in our mining areas, with a tunnel leading back to Nighon.  If you could help us by ridding the tunnels of the troglodytes, we could get back to mining.  Can you help us?"
  1:  Set  {"QBits", Value = 186}         -- "Kill all the Troglodytes underneath Stone City and return to Spark Burnkindle in Stone City."
  2:  SetNPCTopic  {NPC = 100, Index = 0, Event = 195}         -- "Spark Burnkindle" : "Quest"
end

event 195  -- "Quest"
  0:  CheckMonstersKilled  {CheckType = 2, Id = 213, Count = 0,   jump(>=) = 3}
  1:  SetMessage  {Str = 506}         -- "There are still troglodytes roaming the lower mine levels.  Please remove them!"
  2:  Exit  {}

  3:  CheckMonstersKilled  {CheckType = 2, Id = 214, Count = 0,   jump(>=) = 6}
  4:  SetMessage  {Str = 506}         -- "There are still troglodytes roaming the lower mine levels.  Please remove them!"
  5:  Exit  {}

  6:  CheckMonstersKilled  {CheckType = 2, Id = 215, Count = 0,   jump(>=) = 9}
  7:  SetMessage  {Str = 506}         -- "There are still troglodytes roaming the lower mine levels.  Please remove them!"
  8:  Exit  {}

  9:  SetMessage  {Str = 507}         -- "They're gone?  Routed back into the connecting tunnels to Nighon!  Excellent!  We can get back to mining immediately!  Thank you so much for your help; take this as a reward for your services."
  10: Add  {"Gold", Value = 2500}
  11: ForPlayer  ("All")
  12: Add  {"Experience", Value = 5000}
  13: Subtract  {"QBits", Value = 186}         -- "Kill all the Troglodytes underneath Stone City and return to Spark Burnkindle in Stone City."
  14: Set  {"Awards", Value = 97}         -- "Troglodyte Slayer"
  15: SetNPCTopic  {NPC = 100, Index = 0, Event = 0}         -- "Spark Burnkindle"
  16: Subtract  {"Reputation", Value = 10}
  17: SetNPCGreeting  {NPC = 100, Greeting = 164}         -- "Spark Burnkindle" : "Thank you for helping us by getting rid of those nasty Troglodytes!"
end

event 196  -- "Quest"
  0:  CanShowTopic.Cmp  {"QBits", Value = 100,   jump = 3}         -- Chose the path of Dark
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 508}         -- "I have recently gained information that the forces of Queen Catherine, in Erathia, have begun to build a force to attack Deyja.  Because of the difficult terrain, they have begun to breed and train griffins to assist in their attack.  These griffins are being raised in both Erathia and the Bracada Desert.  I need you to kill off all the griffins in those two areas so that the Erathians will be forced to drastically delay their plans of attack."
  6:  Set  {"QBits", Value = 187}         -- "Kill all the Griffins in Erathia and the Bracada Desert and return to Seth Drakkson in the Deyja Moors."
  7:  SetNPCTopic  {NPC = 284, Index = 0, Event = 197}         -- "Seth Drakkson" : "Quest"
end

event 197  -- "Quest"
  0:  Cmp  {"QBits", Value = 188,   jump = 4}         -- Killed all Erathian Griffins
  1:  Cmp  {"QBits", Value = 189,   jump = 7}         -- Killed all Bracada Desert Griffins
  2:  SetMessage  {Str = 509}         -- "You haven't killed off all the griffins in either Erathia or the Bracada Desert.  It is imperative that you finish this task to prevent their invasion."
  3:  Exit  {}

  4:  Cmp  {"QBits", Value = 189,   jump = 10}         -- Killed all Bracada Desert Griffins
  5:  SetMessage  {Str = 511}         -- "You've killed the griffins near Steadwick, but you haven't dealt with the griffins in the Bracada Desert yet.  Finish them both off and return to me."
  6:  Exit  {}

  7:  Cmp  {"QBits", Value = 188,   jump = 10}         -- Killed all Erathian Griffins
  8:  SetMessage  {Str = 510}         -- "You've killed the griffins near Spyre Town, but you haven't dealt with the griffins in Erathia yet.  Finish them both off and return to me."
  9:  Exit  {}

  10: SetMessage  {Str = 512}         -- "Excellent!  You've done a splendid job.  Here, take this as your reward and know you've earned the respect of Deyja for your bold success."
  11: Subtract  {"QBits", Value = 187}         -- "Kill all the Griffins in Erathia and the Bracada Desert and return to Seth Drakkson in the Deyja Moors."
  12: Add  {"Gold", Value = 5000}
  13: ForPlayer  ("All")
  14: Add  {"Experience", Value = 10000}
  15: Subtract  {"Reputation", Value = 10}
  16: Add  {"Awards", Value = 98}         -- "Griffin Slayer"
  17: SetNPCTopic  {NPC = 284, Index = 0, Event = 0}         -- "Seth Drakkson"
  18: SetNPCGreeting  {NPC = 284, Greeting = 166}         -- "Seth Drakkson" : "Good work on those griffins, my lords.  It is always a pleasure to see you."
end

event 198  -- "Quest"
  0:  SetMessage  {Str = 450}         --[[ "My brother, Elron, was an avid Arcomage player.  Have you played Arcomage yet?  Horribly addicting game, if I do say so.  In any rate, you can only play if you have a deck, and decks are hard to come by… so I guess you probably haven't.  In any case, Elron wanted to go over some strategies to help him win more games.  Unfortunately, he didn't want to be in town because he didn't want anyone else to spy on him learn his tricks so he went to the White Cliff Caves southeast a bit from town.

Elron hasn't been back in almost a week.  I'm certain something horrible has happened to him, but if he's alive I'd like to know that too.  Would you do me the service of locating him?  I don't have a lot of money to pay you back with, but I'd be greatly in your debt." ]]
  1:  Set  {"QBits", Value = 194}         -- "Find the fate of Darron's brother in the White Cliff Caves, then return to Darron Temper in Harmondale."
  2:  SetNPCTopic  {NPC = 285, Index = 0, Event = 199}         -- "Darron Temper" : "Quest"
end

event 199  -- "Quest"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 651,   jump = 4}         -- "Arcomage Deck"
  2:  SetMessage  {Str = 451}         -- "Still no sign of him?  I understand.  If you do happen to find out what happened to him, please let me know."
  3:  Exit  {}

  4:  SetMessage  {Str = 452}         -- "Dead?  Oh dear!  Those are certainly his cards, though.  I don't want the cards; you can have them-- that game has cost me enough now.  Oh, poor Elron!  I have a little money you can keep for your help, and thank you for finding out what happened to Elron."
  5:  Add  {"Experience", Value = 2000}
  6:  ForPlayer  ("Current")
  7:  Subtract  {"QBits", Value = 194}         -- "Find the fate of Darron's brother in the White Cliff Caves, then return to Darron Temper in Harmondale."
  8:  Add  {"Gold", Value = 750}
  9:  SetNPCTopic  {NPC = 285, Index = 0, Event = 0}         -- "Darron Temper"
  10: Subtract  {"Reputation", Value = 5}
end

event 313  -- "Quest"
  0:  CanShowTopic.Cmp  {"QBits", Value = 99,   jump = 3}         -- Chose the path of Light
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 453}         -- "The School of Sorcery here in the Bracada Desert collects a number of odd magical paraphernalia.  A few years ago an item of particular interest was stolen from the School by raiders from Deyja.  This item, the Seasons' Stole, was worn by Priests of the Sun during religious ceremonies at the turn of the seasons.  As a representative of the School of Sorcery, I'm authorized to reward you for its return.  Our last information placed the stolen Stole in the Hall of the Pit; I would suggest checking there first."
  6:  Add  {"QBits", Value = 195}         -- "Retrieve the Seasons' Stole from the Hall of the Pit and return it to Gary Zimm in the Bracada Desert."
  7:  SetNPCTopic  {NPC = 286, Index = 0, Event = 314}         -- "Gary Zimm" : "Quest"
end

event 314  -- "Quest"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 638,   jump = 4}         -- "Season's Stole"
  2:  SetMessage  {Str = 454}         -- "Don't forget there is a reward for the Seasons' Stole if you are able to find it and return it to me."
  3:  Exit  {}

  4:  SetMessage  {Str = 455}         -- "Excellent!  This most certainly is the Seasons' Stole.  Here is your reward; you've done both the School of Sorcery and myself a great service."
  5:  Subtract  {"Inventory", Value = 638}         -- "Season's Stole"
  6:  Add  {"Experience", Value = 7500}
  7:  ForPlayer  ("Current")
  8:  Add  {"Gold", Value = 7500}
  9:  Subtract  {"QBits", Value = 195}         -- "Retrieve the Seasons' Stole from the Hall of the Pit and return it to Gary Zimm in the Bracada Desert."
  10: Add  {"Awards", Value = 99}         -- "Retrieved the Seasons' Stole"
  11: Subtract  {"Reputation", Value = 5}
  12: SetNPCTopic  {NPC = 286, Index = 0, Event = 0}         -- "Gary Zimm"
end

event 315  -- "Elsie Pederton"
  0:  SetMessage  {Str = 514}         -- "The Master instructor of the Staff, Elsie Pederton, can be found in the Bracada Desert, on a ridge in the southwest region."
  1:  Set  {"AutonotesBits", Value = 128}         -- ""
end

event 316  -- "Jillian Mithrit"
  0:  SetMessage  {Str = 515}         -- "The ultimate teacher in the ways of the Staff, Jillian Mithrit, can be found in the elven territory of Avlee.  Her home is in the city in the northeast."
  1:  Set  {"AutonotesBits", Value = 129}         -- ""
end

event 317  -- "Tugor Slicer"
  0:  SetMessage  {Str = 516}         -- "The Master instructor of the Sword, Tugor Slicer, maintains his residence in a small village in the western region of the Deyja."
  1:  Set  {"AutonotesBits", Value = 130}         -- ""
end

event 318  -- "Chadric Townsaver"
  0:  SetMessage  {Str = 517}         -- "The Grandmaster of the Sword, Chadric Townsaver, can be found in a small village in Welnin, just south of the city of Harmondale."
  1:  Set  {"AutonotesBits", Value = 131}         -- ""
end

event 319  -- "Aznog Slasher"
  0:  SetMessage  {Str = 518}         -- "The Master tutor of the Dagger, Aznog Slasher, can be found in the northern region of Nighon."
  1:  Set  {"AutonotesBits", Value = 132}         -- ""
end

event 320  -- "Tonken Fist"
  0:  SetMessage  {Str = 519}         -- "The Grandmaster of the Dagger, Token Fist, can be found in city of Tidewater in Tatalia.  Rumor has it that the Master Thief in the depths of the Erathian Sewers beneath the capitol city of Steadwick can also instruct at this level."
  1:  Set  {"AutonotesBits", Value = 133}         -- ""
end

event 321  -- "Dalin Keenedge"
  0:  SetMessage  {Str = 520}         -- "The Master Instructor of all that is the Axe, Dalin Keenedge, can be found in the northeast corner of Stone City."
  1:  Set  {"AutonotesBits", Value = 134}         -- ""
end

event 322  -- "Karn Stonecleaver"
  0:  SetMessage  {Str = 521}         -- "The ultimate teacher of the uses of the Axe, Karn Stonecleaver, can be found in the snowy heights of the northeast region of Tatalia."
  1:  Set  {"AutonotesBits", Value = 135}         -- ""
end

event 323  -- "Claderin Silverpoint"
  0:  SetMessage  {Str = 522}         -- "The Master teacher, Claderin Silverpoint, can be found in the northeast section of the city of Pierpont in the elven region of the Tularean Forest. There he will further you knowledge of the Spear."
  1:  Set  {"AutonotesBits", Value = 136}         -- ""
end

event 324  -- "Seline Falconeye"
  0:  SetMessage  {Str = 523}         -- "The Grandmaster of the Spear, Selene Falconeye, makes her home in the northeast corner of Stone City."
  1:  Set  {"AutonotesBits", Value = 137}         -- ""
end

event 325  -- "Lanshee Ravensight"
  0:  SetMessage  {Str = 524}         -- "The Master tutor of the Bow, Lanshee Ravensight, lives in the northern regions of Nighon."
  1:  Set  {"AutonotesBits", Value = 138}         -- ""
end

event 326  -- "Cardric the Steady"
  0:  SetMessage  {Str = 525}         -- "The Grandmaster of the Bow, Cardric the Steady, can be found just to the southeast of the castle in the city of Harmondale."
  1:  Set  {"AutonotesBits", Value = 139}         -- ""
end

event 327  -- "Brother Rothham"
  0:  SetMessage  {Str = 526}         -- "The Master instructor of the Mace, Brother Rothham, can be found in the southern region of the swamps of Tatalia."
  1:  Set  {"AutonotesBits", Value = 140}         -- ""
end

event 328  -- "Patwin Fellbern"
  0:  SetMessage  {Str = 527}         -- "The Grandmaster of the Mace, Patwin Felburn, teaches from his home in the goblin village found in the eastern area of the Deyja. "
  1:  Set  {"AutonotesBits", Value = 141}         -- ""
end

event 329  -- "Isram Gallowswell"
  0:  SetMessage  {Str = 528}         -- "My Master, Isram Gallowswell, can be found in the snowy heights of the northeast area of Tatalia. You will gain further instruction in the Shield there."
  1:  Set  {"AutonotesBits", Value = 142}         -- ""
end

event 330  -- "Fedwin Smithson"
  0:  SetMessage  {Str = 529}         -- "The Grandmaster of the Shield, Fedwin Smithson, can be found on the eastern island of the Evenmorn Islands."
  1:  Set  {"AutonotesBits", Value = 143}         -- ""
end

event 331  -- "Rabisa Nedlon"
  0:  SetMessage  {Str = 530}         -- "The Master tutor of Leather Armor, Rabisa Neldon, lives in the northern regions of Nighon."
  1:  Set  {"AutonotesBits", Value = 144}         -- ""
end

event 332  -- "Miyon the Quick"
  0:  SetMessage  {Str = 531}         -- "The Grandmaster of Leather Armor, Miyon the Quick, can be found in the eastern section of the city of Pierpont in the elven region of the Tularean Forest."
  1:  Set  {"AutonotesBits", Value = 145}         -- ""
end

event 333  -- "Medwari Dragontracker"
  0:  SetMessage  {Str = 532}         -- "The Master instructor of uses of Chain Armor, Medwari Dragontracker, can be found in the elven territory of Avlee.  His home is in the city in the northeast."
  1:  Set  {"AutonotesBits", Value = 146}         -- ""
end

event 334  -- "Halian Nevermore"
  0:  SetMessage  {Str = 533}         -- "The Grandmaster instructor of Chain Armor, Halian Nevermore, maintains his residence in a large city in the northwest region of Deyja."
  1:  Set  {"AutonotesBits", Value = 147}         -- ""
end

event 335  -- "Dekian Forgewright"
  0:  SetMessage  {Str = 534}         -- "My Master, Dekian Forgewright, makes his home in Erathia in the capitol city of Steadwick. He can provide further instruction in the uses of Plate Armor."
  1:  Set  {"AutonotesBits", Value = 148}         -- ""
end

event 336  -- "Brand the Maker"
  0:  SetMessage  {Str = 535}         -- "The Grandmaster of Plate Armor, Brand the Maker, can be found in the Bracada desert, on a ridge in the central region."
  1:  Set  {"AutonotesBits", Value = 149}         -- ""
end

event 337  -- "Ashen Temper"
  0:  SetMessage  {Str = 536}         -- "The Master tutor of Fire Magic, Ashen Temper, can be found in the city of Harmondale near the stables."
  1:  Set  {"AutonotesBits", Value = 150}         -- ""
end

event 338  -- "Blayze "
  0:  SetMessage  {Str = 537}         -- "The Grandmaster of Fire Magic, Blayze, makes his home in Erathia in the capitol city of Steadwick."
  1:  Set  {"AutonotesBits", Value = 151}         -- ""
end

event 339  -- "Rislyn Greenstorm"
  0:  SetMessage  {Str = 538}         -- "The Master tutor of Air Magic, Rislyn Greenstorm, lives in the elven territory of Avlee.  His home is in the city in the northeast."
  1:  Set  {"AutonotesBits", Value = 152}         -- ""
end

event 340  -- "Gayle"
  0:  SetMessage  {Str = 539}         -- "The Grandmaster of Air Magic, Gayle, can be found in a tower in the Bracada desert, on a ridge in the northern region."
  1:  Set  {"AutonotesBits", Value = 153}         -- ""
end

event 341  -- "Tobren Rainshield"
  0:  SetMessage  {Str = 540}         -- "The Master tutor of the uses of Water Magic, Tobren Rainshield, lives in the southwest region of Nighon."
  1:  Set  {"AutonotesBits", Value = 154}         -- ""
end

event 342  -- "Torrent"
  0:  SetMessage  {Str = 541}         -- "The Grandmaster of Water Magic, Torrent, lives on a ridge, south of Harmondale, overlooking the city."
  1:  Set  {"AutonotesBits", Value = 155}         -- ""
end

event 343  -- "Lara Stonewright"
  0:  SetMessage  {Str = 542}         -- "The Master tutor of Earth Magic, Lara Stonewright, makes her home in the elven territory of the Tularean Forest.  Her residence is in the city of Pierpont."
  1:  Set  {"AutonotesBits", Value = 156}         -- ""
end

event 344  -- "Avalanche"
  0:  SetMessage  {Str = 543}         -- "The Grandmaster instructor of Earth Magic, Avalanche, maintains his residence in the western region of the Deyja."
  1:  Set  {"AutonotesBits", Value = 157}         -- ""
end

event 345  -- "Heather Dreamwright"
  0:  SetMessage  {Str = 544}         -- "The Master who taught me, Heather Dreamwright, makes her home in Erathia, somewhere in the capitol city of Steadwick.  Further knowledge of Spirit Magic can be gained there."
  1:  Set  {"AutonotesBits", Value = 158}         -- ""
end

event 346  -- "Benjamin the Balanced"
  0:  SetMessage  {Str = 545}         -- "The ultimate teacher in the ways of Spirit Magic, Benjamin the Balanced, can be found in the elven territory of the Tularean Forest.  His home is in the city of Pierpont."
  1:  Set  {"AutonotesBits", Value = 159}         -- ""
end

event 347  -- "Myles Featherwind"
  0:  SetMessage  {Str = 546}         -- "The Master teacher in the ways of Mind Magic, Myles Featherwind, can be found in the elven territory of Avlee.  His home is in the city to the northeast."
  1:  Set  {"AutonotesBits", Value = 160}         -- ""
end

event 348  -- "Xavier Bremen"
  0:  SetMessage  {Str = 547}         -- "The Grandmaster of Mind Magic, Xavier Bremen, can be found in the snowy heights of the northeast area of Tatalia. "
  1:  Set  {"AutonotesBits", Value = 161}         -- ""
end

event 349  -- "Brother Bombah"
  0:  SetMessage  {Str = 548}         -- "The Master teacher in the ways of Body Magic, Brother Bombah, can be found in the swampy regions of Tatalia.  His home is somewhere in the southern region."
  1:  Set  {"AutonotesBits", Value = 162}         -- ""
end

event 350  -- "Tempus"
  0:  SetMessage  {Str = 549}         -- "The Grandmaster teacher in the ways of Body Magic, Tempus, can be found in the elven territory of Avlee.  His home is on an island somewhere in the central bay."
  1:  Set  {"AutonotesBits", Value = 163}         -- ""
end

event 351  -- "Samuel Benson"
  0:  SetMessage  {Str = 550}         -- "The Master of the Identify Item skill, Samuel Benson, can be found on a ridge in the central region of the Bracada desert."
  1:  Set  {"AutonotesBits", Value = 164}         -- ""
end

event 352  -- "Payge Blueswan"
  0:  SetMessage  {Str = 551}         -- "The Grandmaster of the Identify Item skill, Payge Blueswan, can be found in the elven territory of Tularean Forest.  His home is just northeast of the elven city of Pierpont."
  1:  Set  {"AutonotesBits", Value = 165}         -- ""
end

event 353  -- "Bethold Caverhill"
  0:  SetMessage  {Str = 552}         -- "The Master of the Merchant skill, Berthold Caverhill, can be found on the eastern most island of the Evenmorn Islands."
  1:  Set  {"AutonotesBits", Value = 166}         -- ""
end

event 354  -- "Brigham the Frugal"
  0:  SetMessage  {Str = 553}         -- "The Grandmaster of the Merchant skill, Brigham the Frugal, can be found in a tower in the Bracada desert, on a ridge in the northern region."
  1:  Set  {"AutonotesBits", Value = 167}         -- ""
end

event 355  -- "Thomas Moore"
  0:  SetMessage  {Str = 554}         -- "The Master teacher of the Repair Item Skill, Thomas Moore, can be found in the swampy delta of the southern region of Tatalia."
  1:  Set  {"AutonotesBits", Value = 168}         -- ""
end

event 356  -- "Gareth the Fixer"
  0:  SetMessage  {Str = 555}         -- "The Grandmaster of the Repair Item Skill, Gareth the Fixer, teaches from his home in the capitol city of Steadwick in Erathia."
  1:  Set  {"AutonotesBits", Value = 169}         -- ""
end

event 357  -- "Wanda Foestryke"
  0:  SetMessage  {Str = 556}         -- "The Master of the of the art of Body Building, Wanda Foestryke, can be found in the goblin village in eastern DeyJa Moor."
  1:  Set  {"AutonotesBits", Value = 170}         -- ""
end

event 358  -- "Evandar Thomas"
  0:  SetMessage  {Str = 557}         -- "The Grandmaster of the Body Building skill, Evander Thomas, makes his home in the eastern regions of Nighon."
  1:  Set  {"AutonotesBits", Value = 171}         -- ""
end

event 359  -- "Tessa Greensward"
  0:  SetMessage  {Str = 558}         -- "The Master of Meditation, Tessa Greensward, can be found on a ridge in the southeast region of the Bracada desert."
  1:  Set  {"AutonotesBits", Value = 172}         -- ""
end

event 360  -- "Kaine"
  0:  SetMessage  {Str = 559}         -- "The Grandmaster of Meditation, Kaine, can be found in the elven territory of Avlee.  His home is on an island somewhere in the central bay."
  1:  Set  {"AutonotesBits", Value = 173}         -- ""
end

event 361  -- "Garret Dotes"
  0:  SetMessage  {Str = 560}         -- "The Master of the Perception Skill, Garret Dotes, can be found in the elven area of the Tularean Forest.  His home is in the Elven city of Pierpont."
  1:  Set  {"AutonotesBits", Value = 174}         -- ""
end

event 362  -- "Petra Cleareye"
  0:  SetMessage  {Str = 561}         -- "The Grandmaster of the Skill of Perception, Petra Cleareye, can be found in the city in the northwest region of the Deyja."
  1:  Set  {"AutonotesBits", Value = 175}         -- ""
end

event 363  -- "Lenord Skinner"
  0:  SetMessage  {Str = 562}         -- "The Master of Disarm Trap Skill, Lenord Skinner, lives on a ridge, south of Harmondale, overlooking the city."
  1:  Set  {"AutonotesBits", Value = 176}         -- ""
end

event 364  -- "Silk Quicktoungue"
  0:  SetMessage  {Str = 563}         -- "The Grandmaster of the Disarm Trap Skill, Silk Quicktoungue, makes his home in the southern region of Nighon."
  1:  Set  {"AutonotesBits", Value = 177}         -- ""
end

event 365  -- "Oberic Crane"
  0:  SetMessage  {Str = 564}         -- "The Master of the Dodging Skill, Oberic Crane, can be found on the eastern most island of the Evenmorn Islands"
  1:  Set  {"AutonotesBits", Value = 178}         -- ""
end

event 366  -- "Kenneth Wain"
  0:  SetMessage  {Str = 565}         -- "The Grandmaster of the Dodging Skill, Kenneth Wain, can be found in the capitol city of Steadwick, in Erathia."
  1:  Set  {"AutonotesBits", Value = 179}         -- ""
end

event 367  -- "Ulbrecht the Brawler"
  0:  SetMessage  {Str = 566}         -- "The Master of Unarmed Combat, Ulbrecht the Brawler, can be found on the eastern most island of the Evenmorn Islands."
  1:  Set  {"AutonotesBits", Value = 180}         -- ""
end

event 368  -- "Norris "
  0:  SetMessage  {Str = 567}         -- "The Grandmaster of Unarmed Combat, Norris, can be found in the capitol city of Steadwick, in Erathia."
  1:  Set  {"AutonotesBits", Value = 181}         -- ""
end

event 369  -- "Jeni Swiftfoot"
  0:  SetMessage  {Str = 568}         -- "The Master instructor of the Identify Monster Skill, Jeni Swiftfoot, lives in the elven territory of Avlee.  Her home is in the city in the northeast."
  1:  Set  {"AutonotesBits", Value = 182}         -- ""
end

event 370  -- "Raven the Hunter"
  0:  SetMessage  {Str = 569}         -- "The Grandmaster of the Identify Monster Skill, Raven the Hunter, can be found in a small village to the south of Harmondale."
  1:  Set  {"AutonotesBits", Value = 183}         -- ""
end

event 371  -- "Paula Brightspear"
  0:  SetMessage  {Str = 570}         -- "The Master tutor of the Armsmaster Skill, Paula Brightspear, lives in the elven territory of Avlee.  Her home is in the city in the northeast."
  1:  Set  {"AutonotesBits", Value = 184}         -- ""
end

event 372  -- "Lasiter the Slayer"
  0:  SetMessage  {Str = 571}         -- "The Grandmaster of the Armsmaster Skill, Lasiter the Slayer, makes his home in the eastern region of Eeofol."
  1:  Set  {"AutonotesBits", Value = 185}         -- ""
end

event 373  -- "Leane Shadowrunner"
  0:  SetMessage  {Str = 572}         -- "The Master tutor of the Stealing Skill, Leane Shadowrunner, makes her home in the goblin village in the eastern region of the Deyja."
  1:  Set  {"AutonotesBits", Value = 186}         -- ""
end

event 374  -- "Everil Nightwalker"
  0:  SetMessage  {Str = 573}         -- "The Grandmaster teacher of the art of Stealing, Everil Nightwalker, can be found in the swampy delta of the southern region of Tatalia."
  1:  Set  {"AutonotesBits", Value = 187}         -- ""
end

event 375  -- "Elzbet Winterspoon"
  0:  SetMessage  {Str = 574}         -- "The Master of Alchemy, Elzbet Winterspoon, can be found in the western region of Nighon."
  1:  Set  {"AutonotesBits", Value = 188}         -- ""
end

event 376  -- "Lucid Apple"
  0:  SetMessage  {Str = 575}         -- "The Grandmaster instructor of Alchemy, Lucid Apple, can be found in the elven territory of Avlee.  His home is on an island somewhere in the central bay."
  1:  Set  {"AutonotesBits", Value = 189}         -- ""
end

event 377  -- "Dorothy Senjac"
  0:  SetMessage  {Str = 576}         -- "The Master of Learning, Dorothy Senjac, can be found in the southeast region of Nighon."
  1:  Set  {"AutonotesBits", Value = 190}         -- ""
end

event 378  -- "William Davies"
  0:  SetMessage  {Str = 577}         -- "The Grandmaster of Learning, William Smithson, instructs from his home on the eastern island of the Evenmorn Islands."
  1:  Set  {"AutonotesBits", Value = 191}         -- ""
end

event 379  -- "Helena Morningstar"
  0:  SetMessage  {Str = 578}         -- "The Master of Light Magic, Helena Mornigstar, can be found in the cloud city of Celeste!"
  1:  Set  {"AutonotesBits", Value = 192}         -- ""
end

event 380  -- "Gavin Magnus"
  0:  SetMessage  {Str = 579}         -- "The Grand Master of Light Magic can be found in the wizards castle, Castle Lambent."
  1:  Set  {"AutonotesBits", Value = 193}         -- ""
end

event 381  -- "Seth Darkenmore"
  0:  SetMessage  {Str = 580}         -- "The Master of Dark, Seth Darkenmore, can be found in The Pit beneath Deyja!"
  1:  Set  {"AutonotesBits", Value = 194}         -- ""
end

event 382  -- "Archibald"
  0:  SetMessage  {Str = 581}         -- "The Grand Master of Dark Magic can be found in the necromancer castle, Castle Gloaming.  At times Archibald has been know to take the journey to Clankers Lab."
  1:  Set  {"AutonotesBits", Value = 195}         -- ""
end

event 383  -- "Empty Barrel"
  0:  StatusText  {Str = 582}         -- "Empty Barrel"
end

event 384  -- "Red Barrel"
  0:  StatusText  {Str = 583}         -- "+2 Might permanent"
  1:  Add  {"BaseMight", Value = 2}
  2:  Set  {"AutonotesBits", Value = 33}         -- ""
  3:  ChangeEvent  {NewEvent = 383}         -- "Empty Barrel"
end

event 385  -- "Yellow Barrel"
  0:  StatusText  {Str = 584}         -- "+2 Accuracy permanent"
  1:  Add  {"BaseAccuracy", Value = 2}
  2:  Set  {"AutonotesBits", Value = 37}         -- ""
  3:  ChangeEvent  {NewEvent = 383}         -- "Empty Barrel"
end

event 386  -- "Blue Barrel"
  0:  StatusText  {Str = 585}         -- "+2 Personality permanent"
  1:  Add  {"BasePersonality", Value = 2}
  2:  Set  {"AutonotesBits", Value = 35}         -- ""
  3:  ChangeEvent  {NewEvent = 383}         -- "Empty Barrel"
end

event 387  -- "Orange Barrel"
  0:  StatusText  {Str = 586}         -- "+2 Intellect permanent"
  1:  Add  {"BaseIntellect", Value = 2}
  2:  Set  {"AutonotesBits", Value = 34}         -- ""
  3:  ChangeEvent  {NewEvent = 383}         -- "Empty Barrel"
end

event 388  -- "Green Barrel"
  0:  StatusText  {Str = 587}         -- "+2 Endurance permanent"
  1:  Add  {"BaseEndurance", Value = 2}
  2:  Set  {"AutonotesBits", Value = 36}         -- ""
  3:  ChangeEvent  {NewEvent = 383}         -- "Empty Barrel"
end

event 389  -- "Purple Barrel"
  0:  StatusText  {Str = 588}         -- "+2 Speed permanent"
  1:  Add  {"BaseSpeed", Value = 2}
  2:  Set  {"AutonotesBits", Value = 38}         -- ""
  3:  ChangeEvent  {NewEvent = 383}         -- "Empty Barrel"
end

event 390  -- "White Barrel"
  0:  StatusText  {Str = 589}         -- "+2 Luck permanent"
  1:  Add  {"BaseLuck", Value = 2}
  2:  Set  {"AutonotesBits", Value = 39}         -- ""
  3:  ChangeEvent  {NewEvent = 383}         -- "Empty Barrel"
end

event 391  -- "Empty Cauldron"
  0:  StatusText  {Str = 590}         -- "Empty Cauldron"
end

event 392  -- "Steaming Cauldron"
  0:  StatusText  {Str = 591}         -- "+2 Fire Resistance permanent"
  1:  Add  {"FireResistance", Value = 2}
  2:  Set  {"AutonotesBits", Value = 40}         -- ""
  3:  ChangeEvent  {NewEvent = 391}         -- "Empty Cauldron"
end

event 393  -- "Frosty Cauldron"
  0:  StatusText  {Str = 592}         -- "+2 Water Resistance permanent"
  1:  Add  {"WaterResistance", Value = 2}
  2:  Set  {"AutonotesBits", Value = 41}         -- ""
  3:  ChangeEvent  {NewEvent = 391}         -- "Empty Cauldron"
end

event 394  -- "Shocking Cauldron"
  0:  StatusText  {Str = 593}         -- "+2 Air Resistance permanent"
  1:  Add  {"AirResistance", Value = 2}
  2:  Set  {"AutonotesBits", Value = 42}         -- ""
  3:  ChangeEvent  {NewEvent = 391}         -- "Empty Cauldron"
end

event 395  -- "Dirty Cauldron"
  0:  StatusText  {Str = 594}         -- "+2 Earth Resistance permanent"
  1:  Add  {"EarthResistance", Value = 2}
  2:  Set  {"AutonotesBits", Value = 43}         -- ""
  3:  ChangeEvent  {NewEvent = 391}         -- "Empty Cauldron"
end

event 396  -- "Trash Heap"
  0:  RandomGoTo  {jumpA = 1, jumpB = 6, jumpC = 11, jumpD = 0, jumpE = 0, jumpF = 0}
  1:  Cmp  {"PerceptionSkill", Value = 1,   jump = 4}
  2:  Set  {"DiseasedGreen", Value = 0}
  3:  StatusText  {Str = 595}         -- "Diseased!"
  4:  GiveItem  {Strength = 1, Type = const.ItemType.Armor_, Id = 0}
  5:  GoTo  {jump = 15}

  6:  Cmp  {"PerceptionSkill", Value = 1,   jump = 9}
  7:  Set  {"DiseasedGreen", Value = 0}
  8:  StatusText  {Str = 595}         -- "Diseased!"
  9:  GiveItem  {Strength = 2, Type = const.ItemType.Armor_, Id = 0}
  10: GoTo  {jump = 15}

  11: Cmp  {"PerceptionSkill", Value = 1,   jump = 14}
  12: Set  {"DiseasedYellow", Value = 0}
  13: StatusText  {Str = 595}         -- "Diseased!"
  14: GiveItem  {Strength = 3, Type = const.ItemType.Armor_, Id = 0}
  15: ChangeEvent  {NewEvent = 411}         -- "Trash Heap"
end

event 397  -- "Trash Heap"
  0:  RandomGoTo  {jumpA = 1, jumpB = 6, jumpC = 11, jumpD = 0, jumpE = 0, jumpF = 0}
  1:  Cmp  {"PerceptionSkill", Value = 1,   jump = 4}
  2:  Set  {"DiseasedGreen", Value = 0}
  3:  StatusText  {Str = 595}         -- "Diseased!"
  4:  GiveItem  {Strength = 1, Type = const.ItemType.Weapon_, Id = 0}
  5:  GoTo  {jump = 15}

  6:  Cmp  {"PerceptionSkill", Value = 1,   jump = 9}
  7:  Set  {"DiseasedGreen", Value = 0}
  8:  StatusText  {Str = 595}         -- "Diseased!"
  9:  GiveItem  {Strength = 2, Type = const.ItemType.Weapon_, Id = 0}
  10: GoTo  {jump = 15}

  11: Cmp  {"PerceptionSkill", Value = 1,   jump = 14}
  12: Set  {"DiseasedYellow", Value = 0}
  13: StatusText  {Str = 595}         -- "Diseased!"
  14: GiveItem  {Strength = 3, Type = const.ItemType.Weapon_, Id = 0}
  15: ChangeEvent  {NewEvent = 411}         -- "Trash Heap"
end

event 398  -- "Trash Heap"
  0:  RandomGoTo  {jumpA = 1, jumpB = 6, jumpC = 11, jumpD = 0, jumpE = 0, jumpF = 0}
  1:  Cmp  {"PerceptionSkill", Value = 1,   jump = 4}
  2:  Set  {"DiseasedGreen", Value = 0}
  3:  StatusText  {Str = 595}         -- "Diseased!"
  4:  GiveItem  {Strength = 1, Type = const.ItemType.Misc, Id = 0}
  5:  GoTo  {jump = 15}

  6:  Cmp  {"PerceptionSkill", Value = 1,   jump = 9}
  7:  Set  {"DiseasedGreen", Value = 0}
  8:  StatusText  {Str = 595}         -- "Diseased!"
  9:  GiveItem  {Strength = 2, Type = const.ItemType.Misc, Id = 0}
  10: GoTo  {jump = 15}

  11: Cmp  {"PerceptionSkill", Value = 1,   jump = 14}
  12: Set  {"DiseasedYellow", Value = 0}
  13: StatusText  {Str = 595}         -- "Diseased!"
  14: GiveItem  {Strength = 3, Type = const.ItemType.Misc, Id = 0}
  15: ChangeEvent  {NewEvent = 411}         -- "Trash Heap"
end

event 411  -- "Trash Heap"
  0:  RandomGoTo  {jumpA = 1, jumpB = 5, jumpC = 0, jumpD = 0, jumpE = 0, jumpF = 0}
  1:  Cmp  {"PerceptionSkill", Value = 1,   jump = 5}
  2:  Set  {"DiseasedGreen", Value = 0}
  3:  StatusText  {Str = 595}         -- "Diseased!"
  4:  Exit  {}

  5:  StatusText  {Str = 596}         -- "Nothing Here"
end

event 412  -- "Campfire"
  0:  Add  {"Food", Value = 2}
  1:  Cmp  {"PerceptionSkill", Value = 1,   jump = 4}
  2:  ChangeEvent  {NewEvent = 0}
  3:  Exit  {}

  4:  GiveItem  {Strength = 2, Type = const.ItemType.Ring_, Id = 0}
  5:  ChangeEvent  {NewEvent = 0}
end

event 413  -- "Campfire"
  0:  Add  {"Food", Value = 1}
  1:  Cmp  {"PerceptionSkill", Value = 1,   jump = 4}
  2:  ChangeEvent  {NewEvent = 0}
  3:  Exit  {}

  4:  GiveItem  {Strength = 1, Type = const.ItemType.Ring_, Id = 0}
  5:  ChangeEvent  {NewEvent = 0}
end

event 414  -- "Food Bowl"
  0:  Add  {"Inventory", Value = 630}         -- "Red Apple"
  1:  ChangeEvent  {NewEvent = 0}
end

event 415  -- "Empty Cask"
  0:  StatusText  {Str = 599}         -- "Empty Cask"
end

event 416  -- "Cask"
  0:  RandomGoTo  {jumpA = 1, jumpB = 1, jumpC = 1, jumpD = 8, jumpE = 8, jumpF = 8}
  1:  RandomGoTo  {jumpA = 2, jumpB = 2, jumpC = 2, jumpD = 5, jumpE = 5, jumpF = 5}
  2:  Set  {"PoisonedGreen", Value = 0}
  3:  StatusText  {Str = 597}         -- "Poisoned!"
  4:  GoTo  {jump = 17}

  5:  Set  {"Drunk", Value = 0}
  6:  StatusText  {Str = 598}         -- "Drunk!"
  7:  GoTo  {jump = 17}

  8:  RandomGoTo  {jumpA = 9, jumpB = 9, jumpC = 11, jumpD = 11, jumpE = 13, jumpF = 15}
  9:  Add  {"Inventory", Value = 202}         -- "Vial of Troll Blood"
  10: GoTo  {jump = 17}

  11: Add  {"Inventory", Value = 217}         -- "Vial of Ooze Endoplasm"
  12: GoTo  {jump = 17}

  13: Add  {"Inventory", Value = 218}         -- "Mercury"
  14: GoTo  {jump = 17}

  15: Add  {"Inventory", Value = 214}         -- "Vial of Devil Ichor"
  16: GoTo  {jump = 17}

  17: ChangeEvent  {NewEvent = 415}         -- "Empty Cask"
end

event 417  -- "Mushroom"
  0:  Add  {"Inventory", Value = 215}         -- "Mushroom"
  1:  ChangeEvent  {NewEvent = 0}
end

event 418  -- "Lord Markham"
  0:  SetMessage  {Str = 601}         -- "So YOU'RE the ones that won Lord Markham's contest!  How do you like your winnings so far?  Had enough winning?  If I were you, I'd give him a piece of my mind!  His mansion is in Tatalia, near the wharf."
end

event 419  -- "The Master Thief"
  0:  SetMessage  {Str = 602}         -- "Watch your wallet while you're here, my friends--Steadwick abounds in thieves.  As a matter of fact, we are the world capital of thieves!  It's common knowledge that Bill Lasker, the Master Thief, lives in the sewers beneath Steadwick."
end

event 420  -- "Watchtowers"
  0:  CanShowTopic.Cmp  {"QBits", Value = 196,   jump = 4}         -- Find second entrance to Watchtower6
  1:  CanShowTopic.Cmp  {"QBits", Value = 19,   jump = 4}         -- "Go to Watchtower 6 in the Deyja Moors, and move the weight from the top of the tower to the bottom of the tower.  Then return to William Lasker in the Erathian Sewers."
  2:  CanShowTopic.Set  {Visible = false}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = true}
  5:  CanShowTopic.Exit  {}

  6:  Cmp  {"QBits", Value = 196,   jump = 9}         -- Find second entrance to Watchtower6
  7:  SetMessage  {Str = 603}         -- "Back when I was in the army, I was assigned to scout out the watchtowers in Deyja.  <chuckling> It's no good trying to go through the front door, so I usually looked around for another way in.  Those Necromancers are so cowardly, they always have an escape route.  And a way out is also a way in..."
  8:  Exit  {}

  9:  SetMessage  {Str = 644}         -- "Glad you found the way in the back door.  You probably avoided a really nasty ambush that way.  I hope my advice was useful!"
end

event 421  -- "Bill Lasker"
  0:  SetMessage  {Str = 604}         -- "Bill Lasker may be a criminal, but he has worked for the Crown from time to time.  Special missions, official denials of involvement, spying…that sort of stuff.  Quite a few unusual events can be tied to Bill, but none to the Crown.  Seriously, don't you think the Queen's men could find and arrest one man, even if he was hiding in the sewer?"
end

event 422  -- "Lady Carmine"
  0:  CanShowTopic.Cmp  {"Awards", Value = 14,   jump = 5}         -- "Promoted to Assassin"
  1:  CanShowTopic.Cmp  {"Awards", Value = 15,   jump = 5}         -- "Promoted to Honorary Assassin"
  2:  CanShowTopic.Cmp  {"QBits", Value = 21,   jump = 5}         -- "Go to the Celestial Court in Celeste and kill Lady Eleanor Carmine.  Return with proof to Seknit Undershadow in the Deyja Moors."
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}
  5:  CanShowTopic.Set  {Visible = true}
  6:  CanShowTopic.Exit  {}

  7:  Cmp  {"Inventory", Value = 540,   jump = 12}         -- "Lady Carmine's Dagger"
  8:  Cmp  {"Awards", Value = 14,   jump = 12}         -- "Promoted to Assassin"
  9:  Cmp  {"Awards", Value = 15,   jump = 12}         -- "Promoted to Honorary Assassin"
  10: SetMessage  {Str = 605}         -- "You want to know about that traitor, Carmine?  Well, she used to work for the diplomatic corps, until she went soft and signed up with the goody two-shoes wizards.  Now she walks the streets of Celeste freely, without a care in the world for the people she left behind.  Something bad will happen to her soon, mark my words!"
  11: Exit  {}

  12: SetMessage  {Str = 645}         -- "So…what goes around comes around, eh?  Good job with that Carmine traitor!"
end

event 423  -- "Assasins"
  0:  SetMessage  {Str = 606}         -- "Looking for ""work""?  You can find the Master Assassin somewhere in the Pit.  He'll have something for you.  There's always someone or something that needs killing, that's for certain."
end

event 424  -- "Wromthrax the Heartless"
  0:  CanShowTopic.Cmp  {"Awards", Value = 40,   jump = 5}         -- "Promoted to Crusader"
  1:  CanShowTopic.Cmp  {"Awards", Value = 41,   jump = 5}         -- "Promoted to Honorary Crusader"
  2:  CanShowTopic.Cmp  {"QBits", Value = 22,   jump = 5}         -- "Kill Wromthrax the Heartless in his cave in Tatalia, then talk to Sir Charles Quixote."
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}
  5:  CanShowTopic.Set  {Visible = true}
  6:  CanShowTopic.Exit  {}

  7:  Cmp  {"Awards", Value = 14,   jump = 11}         -- "Promoted to Assassin"
  8:  Cmp  {"Awards", Value = 15,   jump = 11}         -- "Promoted to Honorary Assassin"
  9:  SetMessage  {Str = 607}         -- "Until recently, our local dragon Wromthrax the Heartless has confined his depredations to the hills in the south--eating goats, farm animals, and stray dogs.  But he has developed a taste for elvish blood, and now hunts us as well.  If you should care to confront him, his cave is in the north, west of the Mercenary Guild in the mountains.  He isn't always there.  Be careful--he is mighty."
  10: Exit  {}

  11: SetMessage  {Str = 646}         -- "The dragon is fallen--and at your hands!  You are a hero!"
end

event 425  -- "Crusaders"
  0:  SetMessage  {Str = 608}         -- "What, you wanna be a crusader too?  This town is filling up with them, I swear!  Well, there's a crazy man living in the back of a building near the center of town.  People keep trying to sign up with him, and he keeps rejecting them.  Good luck."
end

event 426  -- "The Fairest of them all"
  0:  SetMessage  {Str = 609}         -- "Just a minute, let me check.  Mirror, mirror, on the wall… <the witch peers into her mirror for a few minutes, then sighs> It's still Alice Hargreaves.  She lives in Castle Gryphonheart.  She's quite a noble beauty, that girl is!  Takes me back to my youth, this one does."
end

event 427  -- "Villains"
  0:  SetMessage  {Str = 610}         --[[ "One of our finest, most upstanding citizens is William Setag, considered by some to be the most black hearted villain alive.  As a matter of fact, he's one of our best agents.  Wizards and their ilk complain because they've been on the receiving end of his schemes too many times-- but he's about the best there is in his profession.  

If you're looking for employment, go see him.  His tower is on the north shore of Deyja at a rather inaccessible point.  He doesn't like visitors, but he should be glad to see more students turn up at his door." ]]
end

event 428  -- "Monk Training"
  0:  SetMessage  {Str = 611}         -- "If you're looking for a teacher to begin serious monk training, speak with Bartholomew Hume--you can find him in the village south of the town of Harmondale."
end

event 429  -- "Medusas"
  0:  SetMessage  {Str = 617}         -- "There is a breed of Medusa infesting the Red Dwarf Mines that is immune to magic.  These monsters are a real terror!  I can only thank the Gods that these creatures haven't escaped the mine.  What would we do then, beat them to death with our staves?"
end

event 430  -- "Temple of Baa"
  0:  CanShowTopic.Cmp  {"Awards", Value = 24,   jump = 5}         -- "Promoted to Master"
  1:  CanShowTopic.Cmp  {"Awards", Value = 25,   jump = 5}         -- "Promoted to Honorary Master"
  2:  CanShowTopic.Cmp  {"QBits", Value = 28,   jump = 5}         -- "Go to the Temple of Baa in Avlee and kill the High Priest of Baa, then return to Bartholomew Hume in Harmondale."
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}
  5:  CanShowTopic.Set  {Visible = true}
  6:  CanShowTopic.Exit  {}

  7:  Cmp  {"Inventory", Value = 530,   jump = 12}         -- "Cloak of the Sheep"
  8:  Cmp  {"Awards", Value = 24,   jump = 12}         -- "Promoted to Master"
  9:  Cmp  {"Awards", Value = 25,   jump = 12}         -- "Promoted to Honorary Master"
  10: SetMessage  {Str = 613}         -- "A few years back, a weird cult called the Temple of Baa moved into the area.  At first they seemed popular, what with their free offers of healing, but it soon became clear they were devoted to darkness.  No one goes up there very much, now, and it seems that whatever evil gods were backing them have withdrawn their support.  But they're up there still, lurking in the shadows.  Creepy."
  11: Exit  {}

  12: SetMessage  {Str = 647}         -- "The Baa cult is gone?  Well that IS good news!  Everyone is in your debt, whether they know it or not.  "
end

event 431  -- "Missing Sheep"
  0:  CanShowTopic.Cmp  {"Awards", Value = 24,   jump = 5}         -- "Promoted to Master"
  1:  CanShowTopic.Cmp  {"Awards", Value = 25,   jump = 5}         -- "Promoted to Honorary Master"
  2:  CanShowTopic.Cmp  {"QBits", Value = 28,   jump = 5}         -- "Go to the Temple of Baa in Avlee and kill the High Priest of Baa, then return to Bartholomew Hume in Harmondale."
  3:  CanShowTopic.Set  {Visible = false}
  4:  CanShowTopic.Exit  {}
  5:  CanShowTopic.Set  {Visible = true}
  6:  CanShowTopic.Exit  {}

  7:  Cmp  {"Inventory", Value = 530,   jump = 12}         -- "Cloak of the Sheep"
  8:  Cmp  {"Awards", Value = 24,   jump = 12}         -- "Promoted to Master"
  9:  Cmp  {"Awards", Value = 25,   jump = 12}         -- "Promoted to Honorary Master"
  10: SetMessage  {Str = 614}         -- "Lots of sheep have gone missing since the Baa cult moved in--and I mean lots.  No doubt they were taken to the Baa temple for sacrifice.  I'm going to go broke if someone doesn't do something about those cultists!"
  11: Exit  {}

  12: SetMessage  {Str = 648}         -- "Glad to hear the Baa cult has gone missing, instead of my sheep!  Good job!"
end

event 432  -- "Ciphers"
  0:  SetMessage  {Str = 615}         -- "Ssspies abound in places like this, my friendsss.  If you wish your letters and communiqués to remain sssecret, you should use a cipher when you write.  There is a book in the Castle library that will explain everything, my friendsss."
end

event 433  -- "The nature of ooze"
  0:  SetMessage  {Str = 616}         --[[ "Eight years ago, we sent a team of scholars to what is now the Red Dwarf Mine to study the strange creatures that would occasionally show up there.  

The first thing we noticed was that Ooze ectoplasm makes an excellent potion catalyst.  The second was that ooze just can't be physically damaged--they split apart or squish, then run back together. If you want to kill one, you'll have to do it with magic." ]]
end

event 434  -- "Medusas"
  0:  SetMessage  {Str = 617}         -- "There is a breed of Medusa infesting the Red Dwarf Mines that is immune to magic.  These monsters are a real terror!  I can only thank the Gods that these creatures haven't escaped the mine.  What would we do then, beat them to death with our staves?"
end

event 435  -- "Titans' Stronghold"
  0:  SetMessage  {Str = 618}         -- "If you head south past the Wyvern Plains, don't go knocking at the door of that huge fortress you'll see standing in the middle of the water.  It's the Titan's Stronghold, and they don't much like visitors."
end

event 436  -- "The Arena"
  0:  SetMessage  {Str = 619}         -- "Arena fighting is available to anyone who wants to practice against any kind of opponent.  You can get to the arena by visiting a stable on any Sunday and asking them to take you there.  "
end

event 437  -- "Arena Championships"
  0:  SetMessage  {Str = 620}         -- "Arena Champships are held on each Sunday.  They are open to all--but be careful!  Your opponents are chosen by the Arena management, not you!"
end

event 438  -- "Haunted Mansion"
  0:  SetMessage  {Str = 621}         -- "Every graveyard or ancestral burial place seems to have a haunted house nearby--and ours is no exception.  There is a mansion near one of the plateaus on the surface in the northwest.  It is most certainly haunted."
end

event 439  -- "Ghosts"
  0:  SetMessage  {Str = 622}         -- "Fear the touch of the Ghost as you fear the loss of your life.  It inflicts terrible spiritual wounds and drains your youth before your eyes!"
end

event 440  -- "Secret passage"
  0:  SetMessage  {Str = 623}         -- "A few wars ago, my great grandfather worked on an escape tunnel from the Elvish castle to the Tularean Caves.  I don't think it's ever been used--no attack on the castle has ever brought it down--but it sure is an interesting piece of history, don't you think?"
end

event 441  -- "Faeries"
  0:  Cmp  {"QBits", Value = 197,   jump = 3}         -- Entered Faerie Mound
  1:  SetMessage  {Str = 624}         -- "They say that elves are faeries, but in truth we are only distantly related.  The true faeries don't live in civilization, and they're just like the stories say--playful, cruel, magical, and dangerous.  But if you really want to meet them, you could visit them in their Hall under the Hill, as they call it.  It is just outside of the village, to the North and West.  It will be challenging to get to the front door... "
  2:  Exit  {}

  3:  SetMessage  {Str = 649}         -- "I'm impressed--very few actually make it inside the fairy mound, or get very far."
end

event 442  -- "Mad Forest"
  0:  Cmp  {"Inventory", Value = 600,   jump = 6}         -- "Heart of the Wood"
  1:  Cmp  {"Awards", Value = 30,   jump = 6}         -- "Promoted to Ranger Lord"
  2:  Cmp  {"Awards", Value = 31,   jump = 6}         -- "Promoted to Honorary Ranger Lord"
  3:  Cmp  {"Awards", Value = 61,   jump = 6}         -- "Retrieved the Heart of the Wood"
  4:  SetMessage  {Str = 625}         -- "A while ago, I saw some men come to the Tularean Forest at night with axes and torches, following some sort of map.  When they left, they were laughing and happy.  It looked like they were carrying a big green rock.  My brother says they were a band of mercenaries from Tatalia.  Anyway, the next day was when the forest went mad.  It's too dangerous to go there now."
  5:  Exit  {}

  6:  SetMessage  {Str = 650}         -- "The forest is much safer now, thanks you to!  The oldest tree is very happy with you, and has included you in its history recitals."
end

event 443  -- "Oldest Tree"
  0:  SetMessage  {Str = 626}         -- "The Tularean Forest is so old that it has developed a mind…sort of.  The forest is vaguely aware of who walks through it, but only one part of the forest can communicate with people.  That's the oldest tree.  If you want to have a very long and slow conversation, it will be happy to oblige.  Look for it on an island to the south east of the forest.  It's larger than the rest of the trees.  You can't miss it."
end

event 444  -- "Bounty Hunting"
  0:  SetMessage  {Str = 627}         -- "Anyone needing to earn some spare cash can visit a town hall in any major city to pick up a bounty hunting assignment.  City councils are always fearful of the latest man eating monster or bandit or mad wizard, and set bounties on the creature that is bothering them most this month.  There's no rhyme or reason to their choices, so don't try to figure it out.  They often pay quite well."
end

event 445  -- "Professional Bounty Hunting"
  0:  SetMessage  {Str = 628}         -- "If you ever get tired of amateur bounty hunts, and want to advance your career, speak with Ebednezer Sower in Avlee.  He only teaches followers of the shadow path, though."
end

event 446  -- "Tidewater Caverns"
  0:  SetMessage  {Str = 629}         -- "Pirates been operating out of the tidewater caverns for twenty years.  They're not Regnans, and they aren't part of Bill Lasker's men, but they're still pretty mean.  You want to get in there, just get yourself out to the islands to the west."
end

event 447  -- "Evenmorn Islands"
  0:  Cmp  {"Inventory", Value = 683,   jump = 5}         -- "Map to Evenmorn Island"
  1:  Cmp  {"Awards", Value = 62,   jump = 5}         -- "Promoted to Priest"
  2:  Cmp  {"Awards", Value = 63,   jump = 5}         -- "Promoted to Honorary Priest"
  3:  SetMessage  {Str = 630}         -- "Evenmorn Island isn't lost, so much as hard to get to.  It is surrounded by treacherous reefs, sandbars, whirlpools, and sharks.  If it's dangerous, the Island is surrounded by it.  There are only one or two safe ways in, and the map for those ways was stolen by pirates during the chaos of the recent wars.  They probably still have the map in their caves.  "
  4:  Exit  {}

  5:  SetMessage  {Str = 651}         -- "Oh, so the map is found?  What will you do with your newfound treasure?  Share it, I hope!"
end

event 448  -- "Reef Maps"
  0:  Cmp  {"Inventory", Value = 683,   jump = 5}         -- "Map to Evenmorn Island"
  1:  Cmp  {"Awards", Value = 62,   jump = 5}         -- "Promoted to Priest"
  2:  Cmp  {"Awards", Value = 63,   jump = 5}         -- "Promoted to Honorary Priest"
  3:  SetMessage  {Str = 631}         -- "The boat captains would be happy to take any paying fare to Evenmorn island, but they don't have proper maps.  There's no way anyone is going to risk their ship in the reefs around the Island unless they have the map!"
  4:  Exit  {}

  5:  SetMessage  {Str = 652}         -- "Now that you have the map, I guess you'll be going there soon.  Be careful--they say the island is cursed!"
end

event 449  -- "The Curse"
  0:  SetMessage  {Str = 653}         -- "If you don't mind the swamp and fog, Evenmorn Island is a great place to live.  Of course, the Curse doesn't help--ghosts and skeletons roam the island freely--but other than that, the neighbors keep to themselves.  The Churches of the Sun and the Moon don't even fight each other very much anymore.  <Heh!> probably means they're running out of adherents..."
end

event 450  -- "Golem parts"
  0:  SetMessage  {Str = 632}         -- "Well, I don't have any golem parts--I never took that class--but there are students all over Bracada who have spare golem parts lying around.  They aren't worth anything unless you have them all, so they'll probably just give them to you for free."
end

event 451  -- "Golems"
  0:  SetMessage  {Str = 633}         -- "You see all those golems walking around Bracada?  Every single one of them was made by the School.  Not bad for students, eh?  They don't have much to say, but they're tough guardians and can tell when a follower of Darkness is near.  You should see them go into action when one of those Necromancers or Warlocks wanders into our lands.  Zowwwwwieeee!"
end

event 452  -- "Divine Intervention Book"
  0:  Cmp  {"Inventory", Value = 487,   jump = 5}         -- "Divine Intervention"
  1:  Cmp  {"Awards", Value = 76,   jump = 5}         -- "Promoted to Archmage"
  2:  Cmp  {"Awards", Value = 77,   jump = 5}         -- "Promoted to Honorary Archmage"
  3:  SetMessage  {Str = 634}         -- "Our astrologers have determined that the missing Divine Intervention text lies somewhere deep under the ground.  Under Deyja, to be precise.  They fear that the current incarnation of the text has fallen into the Breeding Pit--the Necromancer's version of our Proving Grounds.  Oh, what must we have done to offend the Gods so?  We will never retrieve the text from that forsaken place!"
  4:  Exit  {}

  5:  SetMessage  {Str = 654}         -- "Divine intervention has been found and copied?  A miracle!  I never expected to see it in my lifetime!  "
end

event 453  -- "Divine Intervention"
  0:  Cmp  {"Inventory", Value = 487,   jump = 5}         -- "Divine Intervention"
  1:  Cmp  {"Awards", Value = 76,   jump = 5}         -- "Promoted to Archmage"
  2:  Cmp  {"Awards", Value = 77,   jump = 5}         -- "Promoted to Honorary Archmage"
  3:  SetMessage  {Str = 635}         -- "The spell of Divine Intervention, the highest of the school of Light magic, has been missing for centuries.  It is a curse, we believe, for our lack of devotion and faith to the Light.  We struggle, and some go forth to find the spell, from time to time, but none have been successful.  Each time they find it, fate cruelly snatches it from our hands.  Our Grandmasters have been bereft of this final, great spell for as long as anyone alive can remember."
  4:  Exit  {}

  5:  SetMessage  {Str = 655}         -- "All the grandmasters are very pleased with you.  You have done our profession a great service!"
end

event 454  -- "Soul Jars"
  0:  SetMessage  {Str = 636}         -- "The only people in the world who make soul jars are the Warlocks of Nighon.  It is a secret of their profession--which is strange, since they have absolutely no use for them.  Still, we are forced to bargain for the jars in order to advance our craft.  Of course, we have wrested the jars from them, from time to time...but then they raise their prices in revenge.  It must be our fate to suffer so."
end

event 455  -- "The Rituals"
  0:  SetMessage  {Str = 637}         -- "Every Necromancer aspires to be a Lich one day.  All you need is a Soul Jar, knowledge of the Ritual, and the magical skill to survive the journey to the Land of the Dead and return.  The body withers while the soul lives on in a glorious state free from hunger, disease, and injury.  Only shallow and superficial people would mind what the Ritual does to one's appearance.  True practitioners hardly notice."
end

event 456  -- "Circle of stone"
  0:  Cmp  {"Awards", Value = 68,   jump = 4}         -- "Promoted to Great Druid"
  1:  Cmp  {"Awards", Value = 69,   jump = 4}         -- "Promoted to Honorary Great Druid"
  2:  SetMessage  {Str = 638}         -- "Three circles of stones were built by the Druids long ago.  Since hearing of their locations ruins ascension attempts for would be Great Druids, I can only give you a general clue--All are in the open, unhidden and bare, and all are distant from settlements.  To tell you more would spoil your Ascension."
  3:  Exit  {}

  4:  SetMessage  {Str = 656}         -- "Since you've discovered the circles on your own they have worked their magic on you.  I hope you will refrain from telling others of their whereabouts, as I have done for you."
end

event 457  -- "Summer Circle"
  0:  SetMessage  {Str = 639}         -- "Originally, there were four Circles of Stone, one for each Cardinal direction and season, but the Eastern Circle was destroyed somewhere in Nighon during the wars between the Churches of the Sun and the Moon."
end

event 458  -- "The graveyard"
  0:  SetMessage  {Str = 640}         -- "The graveyard does indeed hold the bones of the ancient King, but the hallowed land will curse any who disturb it.  I don't envy you this task.  Each grave you open will unleash its curse, and possibly some other trap.  Best be sure you're opening the correct grave when you begin to dig."
end

event 459  -- "Barrow Navigation"
  0:  SetMessage  {Str = 641}         -- "Though the barrows were built to deter thieves, a way was needed to navigate them during burials and ceremonies.  Near each of the gates you'll find a plaque.  These plaques are cryptic, but they will keep you from losing your way, as long as you use them.  No thief yet has realized their significance, so once they enter the barrows, they never leave."
end

event 460  -- "Land of the Titans"
  0:  SetMessage  {Str = 642}         -- "We built a tunnel leading from our Thunderfist Mountain to the Land of the Giants during the War.  It was there we discovered the Kreegan, and more titans and dragons then you can imagine.  I suppose one who's familiar is to be a dragon could find eggs in one of the dragon caves of that terrible land.  'Ware the mother..."
end

event 461  -- "The Mega Dragon"
  0:  SetMessage  {Str = 643}         -- "I've heard legends that there is a dragon in the Land of the Titans greater than any that have come before.  Lesser dragons and titans do battle on the slopes of the mountain in which its cave resides.  This dragon is so huge, and so mighty that the other dragons feed it for fear it will one day leave its cave and devour them all in its fury.  The dragons believe it is a god.  If that is so, imagine its treasure..."
end

event 462  -- "Quest"
  0:  SetMessage  {Str = 657}         -- "During the wars between the Temples of the Sun and Moon, three statuettes were stolen from the shrines in the Bracada Desert, Tatalia, and Avlee.  I represent a group of Druids that want these shrines back to their original form-- it is critical for their worship.  To this end, I am offering a substantial reward for anyone that will find the statuettes and place them on the shrines."
  1:  Set  {"QBits", Value = 200}         -- "Retrieve the three statuettes and place them on the shrines in the Bracada Desert, Tatalia, and Avlee, then return to Thom Lumbra in the Tularean Forest."
  2:  SetNPCTopic  {NPC = 288, Index = 0, Event = 463}         -- "Thom Lumbra" : "Quest"
end

event 463  -- "Quest"
  0:  Cmp  {"QBits", Value = 201,   jump = 2}         -- Placed item 617 in out14(statue)
  1:  GoTo  {jump = 5}

  2:  Cmp  {"QBits", Value = 202,   jump = 4}         -- Place item 618 in out13(statue)
  3:  GoTo  {jump = 5}

  4:  Cmp  {"QBits", Value = 203,   jump = 7}         -- Place item 619 in out06(statue)
  5:  SetMessage  {Str = 658}         -- "All three statuettes are not placed.  I cannot reward partial success.  Return when you have placed all three."
  6:  Exit  {}

  7:  SetMessage  {Str = 659}         -- "Great work!  The Druids are so pleased, they threw in a little extra for your fine performance.  Take this… you most certainly deserve it."
  8:  Add  {"Gold", Value = 50000}
  9:  Subtract  {"Reputation", Value = 10}
  10: ForPlayer  ("All")
  11: Subtract  {"QBits", Value = 200}         -- "Retrieve the three statuettes and place them on the shrines in the Bracada Desert, Tatalia, and Avlee, then return to Thom Lumbra in the Tularean Forest."
  12: Add  {"Experience", Value = 50000}
  13: Add  {"Awards", Value = 100}         -- "Found and placed all the statuettes"
  14: SetNPCGreeting  {NPC = 288, Greeting = 174}         -- "Thom Lumbra" : "Excellent work; my associates are quite pleased."
  15: SetNPCTopic  {NPC = 288, Index = 0, Event = 0}         -- "Thom Lumbra"
end

event 464  -- "Quest"
  0:  SetMessage  {Str = 660}         -- "As you may have already guessed, I'm a collector of fine art.  Currently, I am looking for a set of paintings, one of King Roland, one of his brother Archibald, and one of the angel statue in the courtyard of Castle Ironfist.  This set is of great value, and, as a collector, I'm willing to pay quite handsomely for it.  If you should gather the entire set of paintings bring them back to me and I'll be sure to compensate you well for your effort."
  1:  Set  {"QBits", Value = 204}         -- "Retrieve the three paintings and return them to Ferdinand Visconti in Tatalia."
  2:  SetNPCTopic  {NPC = 289, Index = 0, Event = 465}         -- "Ferdinand Visconti" : "Quest"
end

event 465  -- "Quest"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 621,   jump = 3}         -- "Angel Statue Painting"
  2:  GoTo  {jump = 6}

  3:  Cmp  {"Inventory", Value = 622,   jump = 5}         -- "Archibald Ironfist Painting"
  4:  GoTo  {jump = 6}

  5:  Cmp  {"Inventory", Value = 623,   jump = 8}         -- "Roland Ironfist Painting"
  6:  SetMessage  {Str = 662}         -- "Remember, I need the complete set of paintings-- they aren't worth much by themselves.  When you have the rest, bring them all to me."
  7:  Exit  {}

  8:  SetMessage  {Str = 663}         -- "Wonderful!  This set has eluded me for years!  You more than deserve the reward I promised; here, hopefully this will be sufficient."
  9:  Subtract  {"Inventory", Value = 621}         -- "Angel Statue Painting"
  10: Subtract  {"Inventory", Value = 622}         -- "Archibald Ironfist Painting"
  11: Subtract  {"Inventory", Value = 623}         -- "Roland Ironfist Painting"
  12: ForPlayer  ("Current")
  13: Add  {"Gold", Value = 50000}
  14: Subtract  {"Reputation", Value = 10}
  15: ForPlayer  ("All")
  16: Subtract  {"QBits", Value = 204}         -- "Retrieve the three paintings and return them to Ferdinand Visconti in Tatalia."
  17: Add  {"Experience", Value = 50000}
  18: Add  {"Awards", Value = 101}         -- "Retrieved the complete set of paintings"
  19: SetNPCGreeting  {NPC = 289, Greeting = 176}         -- "Ferdinand Visconti" : "Thank you for your assistance in completing my collection.  You have my gratitude forever!"
  20: SetNPCTopic  {NPC = 289, Index = 0, Event = 0}         -- "Ferdinand Visconti"
end

event 466  -- "Quest"
  0:  SetMessage  {Str = 664}         -- "To be declared ArcoMage Champion, you must win a game of ArcoMage in every tavern on, in, and under the continent of Erathia.  There are 13 such taverns sponsoring ArcoMage events.  When you have accomplished this, return to me to claim the prize."
  1:  Set  {"QBits", Value = 205}         -- "Win a game of Arcomage in all thirteen taverns, then return to Gina Barnes in Erathia."
  2:  SetNPCTopic  {NPC = 290, Index = 0, Event = 467}         -- "Gina Barnes" : "Quest"
end

event 467  -- "Quest"
  0:  Cmp  {"QBits", Value = 238,   jump = 3}         -- Won all Arcomage games
  1:  SetMessage  {Str = 665}         -- "You must claim a victory at ALL 13 taverns.  Until you do, you cannot be declared ArcoMage Champion."
  2:  Exit  {}

  3:  SetMessage  {Str = 666}         -- "Congratulations!  You have become the ArcoMage Champion!  The prize is waiting in the chest right outside my house."
  4:  Subtract  {"QBits", Value = 205}         -- "Win a game of Arcomage in all thirteen taverns, then return to Gina Barnes in Erathia."
  5:  Add  {"Gold", Value = 100000}
  6:  Subtract  {"Reputation", Value = 10}
  7:  ForPlayer  ("All")
  8:  Add  {"Experience", Value = 50000}
  9:  Add  {"QBits", Value = 244}         -- Finished ArcoMage Quest - Get the treasure
  10: Add  {"Awards", Value = 102}         -- "ArcoMage Champion"
  11: SetNPCGreeting  {NPC = 290, Greeting = 178}         -- "Gina Barnes" : "Welcome ArcoMage Champions!"
  12: SetNPCTopic  {NPC = 290, Index = 0, Event = 0}         -- "Gina Barnes"
end

event 468  -- "Stone City"
  0:  SetMessage  {Str = 669}         -- "People say the Dwarves live in the barren lands south of Harmondale, but that's not exactly true--They live UNDER them.  Look for their front gate in the center of the Barrow Downs where three bridges meet."
end

event 469  -- "Stone City"
  0:  SetMessage  {Str = 670}         -- "Ever since the Warlocks of Nighon tunneled through Stone City from their island, travelers have been asking to pass through the city to get to Nighon.  The Dwarf King hates this, and would like to charge a hefty fee for people seeking to enter Stone City.  He has not started charging however, fearing political and possible violent repercussions with the Warlocks of Nighon."
end

event 470  -- "Passage to Nighon"
  0:  SetMessage  {Str = 671}         -- "The Warlocks of Nighon live in Thunderfist Mountain--an extinct volcano on a large island a few miles from the mainland.  During the recent wars, the Warlocks tunneled through Stone City to transport their forces across the channel.  Those tunnels are still open and can be traversed."
end

event 471  -- "Warlock's Tunnels"
  0:  SetMessage  {Str = 672}         -- "During the War, the Warlocks tunneled from Nighon through Stone City to get to the mainland and seize territory.  Even though they were pushed back to their island by Erathia, the tunnels remain."
end

event 472  -- "Barrows"
  0:  SetMessage  {Str = 673}         -- "Dwarves live under the ground of the Barrow Downs--a barren collection of ancient gravesites built by their race centuries ago to honor fallen kings and heroes.  Not all of the barrows can be reached on the surface--many are magically connected to each other through a system of teleporters and traps that protect the graves from those who would rob them.  If you look closely at the walls you should see markings that might help you navigate."
end

event 473  -- "Medusas"
  0:  Cmp  {"QBits", Value = 98,   jump = 3}         -- Built Castle to Level 2 (rescued dwarf guy)
  1:  SetMessage  {Str = 674}         -- "We were making a fortune in the Red Dwarf Mines until the Medusas came!  We had to run before they turned everyone to stone.  Without our mining, we have almost no way to make a living.  Not the way for a proper Dwarf to live, I say!"
  2:  Exit  {}

  3:  SetMessage  {Str = 703}         -- "The Lords of Harmondale!  Heroes, I say!  My cousin was one of the ones you rescued!  We are in your debt!"
end

event 474  -- "Red Dwarf Mines"
  0:  Cmp  {"QBits", Value = 98,   jump = 3}         -- Built Castle to Level 2 (rescued dwarf guy)
  1:  SetMessage  {Str = 675}         -- "Bracada leased the land where we started the Red Dwarf Mine to us a few years ago.  That was until the Medusas came and took the mines from our people.  Only the Gods know what horrors go on in there now.  The mines were in the Northeast corner of Bracada."
  2:  Exit  {}

  3:  SetMessage  {Str = 704}         -- "Thank you for delivering our people from the medusas!  The Dwarves of Stone City will not forget you!"
end

event 475  -- "The Statues"
  0:  Cmp  {"QBits", Value = 98,   jump = 3}         -- Built Castle to Level 2 (rescued dwarf guy)
  1:  SetMessage  {Str = 676}         -- "When the Medusas took the Red Dwarf Mines from us, not everyone escaped.  There are still several statues in the mines.  They can be rescued if their statues haven't been broken yet, but you would have to fight through the Medusas to do it."
  2:  Exit  {}

  3:  SetMessage  {Str = 705}         -- "We owe you much for your daring rescue of our people.  Rebuilding your castle was the least we could do for you."
end

event 476  -- "Stone City"
  0:  SetMessage  {Str = 677}         -- "Do you like our city?  It's not just a hole in the ground--it's a home in the ground!  Dwarves have been working this mountain for centuries!  There isn't much mining left here, though, and what there is happens to be in unstable and unsafe tunnels.  Be careful if you go to the lower levels."
end

event 477  -- "Harmondale"
  0:  Cmp  {"QBits", Value = 99,   jump = 4}         -- Chose the path of Light
  1:  Cmp  {"QBits", Value = 100,   jump = 4}         -- Chose the path of Dark
  2:  SetMessage  {Str = 678}         -- "Respectfully, my lords, I must say that no one expects you to last long because no other lords of Harmondale have lasted long.  The fighting and politics between Erathia and Avlee will claim you sooner or later.  Probably sooner."
  3:  Exit  {}

  4:  SetMessage  {Str = 706}         -- "Good day, my lords.  I must say the people are changing their minds about your chances of survival.  Everyone is saying how wonderful it is to have stable rulers in the Castle!"
end

event 478  -- "Rebellions"
  0:  SetMessage  {Str = 679}         -- "Rebellions here in Harmondale are rare, but we've had a couple of big ones!  Most of the time lords here don't last long enough to rebel against, but there've been some wicked ones!  Not that I think you're wicked, my lords."
end

event 479  -- "Castle Harmondale"
  0:  Cmp  {"QBits", Value = 98,   jump = 3}         -- Built Castle to Level 2 (rescued dwarf guy)
  1:  SetMessage  {Str = 680}         -- "It's good to see someone in Harmondale again, my lords.  The castle's been standing empty since the War, except for the goblins.  But they don't count, I suppose."
  2:  Exit  {}

  3:  SetMessage  {Str = 707}         -- "It's good to see the Castle rebuilt and those loathsome goblin bandits evicted.  Things are looking better around here since you took over!"
end

event 480  -- "Tularean Caves"
  0:  SetMessage  {Str = 681}         -- "What with all the wars that Avlee gets itself into all the time, and all the high taxes, I've moved to Harmondale to stay.  Harmondale sees a lot of violence, but at least they don't conscript.  You know, there's been so many wars in Avlee that one of the kings had a tunnel dug from his castle to the caves in the North just in case the castle was taken AGAIN."
end

event 481  -- "White Cliff Caves"
  0:  SetMessage  {Str = 682}         -- "A ways outside of Harmondale there's a cave system that's always been the home of bandits, monsters, and other ne'er-do-wells.  They're called the White Cliff Caves.  If you're ever robbed, or are looking for some evil doers to punish, all you got to do is go up there.  You'll find a fight for sure!"
end

event 482  -- "Fort Riverstride"
  0:  Cmp  {"QBits", Value = 83,   jump = 3}         -- Gave false Loren to Catherine (betray)
  1:  SetMessage  {Str = 683}         -- "Did you notice that covered bridge on the way from Harmondale to Steadwick?  It's called Fort Riverstride, and it protects us from surprise Elvish attacks coming through Harmondale.  There's so many traps and tricks inside there, they say it will never fall without the help of treachery.  "
  2:  Exit  {}

  3:  SetMessage  {Str = 708}         -- "I've heard Fort Riverstride was taken with the aid of treachery!  What a shame that those wretches were able to wring concessions from the Queen in exchange for the return of what was already ours!"
end

event 483  -- "The Trophy"
  0:  CanShowTopic.Cmp  {"QBits", Value = 98,   jump = 3}         -- Built Castle to Level 2 (rescued dwarf guy)
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  Cmp  {"QBits", Value = 84,   jump = 10}         -- Gave artifact to humans
  6:  Cmp  {"QBits", Value = 85,   jump = 12}         -- Gave artifact to elves
  7:  Cmp  {"QBits", Value = 147,   jump = 14}         -- Gave artifact to arbiter
  8:  SetMessage  {Str = 684}         -- "There's an artifact that Avlee and Erathia have been fighting over for decades.  Both claim it was made by their people, and have lost the thing to raids against one another many times.  It isn't even magical--just a trophy.  Fifteen years ago, the trophy was lost during a raid, and no one knows where it went.  Recently, rumors have been flying, and the hunt's been on to figure out where it went.  If they find it--watch out!  Blood will be spilt. "
  9:  Exit  {}

  10: SetMessage  {Str = 709}         -- "Looks like the trophy fell into the hands of Erathia.  I hear there was quite a fight over it! "
  11: Exit  {}

  12: SetMessage  {Str = 710}         -- "Looks like the trophy fell into the hands of Avlee.  I hear there was quite a fight over it! "
  13: Exit  {}

  14: SetMessage  {Str = 711}         -- "Looks like the trophy fell into the hands of the Arbiter.  I hear there was quite a fight over it! "
end

event 484  -- "The Arbiter"
  0:  CanShowTopic.Cmp  {"QBits", Value = 98,   jump = 3}         -- Built Castle to Level 2 (rescued dwarf guy)
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  Cmp  {"QBits", Value = 134,   jump = 8}         -- Arbiter Messenger only happens once
  6:  SetMessage  {Str = 685}         -- "Because of all the tension in the air, Erathia and Avlee hired an arbiter to help them work out their differences.  He's staying in the ""House of Stars"" on the eastern edge of Harmondale territory.  Maybe he has some advice for you."
  7:  Exit  {}

  8:  SetMessage  {Str = 712}         -- "The death of Judge Grey was a blow to all of us.  I hope his replacement does his legacy justice."
end

event 485  -- "Lost and Found"
  0:  SetMessage  {Str = 686}         -- "If you ever feel like you need advice on what next to do, or you've lost something important, go visit the Arbiter in the House of Stars near the Eastern edge of Harmondale territory.  He often knows where lost items went, or has advice on what you need to do.  I'm sure you'll find him helpful."
end

event 486  -- "The Choice"
  0:  CanShowTopic.Cmp  {"QBits", Value = 134,   jump = 3}         -- Arbiter Messenger only happens once
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  Cmp  {"QBits", Value = 99,   jump = 9}         -- Chose the path of Light
  6:  Cmp  {"QBits", Value = 100,   jump = 9}         -- Chose the path of Dark
  7:  SetMessage  {Str = 687}         -- "The death of Judge Grey, Arbiter of Harmondale, has put the War on hold.  It's like the whole world is holding its breath, waiting for you to make a choice.  Better be careful who you choose--this sounds like a big one, my Lords."
  8:  Exit  {}

  9:  SetMessage  {Str = 713}         -- "It looks like the consequences of your choice are just beginning, my lords.  I hope you chose wisely."
end

event 487  -- "Proving Grounds"
  0:  SetMessage  {Str = 688}         -- "The proving grounds, called the Walls of Mist,  is the place where all the wizards in Celeste have to go before they learn the High Art.  I hear it is much more of a moral test than a physical one.  You aren't allowed to kill any of the monsters in the maze."
end

event 488  -- "Celeste"
  0:  SetMessage  {Str = 689}         -- "The city of Celeste has been home to the Light for centuries.  It was established by King Magnus II  in 499 as the centerpiece to the Kingdom of Bracada, and as a beacon of hope to the rest of the world.  "
end

event 489  -- "The Pit"
  0:  SetMessage  {Str = 690}         -- "What you see on the surface in Deyja is only a small part of the true Kingdom of Death.  There is an underground city they call the Pit.  It can be reached from the surface only by way of the Hall of the Pit in Northern Deyja.  "
end

event 490  -- "Celeste"
  0:  SetMessage  {Str = 691}         -- "Celeste is the magical city built by the Wizards of Bracada centuries ago, and anchored half in the mountains, and half in mist high above Bracada.  You must use one of their teleporters to get there--you can find it near the center of Bracada."
end

event 491  -- "Mysterious Murders"
  0:  CanShowTopic.Cmp  {"QBits", Value = 98,   jump = 3}         -- Built Castle to Level 2 (rescued dwarf guy)
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  Cmp  {"QBits", Value = 107,   jump = 8}         -- Slayed the vampire
  6:  SetMessage  {Str = 692}         -- "There was another murder, recently, that's been all the talk around town.  Another body--young woman, so I hear--was found near the sewers.  Drained of blood, for the love of Light!  It's those thieves living' in the sewers I tell you!  Rats, they are.  Someone should go down there and put them out of business!"
  7:  Exit  {}

  8:  SetMessage  {Str = 714}         -- "So it was a vampire that was killing all those people!  I hear you're the ones to get rid of it, too!  Thanks!  Everyone feels much safer now."
end

event 492  -- "The Kreegan"
  0:  SetMessage  {Str = 693}         -- "During the War, the Warlocks had dealings with some strange creatures called the ""Kreegan"" in the mountains south of Avlee.  It's impossible to get there from the mainland, but the Warlocks dug a tunnel under the sea from their island that leads to the Kreegan's home."
end

event 493  -- "Losing the War"
  0:  SetMessage  {Str = 694}         -- "We…overplayed our hand during the War, and failed to win any territory on the mainland.  Our ""allies"", the Kreegan, turned out to be very untrustworthy.  People from Enroth call them devils--now we know why.  At just the moment when we needed them most, they turned and ran, leaving us to face the wrath of the armies of Erathia and Avlee.  Next time, we won't be so trusting."
end

event 494  -- "Falling out in Deyja"
  0:  CanShowTopic.Cmp  {"QBits", Value = 198,   jump = 3}         -- Archibald in Clankers Lab now
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 695}         -- "There's been quite a bit of activity in Deyja, people are saying.  It seems that Archibald Ironfist, the leader of Deyja (and former King of Enroth) has left the Pit for an island off the Eastern shore of Avlee.  A lot of Necromancers followed him there--seems there's some sort of split going on."
end

event 495  -- "Roland of Enroth"
  0:  CanShowTopic.Cmp  {"QBits", Value = 99,   jump = 5}         -- Chose the path of Light
  1:  CanShowTopic.Cmp  {"QBits", Value = 100,   jump = 5}         -- Chose the path of Dark
  2:  CanShowTopic.Set  {Visible = false}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = true}
  5:  CanShowTopic.Exit  {}

  6:  Cmp  {"QBits", Value = 240,   jump = 9}         -- Talked to Roland
  7:  SetMessage  {Str = 696}         -- "Rumors have been trickling out of Nighon that King Roland of Enroth may still be alive.  Some Warlocks have said that they personally saw him when they met with the foul Kreegan.  The rumors also say that the Kreegan are keeping him in a cage and mistreating him horribly."
  8:  Exit  {}

  9:  SetMessage  {Str = 715}         -- "They say you are being credited with rescuing King Roland!  That's quite a feather in your cap, my lords!  QUITE a feather!"
end

event 496  -- "Soul Jars"
  0:  SetMessage  {Str = 697}         -- "A Soul Jar is what a Necromancer needs to complete the Ritual and become a Lich--an immortal undead monster that retains its mind and memories from life.  It's pretty obvious that this is not a desirable condition for most people, which is why the market for these artifacts isn't very good.  Nonetheless, Necromancers will do almost anything to get more--their profession's very existence depends on them."
end

event 497  -- "Warlocks"
  0:  SetMessage  {Str = 700}         -- "Although the Warlocks are technically servants of the Dark, they usually aren't violent.  They will defend themselves if attacked, of course, but they won't start a fight unless you start it first.  They're quite reasonable, as a matter of fact, and they take their business seriously.  I've found dealing with them to be quite pleasant."
end

event 498  -- "Clanker's Defenses"
  0:  CanShowTopic.Cmp  {"QBits", Value = 99,   jump = 5}         -- Chose the path of Light
  1:  CanShowTopic.Cmp  {"QBits", Value = 100,   jump = 5}         -- Chose the path of Dark
  2:  CanShowTopic.Set  {Visible = false}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = true}
  5:  CanShowTopic.Exit  {}

  6:  Cmp  {"QBits", Value = 125,   jump = 9}         -- "Destroy the magical defenses inside Clanker's Laboratory and return to Dark Shade in the Pit."
  7:  SetMessage  {Str = 701}         -- "The underground complex Clanker has created is surprisingly well defended.  The front door will keep out all magical attacks, and the island makes it difficult for any sort of large force to land on the island.  So far, Clanker has kept to himself, and no one has seriously tried his defenses, but his best protection comes from a series of teleport blockers inside the complex.  No magical invasion force can teleport past the front door until those blockers are brought down first."
  8:  Exit  {}

  9:  SetMessage  {Str = 699}         -- "So much for the mighty defenses.  Word is the Necromancers, led by Archibald Ironfist, teleported straight into Clanker's Laboratory and took over.  I'm told that treachery from within had something to do with it, though."
end

event 499  -- "Expert Teachers"
  0:  SetMessage  {Str = 716}         -- "Looking for Expert instruction in one of your Skills?  Expert teachers for most Skills can be found in Harmondale, Erathia and the Tularean Forest. "
end

event 500  -- "Missing People"
  0:  SetMessage  {Str = 698}         -- "People have been disappearing recently.  Not just one or two, but several every day!  They go to bed at night, and the next day they aren't seen and their houses are empty!  I certainly wish someone would find out what it happening!"
end

event 501  -- "Make Weapon"
  0:  Cmp  {"Inventory", Value = 691,   jump = 8}         -- "Stalt-laced ore"
  1:  Cmp  {"Inventory", Value = 690,   jump = 12}         -- "Erudine-laced ore"
  2:  Cmp  {"Inventory", Value = 689,   jump = 16}         -- "Kergar-laced ore"
  3:  Cmp  {"Inventory", Value = 688,   jump = 20}         -- "Phylt-laced ore"
  4:  Cmp  {"Inventory", Value = 687,   jump = 24}         -- "Siertal-laced ore"
  5:  Cmp  {"Inventory", Value = 686,   jump = 28}         -- "Iron-laced ore"
  6:  SetMessage  {Str = 718}         -- "You need ore for me to create weapons.  The better the ore, the better the weapon I can make."
  7:  Exit  {}

  8:  Subtract  {"Inventory", Value = 691}         -- "Stalt-laced ore"
  9:  GiveItem  {Strength = 6, Type = const.ItemType.Weapon_, Id = 0}
  10: SetMessage  {Str = 717}         -- "Here's your weapon; if you find more ore, I'll be happy to make you more weapons."
  11: Exit  {}

  12: Subtract  {"Inventory", Value = 690}         -- "Erudine-laced ore"
  13: GiveItem  {Strength = 5, Type = const.ItemType.Weapon_, Id = 0}
  14: SetMessage  {Str = 717}         -- "Here's your weapon; if you find more ore, I'll be happy to make you more weapons."
  15: Exit  {}

  16: Subtract  {"Inventory", Value = 689}         -- "Kergar-laced ore"
  17: GiveItem  {Strength = 4, Type = const.ItemType.Weapon_, Id = 0}
  18: SetMessage  {Str = 717}         -- "Here's your weapon; if you find more ore, I'll be happy to make you more weapons."
  19: Exit  {}

  20: Subtract  {"Inventory", Value = 688}         -- "Phylt-laced ore"
  21: GiveItem  {Strength = 3, Type = const.ItemType.Weapon_, Id = 0}
  22: SetMessage  {Str = 717}         -- "Here's your weapon; if you find more ore, I'll be happy to make you more weapons."
  23: Exit  {}

  24: Subtract  {"Inventory", Value = 687}         -- "Siertal-laced ore"
  25: GiveItem  {Strength = 2, Type = const.ItemType.Weapon_, Id = 0}
  26: SetMessage  {Str = 717}         -- "Here's your weapon; if you find more ore, I'll be happy to make you more weapons."
  27: Exit  {}

  28: Subtract  {"Inventory", Value = 686}         -- "Iron-laced ore"
  29: GiveItem  {Strength = 1, Type = const.ItemType.Weapon_, Id = 0}
  30: SetMessage  {Str = 717}         -- "Here's your weapon; if you find more ore, I'll be happy to make you more weapons."
  31: Exit  {}
end

event 502  -- "Make Armor"
  0:  Cmp  {"Inventory", Value = 691,   jump = 8}         -- "Stalt-laced ore"
  1:  Cmp  {"Inventory", Value = 690,   jump = 12}         -- "Erudine-laced ore"
  2:  Cmp  {"Inventory", Value = 689,   jump = 16}         -- "Kergar-laced ore"
  3:  Cmp  {"Inventory", Value = 688,   jump = 20}         -- "Phylt-laced ore"
  4:  Cmp  {"Inventory", Value = 687,   jump = 24}         -- "Siertal-laced ore"
  5:  Cmp  {"Inventory", Value = 686,   jump = 28}         -- "Iron-laced ore"
  6:  SetMessage  {Str = 720}         -- "You need ore for me to create armor.  The better the ore, the better the armor I can make."
  7:  Exit  {}

  8:  Subtract  {"Inventory", Value = 691}         -- "Stalt-laced ore"
  9:  GiveItem  {Strength = 6, Type = const.ItemType.Armor_, Id = 0}
  10: SetMessage  {Str = 719}         -- "Here's your armor; if you find more ore, I'll be happy to make you more armor."
  11: Exit  {}

  12: Subtract  {"Inventory", Value = 690}         -- "Erudine-laced ore"
  13: GiveItem  {Strength = 5, Type = const.ItemType.Armor_, Id = 0}
  14: SetMessage  {Str = 719}         -- "Here's your armor; if you find more ore, I'll be happy to make you more armor."
  15: Exit  {}

  16: Subtract  {"Inventory", Value = 689}         -- "Kergar-laced ore"
  17: GiveItem  {Strength = 4, Type = const.ItemType.Armor_, Id = 0}
  18: SetMessage  {Str = 719}         -- "Here's your armor; if you find more ore, I'll be happy to make you more armor."
  19: Exit  {}

  20: Subtract  {"Inventory", Value = 688}         -- "Phylt-laced ore"
  21: GiveItem  {Strength = 3, Type = const.ItemType.Armor_, Id = 0}
  22: SetMessage  {Str = 719}         -- "Here's your armor; if you find more ore, I'll be happy to make you more armor."
  23: Exit  {}

  24: Subtract  {"Inventory", Value = 687}         -- "Siertal-laced ore"
  25: GiveItem  {Strength = 2, Type = const.ItemType.Armor_, Id = 0}
  26: SetMessage  {Str = 719}         -- "Here's your armor; if you find more ore, I'll be happy to make you more armor."
  27: Exit  {}

  28: Subtract  {"Inventory", Value = 686}         -- "Iron-laced ore"
  29: GiveItem  {Strength = 1, Type = const.ItemType.Armor_, Id = 0}
  30: SetMessage  {Str = 719}         -- "Here's your armor; if you find more ore, I'll be happy to make you more armor."
  31: Exit  {}
end

event 503  -- "Make Item"
  0:  Cmp  {"Inventory", Value = 691,   jump = 8}         -- "Stalt-laced ore"
  1:  Cmp  {"Inventory", Value = 690,   jump = 12}         -- "Erudine-laced ore"
  2:  Cmp  {"Inventory", Value = 689,   jump = 16}         -- "Kergar-laced ore"
  3:  Cmp  {"Inventory", Value = 688,   jump = 20}         -- "Phylt-laced ore"
  4:  Cmp  {"Inventory", Value = 687,   jump = 24}         -- "Siertal-laced ore"
  5:  Cmp  {"Inventory", Value = 686,   jump = 28}         -- "Iron-laced ore"
  6:  SetMessage  {Str = 722}         -- "You need ore for me to create items.  The better the ore, the better the items I can make."
  7:  Exit  {}

  8:  Subtract  {"Inventory", Value = 691}         -- "Stalt-laced ore"
  9:  GiveItem  {Strength = 6, Type = const.ItemType.Misc, Id = 0}
  10: SetMessage  {Str = 721}         -- "Here is your item; if you find more ore, I'll be happy to make you more items."
  11: Exit  {}

  12: Subtract  {"Inventory", Value = 690}         -- "Erudine-laced ore"
  13: GiveItem  {Strength = 5, Type = const.ItemType.Misc, Id = 0}
  14: SetMessage  {Str = 721}         -- "Here is your item; if you find more ore, I'll be happy to make you more items."
  15: Exit  {}

  16: Subtract  {"Inventory", Value = 689}         -- "Kergar-laced ore"
  17: GiveItem  {Strength = 4, Type = const.ItemType.Misc, Id = 0}
  18: SetMessage  {Str = 721}         -- "Here is your item; if you find more ore, I'll be happy to make you more items."
  19: Exit  {}

  20: Subtract  {"Inventory", Value = 688}         -- "Phylt-laced ore"
  21: GiveItem  {Strength = 3, Type = const.ItemType.Misc, Id = 0}
  22: SetMessage  {Str = 721}         -- "Here is your item; if you find more ore, I'll be happy to make you more items."
  23: Exit  {}

  24: Subtract  {"Inventory", Value = 687}         -- "Siertal-laced ore"
  25: GiveItem  {Strength = 2, Type = const.ItemType.Misc, Id = 0}
  26: SetMessage  {Str = 721}         -- "Here is your item; if you find more ore, I'll be happy to make you more items."
  27: Exit  {}

  28: Subtract  {"Inventory", Value = 686}         -- "Iron-laced ore"
  29: GiveItem  {Strength = 1, Type = const.ItemType.Misc, Id = 0}
  30: SetMessage  {Str = 721}         -- "Here is your item; if you find more ore, I'll be happy to make you more items."
  31: Exit  {}
end

event 504  -- "Signal "
  0:  SetMessage  {Str = 723}         -- "The signal rocket on the west side of the island should be set of to warn ships off from approaching to close to that side of the island.  The reefs off the west coast have proven deadly in the past."
end

event 505  -- "Dragon Flies"
  0:  SetMessage  {Str = 724}         -- "Beware the marshes of the southern tip of the island.  The dragon flies that pester our town spawn there!  "
end

event 506  -- "Fallen Trees"
  0:  SetMessage  {Str = 725}         -- "Fallen or dead trees can sometimes be the hiding place of some treasure or trinket.  However, it can also be home to insects or worse!"
end

event 507  -- "Bracada Teleporters"
  0:  SetMessage  {Str = 726}         -- "The teleporters of central Bracada can get you to numerous locations in the desert.  Just check the pillar in front of the teleporter for the location it will take you to.  Be careful however, some of the teleporters haven't been working correctly and will not show the destination!"
end

event 508  -- "Castle Upgrade"
  0:  CanShowTopic.Cmp  {"QBits", Value = 98,   jump = 4}         -- Built Castle to Level 2 (rescued dwarf guy)
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}

  4:  Cmp  {"Awards", Value = 84,   jump = 8}         -- "Completed Necromancer Breeding Pit"
  5:  Cmp  {"Awards", Value = 46,   jump = 10}         -- "Completed Wizard Proving Grounds"
  6:  SetMessage  {Str = 732}         -- "My Lords. Castle Harmondale stands ready."
  7:  Exit  {}

  8:  SetMessage  {Str = 727}         -- "My Lords!  Lord Archibald sent engineers and artisans to upgrade Castle Harmondale!  Now we have an upstairs and downstairs!  Lord Archibald also left gifts in chests in these new areas.  The artisans are setting up shop in the entry hall and will have many wonderful items for sale!  Oh, yes, the workers discovered an older area to the castle--a torture chamber and dungeon!  We are very lucky!  I never thought Harmondale could afford such luxuries, my lords!"
  9:  Exit  {}

  10: SetMessage  {Str = 728}         -- "My Lords!  Gavin Magnus sent engineers and artisans to upgrade Castle Harmondale!  Now we have an upstairs and downstairs!  Gavin Magnus also left gifts in chests in these new areas.  The artisans are setting up shop in the entry hall and will have many wonderful items for sale!  The workers, however, discovered an older area to the castle--a torture chamber and dungeon.  It isn't a pretty sight, I'm afraid."
end

event 509  -- "Pedestals"
  0:  SetMessage  {Str = 733}         -- "Pedestals can be found through out the land that can lend you temporary protection from certain types of magic. "
end

event 510  -- "Disputed Land"
  0:  SetMessage  {Str = 729}         -- "My Lords ::bows:: Now that you have cleared Castle Harmondale of the goblins and vermin, you should concentrate on removing the goblins from the area surrounding Harmondale.  To the east of here is the center of the disputed region.  Many great battles have been waged there between the forces of King Eldrich of the Elves and Queen Catherine of Erathia.  The goblins have taken the ruined fort in this area an use it to attack any travelers attempting to reach Harmondale!"
end

event 511  -- "Castle Harmondale"
  0:  SetMessage  {Str = 730}         -- "My Lords, remember Castle Harmondale is YOURS.  Feel free to relax while you're here.  Your sleep will never be disturbed by attacking monsters, nor will anything you decide to store in the castle's chests ever be stolen or removed.  You are home."
end

event 512  -- "Beacon Fires"
  0:  SetMessage  {Str = 731}         -- "If you seek aid from Erathia, light the beacon fires near the roads to the Barrow Downs, Erathia, and the Tularean Forest.  The Erathian forces near here will see the fires and rush to your aid!"
end

event 513  -- "Pay 1000 Gold"
  0:  Cmp  {"Gold", Value = 1000,   jump = 3}
  1:  SetMessage  {Str = 755}         -- "I can see your heart is in the right place, but your purse obviously isn't.  If you don't have the money, just say so.  In any event, good luck dealing with the zombies.  Ta-ta!"
  2:  GoTo  {jump = 6}

  3:  SetMessage  {Str = 738}         -- "This 1000 gold will go a long way to keeping zombies off the roads.  Thank you for your contribution."
  4:  Subtract  {"Gold", Value = 1000}
  5:  Set  {"QBits", Value = 249}         -- Don't get ambushed
  6:  SetNPCTopic  {NPC = 122, Index = 0, Event = 0}         -- "Lunius Shador"
  7:  SetNPCTopic  {NPC = 122, Index = 1, Event = 0}         -- "Lunius Shador"
end

event 514  -- "Don't Pay"
  0:  SetMessage  {Str = 739}         -- "That's a shame.  What a coincidence, I think I see some zombies on the roads.  Perhaps next time you'll be more inclined to contribute."
  1:  SetNPCTopic  {NPC = 122, Index = 0, Event = 0}         -- "Lunius Shador"
  2:  SetNPCTopic  {NPC = 122, Index = 1, Event = 0}         -- "Lunius Shador"
end

event 515  -- "Buy Arrowheads for 200 Gold"
  0:  CanShowTopic.Cmp  {"QBits", Value = 252,   jump = 2}         -- Bought Item 3
  1:  CanShowTopic.Cmp  {"QBits", Value = 256,   jump = 4}         -- Can't keep buying 1
  2:  CanShowTopic.Set  {Visible = true}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = false}
  5:  CanShowTopic.Exit  {}

  6:  SetMessage  {Str = 740}         -- "Excellent!  Here is a crate of Arrowheads.  Pip Hillier in Erathia pays the best prices for these. Be sure to see him!"
  7:  Subtract  {"QBits", Value = 252}         -- Bought Item 3
  8:  Cmp  {"Gold", Value = 200,   jump = 10}
  9:  GoTo  {jump = 15}

  10: Subtract  {"Gold", Value = 200}
  11: Add  {"Inventory", Value = 692}         -- "Crate of Arrowheads"
  12: Set  {"QBits", Value = 250}         -- Bought Item 1
  13: Set  {"QBits", Value = 256}         -- Can't keep buying 1
  14: Exit  {}

  15: SetMessage  {Str = 125}         -- "You don't have enough gold!"
  16: Exit  {}
end

event 516  -- "Sell Tularean Wood"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 694,   jump = 3}         -- "Crate of Tularean Wood"
  2:  Exit  {}

  3:  SetMessage  {Str = 741}         -- "Ahh, a shipment of Tularean Wood from my friend Robert Belknap.  I hope everything is well with him. Here's your payment."
  4:  Subtract  {"Inventory", Value = 694}         -- "Crate of Tularean Wood"
  5:  ForPlayer  ("Current")
  6:  Cmp  {"DayOfWeekIs", Value = 0,   jump = 14}
  7:  Cmp  {"DayOfWeekIs", Value = 1,   jump = 16}
  8:  Cmp  {"DayOfWeekIs", Value = 2,   jump = 18}
  9:  Cmp  {"DayOfWeekIs", Value = 3,   jump = 20}
  10: Cmp  {"DayOfWeekIs", Value = 4,   jump = 22}
  11: Cmp  {"DayOfWeekIs", Value = 5,   jump = 24}
  12: Cmp  {"DayOfWeekIs", Value = 6,   jump = 26}
  13: Exit  {}

  14: Add  {"Gold", Value = 294}
  15: Exit  {}

  16: Add  {"Gold", Value = 241}
  17: Exit  {}

  18: Add  {"Gold", Value = 251}
  19: Exit  {}

  20: Add  {"Gold", Value = 237}
  21: Exit  {}

  22: Add  {"Gold", Value = 273}
  23: Exit  {}

  24: Add  {"Gold", Value = 255}
  25: Exit  {}

  26: Add  {"Gold", Value = 286}
  27: Exit  {}
end

event 517  -- "Buy Griffin Feathers for 200 Gold"
  0:  CanShowTopic.Cmp  {"QBits", Value = 250,   jump = 2}         -- Bought Item 1
  1:  CanShowTopic.Cmp  {"QBits", Value = 257,   jump = 4}         -- Can't keep buying 2
  2:  CanShowTopic.Set  {Visible = true}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = false}
  5:  CanShowTopic.Exit  {}

  6:  SetMessage  {Str = 742}         -- "Here's your crate of Griffin Feathers.  Robert Belknap in the Tularean Forest pays the best prices for these feathers.  Be sure to give him my regards when you see him."
  7:  Subtract  {"QBits", Value = 250}         -- Bought Item 1
  8:  Cmp  {"Gold", Value = 200,   jump = 10}
  9:  GoTo  {jump = 15}

  10: Subtract  {"Gold", Value = 200}
  11: Add  {"Inventory", Value = 693}         -- "Crate of Griffin Feathers"
  12: Set  {"QBits", Value = 251}         -- Bought Item 2
  13: Set  {"QBits", Value = 257}         -- Can't keep buying 2
  14: Exit  {}

  15: SetMessage  {Str = 125}         -- "You don't have enough gold!"
  16: Exit  {}
end

event 518  -- "Sell Arrowheads"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 692,   jump = 3}         -- "Crate of Arrowheads"
  2:  Exit  {}

  3:  SetMessage  {Str = 743}         -- "Rydric has sent me another shipment of Arrowheads.  Wonderful!  Here's your payment."
  4:  Subtract  {"Inventory", Value = 692}         -- "Crate of Arrowheads"
  5:  ForPlayer  ("Current")
  6:  Cmp  {"DayOfWeekIs", Value = 0,   jump = 14}
  7:  Cmp  {"DayOfWeekIs", Value = 1,   jump = 16}
  8:  Cmp  {"DayOfWeekIs", Value = 2,   jump = 18}
  9:  Cmp  {"DayOfWeekIs", Value = 3,   jump = 20}
  10: Cmp  {"DayOfWeekIs", Value = 4,   jump = 22}
  11: Cmp  {"DayOfWeekIs", Value = 5,   jump = 24}
  12: Cmp  {"DayOfWeekIs", Value = 6,   jump = 26}
  13: Exit  {}

  14: Add  {"Gold", Value = 261}
  15: Exit  {}

  16: Add  {"Gold", Value = 286}
  17: Exit  {}

  18: Add  {"Gold", Value = 237}
  19: Exit  {}

  20: Add  {"Gold", Value = 255}
  21: Exit  {}

  22: Add  {"Gold", Value = 294}
  23: Exit  {}

  24: Add  {"Gold", Value = 273}
  25: Exit  {}

  26: Add  {"Gold", Value = 244}
  27: Exit  {}
end

event 519  -- "Buy Tularean Wood for 200 Gold"
  0:  CanShowTopic.Cmp  {"QBits", Value = 251,   jump = 2}         -- Bought Item 2
  1:  CanShowTopic.Cmp  {"QBits", Value = 258,   jump = 4}         -- Can't keep buying 3
  2:  CanShowTopic.Set  {Visible = true}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = false}
  5:  CanShowTopic.Exit  {}

  6:  SetMessage  {Str = 744}         -- "Here's your crate of Tularean Wood.  Be sure to take it to Rydric in Harmondale.  He will pay you well for them."
  7:  Subtract  {"QBits", Value = 251}         -- Bought Item 2
  8:  Cmp  {"Gold", Value = 200,   jump = 10}
  9:  GoTo  {jump = 15}

  10: Subtract  {"Gold", Value = 200}
  11: Add  {"Inventory", Value = 694}         -- "Crate of Tularean Wood"
  12: Set  {"QBits", Value = 252}         -- Bought Item 3
  13: Set  {"QBits", Value = 258}         -- Can't keep buying 3
  14: Exit  {}

  15: SetMessage  {Str = 125}         -- "You don't have enough gold!"
  16: Exit  {}
end

event 520  -- "Sell Griffin Feathers"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 693,   jump = 3}         -- "Crate of Griffin Feathers"
  2:  Exit  {}

  3:  SetMessage  {Str = 745}         -- "Pip Hillier sends another shipment of Griffin Feathers.  Here's your payment.  Enjoy the day!"
  4:  Subtract  {"Inventory", Value = 693}         -- "Crate of Griffin Feathers"
  5:  ForPlayer  ("Current")
  6:  Cmp  {"DayOfWeekIs", Value = 0,   jump = 14}
  7:  Cmp  {"DayOfWeekIs", Value = 1,   jump = 16}
  8:  Cmp  {"DayOfWeekIs", Value = 2,   jump = 18}
  9:  Cmp  {"DayOfWeekIs", Value = 3,   jump = 20}
  10: Cmp  {"DayOfWeekIs", Value = 4,   jump = 22}
  11: Cmp  {"DayOfWeekIs", Value = 5,   jump = 24}
  12: Cmp  {"DayOfWeekIs", Value = 6,   jump = 26}
  13: Exit  {}

  14: Add  {"Gold", Value = 234}
  15: Exit  {}

  16: Add  {"Gold", Value = 267}
  17: Exit  {}

  18: Add  {"Gold", Value = 250}
  19: Exit  {}

  20: Add  {"Gold", Value = 291}
  21: Exit  {}

  22: Add  {"Gold", Value = 244}
  23: Exit  {}

  24: Add  {"Gold", Value = 285}
  25: Exit  {}

  26: Add  {"Gold", Value = 273}
  27: Exit  {}
end

event 521  -- "Buy Sand for 2000 Gold"
  0:  CanShowTopic.Cmp  {"QBits", Value = 255,   jump = 2}         -- Bought Item 6
  1:  CanShowTopic.Cmp  {"QBits", Value = 259,   jump = 4}         -- Can't keep buying 4
  2:  CanShowTopic.Set  {Visible = true}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = false}
  5:  CanShowTopic.Exit  {}

  6:  SetMessage  {Str = 746}         -- "Thanks!  Here's your crate of Sand. Arvin Beneclowd in the forsaken Barrow Downs pays well for this Sand, from it he creates fine bottles!"
  7:  Subtract  {"QBits", Value = 255}         -- Bought Item 6
  8:  Cmp  {"Gold", Value = 2000,   jump = 10}
  9:  GoTo  {jump = 16}

  10: Subtract  {"Gold", Value = 2000}
  11: Add  {"Inventory", Value = 695}         -- "Crate of Sand"
  12: Set  {"QBits", Value = 253}         -- Bought Item 4
  13: Set  {"QBits", Value = 259}         -- Can't keep buying 4
  14: Set  {"Counter7", Value = 0}
  15: Exit  {}

  16: SetMessage  {Str = 125}         -- "You don't have enough gold!"
  17: Exit  {}
end

event 522  -- "Sell Enrothian Wine"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 697,   jump = 3}         -- "Crate of Enrothian Wine"
  2:  Exit  {}

  3:  SetMessage  {Str = 747}         -- "Ahh, a shipment of Enrothian Wine from Infernon.  This will warm the hearts of many! Here's your payment."
  4:  Subtract  {"Inventory", Value = 697}         -- "Crate of Enrothian Wine"
  5:  ForPlayer  ("Current")
  6:  Cmp  {"Counter9", Value = 24,   jump = 8}
  7:  GoTo  {jump = 12}

  8:  Cmp  {"Counter9", Value = 120,   jump = 10}
  9:  GoTo  {jump = 14}

  10: Cmp  {"Counter9", Value = 240,   jump = 16}
  11: GoTo  {jump = 18}

  12: Add  {"Gold", Value = 3000}
  13: Exit  {}

  14: Add  {"Gold", Value = 2750}
  15: Exit  {}

  16: Add  {"Gold", Value = 2500}
  17: Exit  {}

  18: Add  {"Gold", Value = 2250}
  19: Exit  {}
end

event 523  -- "Buy Glass Bottles for 2000 Gold"
  0:  CanShowTopic.Cmp  {"QBits", Value = 253,   jump = 2}         -- Bought Item 4
  1:  CanShowTopic.Cmp  {"QBits", Value = 260,   jump = 4}         -- Can't keep buying 5
  2:  CanShowTopic.Set  {Visible = true}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = false}
  5:  CanShowTopic.Exit  {}

  6:  SetMessage  {Str = 748}         -- "Be sure to take this crate of Glass Bottles to Infernon in Avlee.  He bottles the finest Enrothian Wine."
  7:  Subtract  {"QBits", Value = 253}         -- Bought Item 4
  8:  Cmp  {"Gold", Value = 2000,   jump = 10}
  9:  GoTo  {jump = 16}

  10: Subtract  {"Gold", Value = 2000}
  11: Add  {"Inventory", Value = 696}         -- "Crate of Glass Bottles"
  12: Set  {"QBits", Value = 254}         -- Bought Item 5
  13: Set  {"QBits", Value = 260}         -- Can't keep buying 5
  14: Set  {"Counter8", Value = 0}
  15: Exit  {}

  16: SetMessage  {Str = 125}         -- "You don't have enough gold!"
  17: Exit  {}
end

event 524  -- "Sell Sand"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 695,   jump = 3}         -- "Crate of Sand"
  2:  Exit  {}

  3:  SetMessage  {Str = 749}         -- "Ahh, a shipment of Sand from Calindra Goldensight.  Here's your payment."
  4:  Subtract  {"Inventory", Value = 695}         -- "Crate of Sand"
  5:  ForPlayer  ("Current")
  6:  Cmp  {"Counter7", Value = 24,   jump = 8}
  7:  GoTo  {jump = 12}

  8:  Cmp  {"Counter7", Value = 120,   jump = 10}
  9:  GoTo  {jump = 14}

  10: Cmp  {"Counter7", Value = 240,   jump = 16}
  11: GoTo  {jump = 18}

  12: Add  {"Gold", Value = 3000}
  13: Exit  {}

  14: Add  {"Gold", Value = 2750}
  15: Exit  {}

  16: Add  {"Gold", Value = 2500}
  17: Exit  {}

  18: Add  {"Gold", Value = 2250}
  19: Exit  {}
end

event 525  -- "Buy Enrothian Wine for 2000 Gold"
  0:  CanShowTopic.Cmp  {"QBits", Value = 254,   jump = 2}         -- Bought Item 5
  1:  CanShowTopic.Cmp  {"QBits", Value = 261,   jump = 4}         -- Can't keep buying 6
  2:  CanShowTopic.Set  {Visible = true}
  3:  CanShowTopic.Exit  {}
  4:  CanShowTopic.Set  {Visible = false}
  5:  CanShowTopic.Exit  {}

  6:  SetMessage  {Str = 750}         -- "Here's your crate of Enrothian Wine.  Take this to Calindra Goldensight in Tatalia and she will pay you well! "
  7:  Subtract  {"QBits", Value = 254}         -- Bought Item 5
  8:  Cmp  {"Gold", Value = 2000,   jump = 10}
  9:  GoTo  {jump = 16}

  10: Subtract  {"Gold", Value = 2000}
  11: Add  {"Inventory", Value = 697}         -- "Crate of Enrothian Wine"
  12: Set  {"QBits", Value = 255}         -- Bought Item 6
  13: Set  {"QBits", Value = 261}         -- Can't keep buying 6
  14: Set  {"Counter9", Value = 0}
  15: Exit  {}

  16: SetMessage  {Str = 125}         -- "You don't have enough gold!"
  17: Exit  {}
end

event 526  -- "Sell Glass Bottles"
  0:  ForPlayer  ("All")
  1:  Cmp  {"Inventory", Value = 696,   jump = 3}         -- "Crate of Glass Bottles"
  2:  Exit  {}

  3:  SetMessage  {Str = 751}         -- "Arvin Beneclowd sends me another shipment of Glass Bottles.  Time to bottle some more Enrothian Wine.  Here's your payment."
  4:  Subtract  {"Inventory", Value = 696}         -- "Crate of Glass Bottles"
  5:  ForPlayer  ("Current")
  6:  Cmp  {"Counter8", Value = 24,   jump = 8}
  7:  GoTo  {jump = 12}

  8:  Cmp  {"Counter8", Value = 120,   jump = 10}
  9:  GoTo  {jump = 14}

  10: Cmp  {"Counter8", Value = 240,   jump = 16}
  11: GoTo  {jump = 18}

  12: Add  {"Gold", Value = 3000}
  13: Exit  {}

  14: Add  {"Gold", Value = 2750}
  15: Exit  {}

  16: Add  {"Gold", Value = 2500}
  17: Exit  {}

  18: Add  {"Gold", Value = 2250}
  19: Exit  {}
end

event 527  -- "Boat Schedule"
  0:  SetMessage  {Str = 752}         -- "You can charter a boat from this port to Erathia on Tuesdays, Thursdays and Saturdays. Boats for the Bracada Desert leave on Mondays and Wednesdays. Boats leave for Avlee on Friday only. If you have completed the Priest quest you can charter a boat to Evenmorn Island on Sundays."
end

event 528  -- "Nighon Tunnel"
  0:  SetMessage  {Str = 753}         -- "If you are looking to make it quickly to Nighon through the tunnels below, you should take the left fork of the Nighon Tunnel.  Many have taken the right fork and have never been heard from again.  Then again they may have made it to Nighon only to be taken by the Warlocks!"
end

event 529  -- "Trading"
  0:  SetMessage  {Str = 754}         -- "Many traders all over Erathia hire out to travelers to deliver their goods!  If you are ever in need of some extra coin, try finding one of these merchants and make a delivery for them!"
end

event 530  -- "Haste Pedestal"
  0:  CastSpell  {Spell = 5, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Haste"
end

event 531  -- "Earth Resistance Pedestal"
  0:  CastSpell  {Spell = 36, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Earth Resistance"
end

event 532  -- "Day of the Gods Pedestal"
  0:  CastSpell  {Spell = 83, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Day of the Gods"
end

event 533  -- "Shield Pedestal"
  0:  CastSpell  {Spell = 17, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Shield"
end

event 534  -- "Water Resistance Pedestal"
  0:  CastSpell  {Spell = 25, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Water Resistance"
end

event 535  -- "Fire Resistance Pedestal"
  0:  CastSpell  {Spell = 3, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Fire Resistance"
end

event 536  -- "Heroism Pedestal"
  0:  CastSpell  {Spell = 51, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Heroism"
end

event 537  -- "Immolation Pedestal"
  0:  CastSpell  {Spell = 8, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Immolation"
end

event 538  -- "Mind Resistance Pedestal"
  0:  CastSpell  {Spell = 58, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Mind Resistance"
end

event 539  -- "Body Resistance Pedestal"
  0:  CastSpell  {Spell = 69, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Body Resistance"
end

event 540  -- "Stone Skin Pedestal"
  0:  CastSpell  {Spell = 38, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Stone Skin"
end

event 541  -- "Air Resistance Pedestal"
  0:  CastSpell  {Spell = 14, Mastery = const.GM, Skill = 5, FromX = 0, FromY = 0, FromZ = 0, ToX = 0, ToY = 0, ToZ = 0}         -- "Air Resistance"
end

event 542  -- "Game of Might"
  0:  Cmp  {"PlayerBits", Value = 31,   jump = 8}
  1:  Cmp  {"CurrentMight", Value = 25,   jump = 4}
  2:  StatusText  {Str = 756}         -- "You have failed the game!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 3}
  5:  StatusText  {Str = 761}         -- "You win!  +3 Skill Points"
  6:  Set  {"PlayerBits", Value = 31}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 543  -- "Game of Endurance"
  0:  Cmp  {"PlayerBits", Value = 32,   jump = 8}
  1:  Cmp  {"CurrentEndurance", Value = 25,   jump = 4}
  2:  StatusText  {Str = 756}         -- "You have failed the game!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 3}
  5:  StatusText  {Str = 761}         -- "You win!  +3 Skill Points"
  6:  Set  {"PlayerBits", Value = 32}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 544  -- "Game of Intellect"
  0:  Cmp  {"PlayerBits", Value = 33,   jump = 8}
  1:  Cmp  {"CurrentIntellect", Value = 25,   jump = 4}
  2:  StatusText  {Str = 756}         -- "You have failed the game!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 3}
  5:  StatusText  {Str = 761}         -- "You win!  +3 Skill Points"
  6:  Set  {"PlayerBits", Value = 33}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 545  -- "Game of Personality"
  0:  Cmp  {"PlayerBits", Value = 34,   jump = 8}
  1:  Cmp  {"CurrentPersonality", Value = 25,   jump = 4}
  2:  StatusText  {Str = 756}         -- "You have failed the game!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 3}
  5:  StatusText  {Str = 761}         -- "You win!  +3 Skill Points"
  6:  Set  {"PlayerBits", Value = 34}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 546  -- "Game of Accuracy"
  0:  Cmp  {"PlayerBits", Value = 35,   jump = 8}
  1:  Cmp  {"CurrentAccuracy", Value = 25,   jump = 4}
  2:  StatusText  {Str = 756}         -- "You have failed the game!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 3}
  5:  StatusText  {Str = 761}         -- "You win!  +3 Skill Points"
  6:  Set  {"PlayerBits", Value = 35}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 547  -- "Game of Speed"
  0:  Cmp  {"PlayerBits", Value = 36,   jump = 8}
  1:  Cmp  {"CurrentSpeed", Value = 25,   jump = 4}
  2:  StatusText  {Str = 756}         -- "You have failed the game!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 3}
  5:  StatusText  {Str = 761}         -- "You win!  +3 Skill Points"
  6:  Set  {"PlayerBits", Value = 36}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 548  -- "Game of Luck"
  0:  Cmp  {"PlayerBits", Value = 37,   jump = 8}
  1:  Cmp  {"CurrentLuck", Value = 25,   jump = 4}
  2:  StatusText  {Str = 756}         -- "You have failed the game!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 3}
  5:  StatusText  {Str = 761}         -- "You win!  +3 Skill Points"
  6:  Set  {"PlayerBits", Value = 37}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 549  -- "Contest of Might"
  0:  Cmp  {"PlayerBits", Value = 38,   jump = 8}
  1:  Cmp  {"CurrentMight", Value = 50,   jump = 4}
  2:  StatusText  {Str = 757}         -- "You have failed the contest!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 5}
  5:  StatusText  {Str = 762}         -- "You win!  +5 Skill Points"
  6:  Set  {"PlayerBits", Value = 38}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 550  -- "Contest of Endurance"
  0:  Cmp  {"PlayerBits", Value = 39,   jump = 8}
  1:  Cmp  {"CurrentEndurance", Value = 50,   jump = 4}
  2:  StatusText  {Str = 757}         -- "You have failed the contest!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 5}
  5:  StatusText  {Str = 762}         -- "You win!  +5 Skill Points"
  6:  Set  {"PlayerBits", Value = 39}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 551  -- "Contest of Intellect"
  0:  Cmp  {"PlayerBits", Value = 40,   jump = 8}
  1:  Cmp  {"CurrentIntellect", Value = 50,   jump = 4}
  2:  StatusText  {Str = 757}         -- "You have failed the contest!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 5}
  5:  StatusText  {Str = 762}         -- "You win!  +5 Skill Points"
  6:  Set  {"PlayerBits", Value = 40}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 552  -- "Contest of Personality"
  0:  Cmp  {"PlayerBits", Value = 41,   jump = 8}
  1:  Cmp  {"CurrentPersonality", Value = 50,   jump = 4}
  2:  StatusText  {Str = 757}         -- "You have failed the contest!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 5}
  5:  StatusText  {Str = 762}         -- "You win!  +5 Skill Points"
  6:  Set  {"PlayerBits", Value = 41}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 553  -- "Contest of Accuracy"
  0:  Cmp  {"PlayerBits", Value = 42,   jump = 8}
  1:  Cmp  {"CurrentAccuracy", Value = 50,   jump = 4}
  2:  StatusText  {Str = 757}         -- "You have failed the contest!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 5}
  5:  StatusText  {Str = 762}         -- "You win!  +5 Skill Points"
  6:  Set  {"PlayerBits", Value = 42}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 554  -- "Contest of Speed"
  0:  Cmp  {"PlayerBits", Value = 43,   jump = 8}
  1:  Cmp  {"CurrentSpeed", Value = 50,   jump = 4}
  2:  StatusText  {Str = 757}         -- "You have failed the contest!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 5}
  5:  StatusText  {Str = 762}         -- "You win!  +5 Skill Points"
  6:  Set  {"PlayerBits", Value = 43}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 555  -- "Contest of Luck"
  0:  Cmp  {"PlayerBits", Value = 44,   jump = 8}
  1:  Cmp  {"CurrentLuck", Value = 50,   jump = 4}
  2:  StatusText  {Str = 757}         -- "You have failed the contest!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 5}
  5:  StatusText  {Str = 762}         -- "You win!  +5 Skill Points"
  6:  Set  {"PlayerBits", Value = 44}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 556  -- "Test of Might"
  0:  Cmp  {"PlayerBits", Value = 45,   jump = 8}
  1:  Cmp  {"CurrentMight", Value = 100,   jump = 4}
  2:  StatusText  {Str = 758}         -- "You have failed the test!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 7}
  5:  StatusText  {Str = 763}         -- "You win!  +7 Skill Points"
  6:  Set  {"PlayerBits", Value = 45}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 557  -- "Test of Endurance"
  0:  Cmp  {"PlayerBits", Value = 46,   jump = 8}
  1:  Cmp  {"CurrentEndurance", Value = 100,   jump = 4}
  2:  StatusText  {Str = 758}         -- "You have failed the test!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 7}
  5:  StatusText  {Str = 763}         -- "You win!  +7 Skill Points"
  6:  Set  {"PlayerBits", Value = 46}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 558  -- "Test of Intellect"
  0:  Cmp  {"PlayerBits", Value = 47,   jump = 8}
  1:  Cmp  {"CurrentIntellect", Value = 100,   jump = 4}
  2:  StatusText  {Str = 758}         -- "You have failed the test!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 7}
  5:  StatusText  {Str = 763}         -- "You win!  +7 Skill Points"
  6:  Set  {"PlayerBits", Value = 47}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 559  -- "Test of Personality"
  0:  Cmp  {"PlayerBits", Value = 48,   jump = 8}
  1:  Cmp  {"CurrentPersonality", Value = 100,   jump = 4}
  2:  StatusText  {Str = 758}         -- "You have failed the test!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 7}
  5:  StatusText  {Str = 763}         -- "You win!  +7 Skill Points"
  6:  Set  {"PlayerBits", Value = 48}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 560  -- "Test of Accuracy"
  0:  Cmp  {"PlayerBits", Value = 49,   jump = 8}
  1:  Cmp  {"CurrentAccuracy", Value = 100,   jump = 4}
  2:  StatusText  {Str = 758}         -- "You have failed the test!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 7}
  5:  StatusText  {Str = 763}         -- "You win!  +7 Skill Points"
  6:  Set  {"PlayerBits", Value = 49}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 561  -- "Test of Speed"
  0:  Cmp  {"PlayerBits", Value = 50,   jump = 8}
  1:  Cmp  {"CurrentSpeed", Value = 100,   jump = 4}
  2:  StatusText  {Str = 758}         -- "You have failed the test!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 7}
  5:  StatusText  {Str = 763}         -- "You win!  +7 Skill Points"
  6:  Set  {"PlayerBits", Value = 50}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 562  -- "Test of Luck"
  0:  Cmp  {"PlayerBits", Value = 51,   jump = 8}
  1:  Cmp  {"CurrentLuck", Value = 100,   jump = 4}
  2:  StatusText  {Str = 758}         -- "You have failed the test!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 7}
  5:  StatusText  {Str = 763}         -- "You win!  +7 Skill Points"
  6:  Set  {"PlayerBits", Value = 51}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 563  -- "Challenge of Might"
  0:  Cmp  {"PlayerBits", Value = 52,   jump = 8}
  1:  Cmp  {"CurrentMight", Value = 200,   jump = 4}
  2:  StatusText  {Str = 759}         -- "You have failed the challenge!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 10}
  5:  StatusText  {Str = 764}         -- "You win!  +10 Skill Points"
  6:  Set  {"PlayerBits", Value = 52}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 564  -- "Challenge of Endurance"
  0:  Cmp  {"PlayerBits", Value = 53,   jump = 8}
  1:  Cmp  {"CurrentEndurance", Value = 200,   jump = 4}
  2:  StatusText  {Str = 759}         -- "You have failed the challenge!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 10}
  5:  StatusText  {Str = 764}         -- "You win!  +10 Skill Points"
  6:  Set  {"PlayerBits", Value = 53}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 565  -- "Challenge of Intellect"
  0:  Cmp  {"PlayerBits", Value = 54,   jump = 8}
  1:  Cmp  {"CurrentIntellect", Value = 200,   jump = 4}
  2:  StatusText  {Str = 759}         -- "You have failed the challenge!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 10}
  5:  StatusText  {Str = 764}         -- "You win!  +10 Skill Points"
  6:  Set  {"PlayerBits", Value = 54}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 566  -- "Challenge of Personality"
  0:  Cmp  {"PlayerBits", Value = 55,   jump = 8}
  1:  Cmp  {"CurrentPersonality", Value = 200,   jump = 4}
  2:  StatusText  {Str = 759}         -- "You have failed the challenge!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 10}
  5:  StatusText  {Str = 764}         -- "You win!  +10 Skill Points"
  6:  Set  {"PlayerBits", Value = 55}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 567  -- "Challenge of Accuracy"
  0:  Cmp  {"PlayerBits", Value = 56,   jump = 8}
  1:  Cmp  {"CurrentAccuracy", Value = 200,   jump = 4}
  2:  StatusText  {Str = 759}         -- "You have failed the challenge!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 10}
  5:  StatusText  {Str = 764}         -- "You win!  +10 Skill Points"
  6:  Set  {"PlayerBits", Value = 56}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 568  -- "Challenge of Speed"
  0:  Cmp  {"PlayerBits", Value = 57,   jump = 8}
  1:  Cmp  {"CurrentSpeed", Value = 200,   jump = 4}
  2:  StatusText  {Str = 759}         -- "You have failed the challenge!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 10}
  5:  StatusText  {Str = 764}         -- "You win!  +10 Skill Points"
  6:  Set  {"PlayerBits", Value = 57}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 569  -- "Challenge of Luck"
  0:  Cmp  {"PlayerBits", Value = 58,   jump = 8}
  1:  Cmp  {"CurrentLuck", Value = 200,   jump = 4}
  2:  StatusText  {Str = 759}         -- "You have failed the challenge!"
  3:  Exit  {}

  4:  Add  {"SkillPoints", Value = 10}
  5:  StatusText  {Str = 764}         -- "You win!  +10 Skill Points"
  6:  Set  {"PlayerBits", Value = 58}
  7:  Exit  {}

  8:  StatusText  {Str = 760}         -- "You have already won!"
  9:  Exit  {}
end

event 570  -- "Traitor!"
  0:  CanShowTopic.Cmp  {"Inventory", Value = 716,   jump = 3}         -- "Letter to Hairbaugh"
  1:  CanShowTopic.Set  {Visible = false}
  2:  CanShowTopic.Exit  {}
  3:  CanShowTopic.Set  {Visible = true}
  4:  CanShowTopic.Exit  {}

  5:  SetMessage  {Str = 765}         -- "What!  You wouldn't believe this fabrication would you?  I would never dream of sabotaging your rule here!  Gaahh!  Prepare to die!"
  6:  SetMonGroupBit  {NPCGroup = 33, Bit = const.MonsterBits.Invisible, On = true}         -- ""
  7:  SetMonGroupBit  {NPCGroup = 34, Bit = const.MonsterBits.Invisible, On = false}         -- ""
end

event 571  -- "Shrine"
  0:  SetMessage  {Str = 766}         -- "I have heard rumors that the shrine to the southeast of here can send you to the Land of the Giants.  I have been to the shrine many times and it has never done anything special for me.  Or is that you can get here, FROM the Land of the Giants? I wonder..."
end

event 572  -- "Challenges"
  0:  SetMessage  {Str = 767}         -- "Scattered around the land are the Challenges.  If your ability is great enough, and you best the challenge, you will be award skill points to do with as you wish!"
end
